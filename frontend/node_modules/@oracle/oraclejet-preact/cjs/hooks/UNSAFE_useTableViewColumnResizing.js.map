{"version":3,"file":"UNSAFE_useTableViewColumnResizing.js","sources":["../../../src/hooks/UNSAFE_useTableViewColumnResizing/useTableViewColumnResizing.tsx"],"sourcesContent":["/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\nimport { createRef } from 'preact';\nimport { useCallback, useRef, useState } from 'preact/hooks';\nimport { useResizeObserver } from '../../hooks/UNSAFE_useResizeObserver';\nimport { UnsafeDomHandle } from '../../utils/UNSAFE_unsafeDomAccess';\nimport { ColumnResizeDetail, ColumnResizingDetail, ColumnWidths } from '../../UNSAFE_TableView';\n\nconst _defaultMinWidth = 16;\n\nexport type TableViewColumnResizingProps<C extends string> = {\n  columnOrder: C[];\n  applyWidths?: 'onResizing' | 'onResize';\n  columnWidths?: ColumnWidths<C>;\n  onColumnWidthsChanging?: (columnWidths: ColumnWidths<C>) => void;\n  onColumnWidthsChange?: (columnWidths: ColumnWidths<C>) => void;\n  minColumnWidth?: number;\n  resizeBehavior?: 'redistribute' | 'add';\n};\n\n/**\n * Utility hook for controlling a TableView's sizing.\n */\nfunction useTableViewColumnResizing<C extends string>({\n  columnOrder,\n  columnWidths,\n  onColumnWidthsChanging,\n  onColumnWidthsChange,\n  applyWidths = 'onResizing',\n  minColumnWidth = _defaultMinWidth,\n  resizeBehavior = 'redistribute'\n}: TableViewColumnResizingProps<C>) {\n  const columnWidthsRef = useRef<ColumnWidths<C> | undefined>(columnWidths);\n  columnWidthsRef.current = columnWidths;\n\n  const [columnResizingIndicator, setColumnResizingIndicator] = useState<\n    { key: C; delta: number } | undefined\n  >();\n  const columnResizingStartingColumnWidthsRef = useRef<ColumnWidths<C>>();\n\n  const frozenAddColumnWidthsRef = useRef<ColumnWidths<C>>({} as ColumnWidths<C>);\n  const [frozenAddColumnWidths, setFrozenAddColumnWidths] = useState<ColumnWidths<C>>(\n    {} as ColumnWidths<C>\n  );\n\n  // ensure all 'real' column widths are applied to the local realizedColumnWidths\n  const realizedColumnWidths = {} as ColumnWidths<C>;\n  const updatedKeys = [];\n  if (columnWidths != null) {\n    const keys = Object.keys(columnWidths) as C[];\n    for (const key of keys) {\n      realizedColumnWidths[key] = columnWidths[key];\n      updatedKeys.push(key);\n    }\n  }\n  // ensure all 'frozenAdd' column widths are applied to the local realizedColumnWidths\n  const frozenAddKeys = Object.keys(frozenAddColumnWidths) as C[];\n  for (const frozenAddKey of frozenAddKeys) {\n    if (!updatedKeys.includes(frozenAddKey)) {\n      realizedColumnWidths[frozenAddKey] = frozenAddColumnWidths[frozenAddKey];\n    }\n  }\n  const addResizePaddingWidthRef = useRef<number>(0);\n\n  const _cloneColumnWidths = useCallback((widths: ColumnWidths<C>) => {\n    const keys = Object.keys(widths) as C[];\n    const newColumnWidths = {} as ColumnWidths<C>;\n    for (const key of keys) {\n      newColumnWidths[key] = widths[key];\n    }\n    return newColumnWidths;\n  }, []);\n\n  /**\n   * Helper method to update the Table's column widths while a column resize operation is ongoing.\n   */\n  const onColumnResizing = useCallback(\n    (detail: ColumnResizingDetail<C>) => {\n      // save the initial state when column resize begins\n      if (columnResizingStartingColumnWidthsRef.current == null) {\n        columnResizingStartingColumnWidthsRef.current = detail.allColumnWidths;\n      }\n      const newStaticColumnWidths = _cloneColumnWidths(\n        columnWidthsRef.current != null ? columnWidthsRef.current : ({} as ColumnWidths<C>)\n      );\n      const startKey = detail.key;\n      const endKey = columnOrder[columnOrder.indexOf(startKey) + 1];\n      const initialStartWidth = columnResizingStartingColumnWidthsRef.current[startKey];\n      const initialEndWidth = columnResizingStartingColumnWidthsRef.current[endKey];\n      const newStartWidth = Math.min(\n        Math.max(initialStartWidth + detail.delta, minColumnWidth),\n        initialStartWidth + initialEndWidth - minColumnWidth\n      );\n      newStaticColumnWidths[startKey] = newStartWidth;\n      const newEndWidth = initialEndWidth + initialStartWidth - newStartWidth;\n      newStaticColumnWidths[endKey] = newEndWidth;\n\n      if (onColumnWidthsChanging != null) {\n        onColumnWidthsChanging(newStaticColumnWidths);\n      }\n      columnWidthsRef.current = newStaticColumnWidths;\n      setColumnResizingIndicator({ key: startKey, delta: 0 });\n    },\n    [onColumnWidthsChanging, minColumnWidth, columnOrder, _cloneColumnWidths]\n  );\n\n  /**\n   * Helper method to update the Table's column resize indicator line only.\n   */\n  const onColumnIndicatorResizing = useCallback(\n    (detail: ColumnResizingDetail<C>) => {\n      const startKey = detail.key;\n      const endKey = columnOrder[columnOrder.indexOf(startKey) + 1];\n      const initialStartWidth = detail.allColumnWidths[startKey];\n      const initialEndWidth = detail.allColumnWidths[endKey];\n      const newStartWidth = Math.min(\n        Math.max(initialStartWidth + detail.delta, minColumnWidth),\n        initialStartWidth + initialEndWidth - minColumnWidth\n      );\n      setColumnResizingIndicator({ key: startKey, delta: newStartWidth - initialStartWidth });\n    },\n    [columnOrder, minColumnWidth]\n  );\n\n  /**\n   * Helper method to update the Table's column widths at the end of column resize operation. This is\n   * the same as during an ongoing resize operation, but additionally pushes back the resized column widths\n   * to the consumer if a 'setInitialColumnWidths' callback is provided, and removes the indicator line.\n   */\n  const onColumnResize = useCallback(\n    (detail: ColumnResizeDetail<C>) => {\n      const initialWidths =\n        columnResizingStartingColumnWidthsRef.current != null\n          ? columnResizingStartingColumnWidthsRef.current\n          : detail.allColumnWidths;\n      const newStaticColumnWidths = _cloneColumnWidths(\n        columnWidthsRef.current != null ? columnWidthsRef.current : ({} as ColumnWidths<C>)\n      );\n      const startKey = detail.key;\n      const initialStartWidth = initialWidths[startKey];\n      let newStartWidth;\n      if (detail.type === 'absolute') {\n        newStartWidth = Math.max(detail.newWidth, minColumnWidth);\n        newStaticColumnWidths[startKey] = newStartWidth;\n      } else {\n        const endKey = columnOrder[columnOrder.indexOf(startKey) + 1];\n        const initialEndWidth = initialWidths[endKey];\n        newStartWidth = Math.min(\n          Math.max(initialStartWidth + detail.delta, minColumnWidth),\n          initialStartWidth + initialEndWidth - minColumnWidth\n        );\n        const newEndWidth = initialEndWidth + initialStartWidth - newStartWidth;\n        newStaticColumnWidths[endKey] = newEndWidth;\n      }\n      newStaticColumnWidths[startKey] = newStartWidth;\n      if (onColumnWidthsChange != null) {\n        onColumnWidthsChange(newStaticColumnWidths);\n      }\n      columnWidthsRef.current = newStaticColumnWidths;\n      columnResizingStartingColumnWidthsRef.current = undefined;\n      setColumnResizingIndicator(undefined);\n    },\n    [onColumnWidthsChange, minColumnWidth, columnOrder, _cloneColumnWidths]\n  );\n\n  /**\n   * Helper method to update the Table's column widths while a column resize operation is ongoing.\n   */\n  const onAddBehaviorResizing = useCallback(\n    (detail: ColumnResizingDetail<C>) => {\n      addResizePaddingWidthRef.current = detail.paddingWidth;\n      // save the initial state when column resize begins\n      if (columnResizingStartingColumnWidthsRef.current == null) {\n        columnResizingStartingColumnWidthsRef.current = detail.allColumnWidths;\n      }\n      const newFrozenColumnWidths = _cloneColumnWidths(\n        columnResizingStartingColumnWidthsRef.current != null\n          ? columnResizingStartingColumnWidthsRef.current\n          : detail.allColumnWidths\n      );\n      const newStaticColumnWidths = _cloneColumnWidths(\n        columnWidthsRef.current != null ? columnWidthsRef.current : ({} as ColumnWidths<C>)\n      );\n\n      const startKey = detail.key;\n      const initialStartWidth = columnResizingStartingColumnWidthsRef.current[startKey];\n      const newStartWidth = Math.max(initialStartWidth + detail.delta, minColumnWidth);\n      newStaticColumnWidths[startKey] = newStartWidth;\n      newFrozenColumnWidths[startKey] = newStartWidth;\n\n      if (onColumnWidthsChanging != null) {\n        onColumnWidthsChanging(newStaticColumnWidths);\n      }\n      setFrozenAddColumnWidths(newFrozenColumnWidths);\n      frozenAddColumnWidthsRef.current = newFrozenColumnWidths;\n      setColumnResizingIndicator({ key: startKey, delta: 0 });\n    },\n    [onColumnWidthsChanging, minColumnWidth, _cloneColumnWidths]\n  );\n\n  /**\n   * Helper method to update the Table's column resize indicator line only.\n   */\n  const onAddBehaviorIndicatorResizing = useCallback(\n    (detail: ColumnResizingDetail<C>) => {\n      addResizePaddingWidthRef.current = detail.paddingWidth;\n      const startKey = detail.key;\n      const initialStartWidth = detail.allColumnWidths[startKey];\n      const newStartWidth = Math.max(initialStartWidth + detail.delta, minColumnWidth);\n      setColumnResizingIndicator({ key: startKey, delta: newStartWidth - initialStartWidth });\n    },\n    [minColumnWidth]\n  );\n\n  /**\n   * Helper method to update the Table's column widths at the end of column resize operation. This is\n   * the same as during an ongoing resize operation, but additionally pushes back the resized column widths\n   * to the consumer if a 'setInitialColumnWidths' callback is provided, and removes the indicator line.\n   */\n  const onAddBehaviorResize = useCallback(\n    (detail: ColumnResizeDetail<C>) => {\n      addResizePaddingWidthRef.current = detail.paddingWidth;\n      const initialWidths =\n        columnResizingStartingColumnWidthsRef.current != null\n          ? columnResizingStartingColumnWidthsRef.current\n          : detail.allColumnWidths;\n      const newFrozenColumnWidths = _cloneColumnWidths(\n        columnResizingStartingColumnWidthsRef.current != null\n          ? columnResizingStartingColumnWidthsRef.current\n          : detail.type === 'absolute'\n          ? columnWidthsRef.current != null\n            ? columnWidthsRef.current\n            : ({} as ColumnWidths<C>)\n          : detail.allColumnWidths\n      );\n      const newStaticColumnWidths = _cloneColumnWidths(\n        columnWidthsRef.current != null ? columnWidthsRef.current : ({} as ColumnWidths<C>)\n      );\n      const startKey = detail.key;\n      const initialStartWidth = initialWidths[startKey];\n      const newStartWidth =\n        detail.type === 'delta'\n          ? Math.max(initialStartWidth + detail.delta, minColumnWidth)\n          : Math.max(detail.newWidth, minColumnWidth);\n      newStaticColumnWidths[startKey] = newStartWidth;\n      newFrozenColumnWidths[startKey] = newStartWidth;\n\n      if (onColumnWidthsChange != null) {\n        onColumnWidthsChange(newStaticColumnWidths);\n      }\n      setFrozenAddColumnWidths(newFrozenColumnWidths);\n      frozenAddColumnWidthsRef.current = newFrozenColumnWidths;\n      columnResizingStartingColumnWidthsRef.current = undefined;\n      setColumnResizingIndicator(undefined);\n    },\n    [onColumnWidthsChange, minColumnWidth, _cloneColumnWidths]\n  );\n\n  const onColumnResizingHandler =\n    applyWidths === 'onResize'\n      ? resizeBehavior === 'add'\n        ? onAddBehaviorIndicatorResizing\n        : onColumnIndicatorResizing\n      : resizeBehavior === 'add'\n      ? onAddBehaviorResizing\n      : onColumnResizing;\n\n  const tableWidthRef = useRef<number>();\n\n  // scrollerRef is callback-based to meet useResizeObserver hook's state management requirements\n  const [scrollerRef, setScrollerRef] = useState(createRef<UnsafeDomHandle>());\n  const scrollerRefCallback = useCallback((unsafeDomAccess: UnsafeDomHandle | null) => {\n    setScrollerRef({ current: unsafeDomAccess });\n  }, []);\n\n  // setup a resize observer to unfreeze and previously 'frozen' column widths when required\n  useResizeObserver(\n    scrollerRef,\n    useCallback((entry: ResizeObserverEntry) => {\n      const boxSize = entry.contentBoxSize;\n      const newWidth = boxSize[0].inlineSize;\n      if (tableWidthRef.current == null || tableWidthRef.current !== newWidth) {\n        tableWidthRef.current = newWidth;\n\n        let totalWidth = 0;\n        const keys = Object.keys(frozenAddColumnWidthsRef.current) as C[];\n        for (const key of keys) {\n          totalWidth += frozenAddColumnWidthsRef.current[key];\n        }\n        if (newWidth >= totalWidth + addResizePaddingWidthRef.current) {\n          setFrozenAddColumnWidths({} as ColumnWidths<C>);\n          frozenAddColumnWidthsRef.current = {} as ColumnWidths<C>;\n        }\n      }\n    }, []),\n    { isDisabled: resizeBehavior === 'redistribute' }\n  );\n\n  const onColumnResizeHandler = resizeBehavior === 'add' ? onAddBehaviorResize : onColumnResize;\n\n  return {\n    columnResizingProps: {\n      onColumnResizing: onColumnResizingHandler,\n      onColumnResize: onColumnResizeHandler,\n      columnResizingIndicator: columnResizingIndicator,\n      columnWidths: realizedColumnWidths,\n      scrollerRef: scrollerRefCallback\n    }\n  };\n}\n\nexport { useTableViewColumnResizing };\n"],"names":["useRef","useState","useCallback","createRef","useResizeObserver"],"mappings":"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"}