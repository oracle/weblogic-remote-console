{"version":3,"file":"ColorPalette-e7a19a35.js","sources":["../../src/UNSAFE_ColorPalette/ColorPalette.tsx"],"sourcesContent":["/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * Licensed under The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\nimport { useState, useEffect, forwardRef, useImperativeHandle } from 'preact/compat';\nimport { useRef } from 'preact/hooks';\nimport { Ref } from 'preact';\nimport { SwatchFlexView } from '#PRIVATE_SwatchFlexView';\nimport { ColorSwatch } from '#UNSAFE_ColorSwatch';\nimport { parseColorValue, type ColorValue } from '#utils/UNSAFE_color';\nimport { Flex } from '#UNSAFE_Flex/Flex';\nimport { Keys } from '#utils/UNSAFE_keys';\nimport { ListItemRendererContext } from '#UNSAFE_Collection';\nimport { TestIdProps, useTestId } from '../hooks/UNSAFE_useTestId';\nimport { DimensionProps, dimensionInterpolations } from '../utils/UNSAFE_interpolations/dimensions';\nimport { PaddingProps, paddingInterpolations } from '../utils/UNSAFE_interpolations/padding';\nimport { ColorProps, colorInterpolations } from '../utils/UNSAFE_interpolations/colors';\nimport { AriaProps, ariaInterpolations } from '../utils/UNSAFE_interpolations/aria';\nimport { mergeInterpolations } from '../utils/UNSAFE_mergeInterpolations';\nimport { sortPalette, convertPalette } from '#utils/UNSAFE_color';\nimport type { ValueUpdateDetail } from '#utils/UNSAFE_valueUpdateDetail';\nimport translations from '#resources/nls/en/bundle';\nexport type FocusableHandle = {\n  focus: () => void;\n  blur: () => void;\n};\n\ntype StyleProps = DimensionProps & PaddingProps & ColorProps & AriaProps;\n\nexport type ColorPaletteProps = StyleProps &\n  TestIdProps & {\n    /**\n     * The selected color of the palette\n     */\n    value?: ColorValue;\n\n    /**\n     * The swatch size indicates how large the color swatches are rendered.\n     */\n    swatchSize?: 'xs' | 'sm';\n\n    /**\n     * An array of colors for the palette\n     */\n    palette?: Array<ColorValue>;\n\n    /**\n     * Invoked when a swatch is toggled\n     */\n    onCommit?: (details: ValueUpdateDetail<ColorValue>) => void;\n  };\n\nconst interpolations = [\n  ...Object.values(dimensionInterpolations),\n  ...Object.values(colorInterpolations),\n  ...Object.values(ariaInterpolations),\n  ...Object.values(paddingInterpolations)\n];\n\nconst mergedInterpolations = mergeInterpolations<ColorPaletteProps>(interpolations);\n\n/**\n * A Color Palette is an interface that displays a variety of color swatches allowing\n * users to select a color value.\n *\n * @param {ColorPaletteProps} props ColorPalette component props.\n * @returns {JSX.Element} ColorPalette component element.\n */\nexport const ColorPalette = forwardRef(\n  (\n    { value, swatchSize = 'sm', palette, onCommit, testId, ...props }: ColorPaletteProps,\n    focusHandleRef?: Ref<FocusableHandle>\n  ) => {\n    const {\n      class: mergedClasses,\n      ariaLabel,\n      ariaLabelledBy,\n      ...mergedStyles\n    } = mergedInterpolations(props);\n\n    const rootRef = useRef<HTMLDivElement>(null);\n\n    const testIdProps = useTestId(testId);\n    const colorPaletteTranslated = translations.accColorPalette();\n\n    const [current, setCurrent] = useState<string | undefined>(undefined);\n    const [selected, setSelected] = useState<Keys<string | number>>({\n      all: false,\n      keys: new Set([(value as string) ?? undefined])\n    });\n\n    useEffect(() => {\n      setSelected({\n        all: false,\n        keys: new Set([parseColorValue(value ?? undefined)])\n      });\n    }, [value]);\n\n    useEffect(() => {}, [selected]); // redraw when selection occurs\n\n    const getRowKey = (data: unknown) => {\n      return data as string;\n    };\n\n    //Allows to call focus on rootRef without having to expose it\n    useImperativeHandle(focusHandleRef!, () => ({\n      focus: () => {\n        if (rootRef.current) {\n          rootRef.current.focus();\n        }\n      },\n      blur: () => {\n        if (rootRef.current) {\n          rootRef.current.blur();\n        }\n      }\n    }));\n\n    const dropdownStyle = {\n      width: '100%',\n      height: '100%'\n    };\n\n    return (\n      <div\n        aria-labelledby={ariaLabelledBy}\n        className={mergedClasses}\n        style={dropdownStyle}\n        {...testIdProps}\n        {...mergedStyles}>\n        <Flex align=\"center\">\n          <SwatchFlexView\n            ref={rootRef}\n            aria-label={ariaLabel ? ariaLabel : colorPaletteTranslated}\n            focusBehavior=\"content\"\n            data={palette ? convertPalette(sortPalette(palette)) : null}\n            getRowKey={getRowKey}\n            currentKey={current}\n            onCurrentKeyChange={(detail) => {\n              setCurrent(detail.value as string);\n            }}\n            selectedKeys={selected}>\n            {(context: ListItemRendererContext<string | number, unknown>) => (\n              <ColorSwatch\n                size={swatchSize}\n                testId={testId + '_palette' + '_colorSwatch_' + context.data}\n                aria-hidden={true}\n                value={context.data as ColorValue}\n                onToggle={() => {\n                  onCommit?.({\n                    value: context.data as ColorValue,\n                    previousValue: selected.keys?.values().next().value as ColorValue\n                  });\n                  setSelected({ all: false, keys: new Set([context.data as string]) });\n                }}\n                isSelected={selected.keys?.has(context.data as string)}></ColorSwatch>\n            )}\n          </SwatchFlexView>\n        </Flex>\n      </div>\n    );\n  }\n);\n\nColorPalette.displayName = 'ColorPalette';\n"],"names":["dimensionInterpolations","colorInterpolations","ariaInterpolations","paddingInterpolations","mergeInterpolations","forwardRef","useRef","useTestId","translations","useState","useEffect","parseColorValue","useImperativeHandle","_jsx","Flex","SwatchFlexView","convertPalette","sortPalette","ColorSwatch"],"mappings":"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"}