{"version":3,"file":"CheckboxControl-3334a89b.js","sources":["../../src/PRIVATE_CheckboxControl/CheckboxControl.tsx"],"sourcesContent":["import { ComponentChild, ComponentProps, Ref, RefObject } from 'preact';\nimport { forwardRef, createRef, useEffect, useRef } from 'preact/compat';\n\nimport { useCheckboxRadioContext } from '../PRIVATE_CheckboxRadioField/CheckboxRadioContext';\nimport { HiddenAccessible } from '../UNSAFE_HiddenAccessible';\nimport { useComponentTheme } from '../hooks/UNSAFE_useComponentTheme';\nimport { useFocus } from '../hooks/UNSAFE_useFocus';\nimport { IconUserAssistance, InlineUserAssistance } from '../UNSAFE_UserAssistance';\nimport { useTranslationBundle } from '../hooks/UNSAFE_useTranslationBundle';\nimport { BundleType } from '../resources/nls/bundle';\nimport { useTabbableMode } from '../hooks/UNSAFE_useTabbableMode';\nimport { useId } from '../hooks/UNSAFE_useId';\nimport { StyledCheckbox } from '../PRIVATE_StyledCheckbox';\nimport { CheckboxRedwoodTheme } from '../UNSAFE_Checkbox/themes/redwood/CheckboxTheme';\nimport { useActive } from '../hooks/UNSAFE_useActive';\nimport {\n  CheckboxVariantOptions,\n  CheckboxStyles\n} from '../UNSAFE_Checkbox/themes/CheckboxStyles.css';\nimport { useFocusWithin } from '#hooks/UNSAFE_useFocusWithin';\nimport { LayoutColumnSpan, layoutSpanStyles } from '#utils/UNSAFE_styles/Layout';\nimport { classNames } from '#utils/UNSAFE_classNames';\n\ntype InlineUserAssistanceProps = ComponentProps<typeof InlineUserAssistance>;\ntype StyledCheckboxProps = ComponentProps<typeof StyledCheckbox>;\n\ntype CheckboxControlProps = Pick<\n  StyledCheckboxProps,\n  | 'aria-describedby'\n  | 'name'\n  | 'value'\n  | 'onChange'\n  | 'onKeyUp'\n  | 'isReadonly'\n  | 'isDisabled'\n  | 'isRequired'\n> &\n  Pick<InlineUserAssistanceProps, 'assistiveText' | 'helpSourceLink' | 'helpSourceText'> & {\n    /**\n     * Text that describes the checkbox value.\n     */\n    children: ComponentChild;\n    /**\n     * Specifies how many columns to span in a FormLayout with direction === 'row'\n     */\n    columnSpan?: LayoutColumnSpan;\n    /**\n     * Whether the input element is checked.\n     */\n    isChecked?: boolean;\n  };\n\n/**\n * CheckboxControl is an internal subcomponent used by both Checkbox and CheckboxItem.\n * It handles styling, placement of label, assistive text, and accessibility text for both parent components.\n * onCommit handling is handled in the parent components.\n */\nconst CheckboxControl = forwardRef(\n  (\n    {\n      'aria-describedby': ariaDescribedBy,\n      name,\n      value,\n      children,\n      isChecked,\n      isDisabled,\n      isReadonly,\n      isRequired,\n      onChange,\n      onKeyUp,\n      assistiveText,\n      helpSourceLink,\n      helpSourceText,\n      columnSpan = 1\n    }: CheckboxControlProps,\n    ref: Ref<HTMLInputElement> = null\n  ) => {\n    // hooks\n    const id = useId();\n    const childWrapperRef = useRef<HTMLSpanElement>(null);\n    const { isTabbable } = useTabbableMode();\n    const { isActive, activeProps } = useActive();\n    const { isFocusRingShown } = useCheckboxRadioContext();\n    const labelRef = createRef<HTMLLabelElement>();\n    const {\n      isFocus,\n      focusProps: { onFocus, onBlur }\n    } = useFocus();\n\n    // styling\n    const {\n      classes: checkboxClasses,\n      styles: { valueLabelStyle, checkboxSpanStyle }\n    } = useComponentTheme<CheckboxVariantOptions, CheckboxStyles>(CheckboxRedwoodTheme, {\n      cursor: isDisabled || isReadonly ? 'arrow' : 'pointer',\n      disabled: isDisabled ? 'isDisabled' : 'notDisabled',\n      focused: isFocus && isFocusRingShown ? 'isFocused' : 'notFocused'\n    });\n\n    // help available\n    const hasUserAssistive = !isDisabled && !isReadonly && !!(assistiveText || helpSourceLink);\n    const helpAvailableId = hasUserAssistive ? `${id}-help-available` : undefined;\n    const uaId = hasUserAssistive ? `${id}-icon-ua` : undefined;\n    const { formControl_helpAvailable } = useTranslationBundle<BundleType>(\n      '@oracle/oraclejet-preact'\n    );\n    const helpAvailableString = formControl_helpAvailable();\n    const userAssistiveHelp = hasUserAssistive ? (\n      <HiddenAccessible id={helpAvailableId}>{helpAvailableString}</HiddenAccessible>\n    ) : undefined;\n\n    // prevent auto scrolling\n    const onKeyDown = (event: KeyboardEvent) => {\n      const { key } = event;\n      if (!isReadonly && key !== undefined && key === ' ') {\n        event.preventDefault();\n      }\n    };\n\n    // we want to prevent mouseDown on Links to set active\n    const onMouseDownHandler = (e: Event) => {\n      // check to see if the target is within an <a> tag and the tag is within the label\n      const closestAnchor = (e.target as Element).closest('a');\n      if (closestAnchor && childWrapperRef.current?.contains(closestAnchor)) {\n        e.stopPropagation();\n      } else {\n        activeProps['onMouseDown']?.(e);\n      }\n    };\n\n    // don't allow key down to set active state\n    delete activeProps['onKeyDown'];\n    const { focusProps, isFocused: isFocusedWithin } = useFocusWithin();\n\n    // JET-70100 - ensure checkbox is scrolled into view when focused and focus ring is shown\n    const scrollRef = useRef<HTMLInputElement>(null);\n    const inputRef = ref || scrollRef;\n\n    useEffect(() => {\n      const isActiveElement =\n        document.activeElement === (inputRef as RefObject<HTMLInputElement>)?.current;\n      if (!isActiveElement && isFocus && isFocusRingShown) {\n        labelRef?.current?.scrollIntoView({ block: 'nearest' });\n      }\n    }, [inputRef, isFocus, isFocusRingShown, labelRef]);\n\n    // The top level element needs the column span class on it.\n    const classes = layoutSpanStyles.layoutSpanColumn[columnSpan];\n\n    return (\n      <label ref={labelRef} class={classNames([checkboxClasses, classes])}>\n        <span class={checkboxSpanStyle} {...activeProps}>\n          <StyledCheckbox\n            aria-describedby={ariaDescribedBy}\n            name={name}\n            value={value}\n            onChange={onChange}\n            onBlur={onBlur}\n            onFocus={onFocus}\n            onKeyUp={onKeyUp}\n            onKeyDown={onKeyDown}\n            isActive={isActive}\n            isChecked={isChecked ? 'checked' : 'unchecked'}\n            isDisabled={isDisabled}\n            isReadonly={isReadonly}\n            isRequired={isRequired}\n            ref={inputRef}\n          />\n        </span>\n        <span class={valueLabelStyle}>\n          <span\n            {...activeProps}\n            {...focusProps}\n            onMouseDown={onMouseDownHandler}\n            ref={childWrapperRef}>\n            {children}\n          </span>\n          {userAssistiveHelp}\n          {hasUserAssistive && (\n            <IconUserAssistance\n              assistiveText={assistiveText}\n              helpSourceLink={helpSourceLink}\n              helpSourceText={helpSourceText}\n              isTabbable={isTabbable && (isFocus || isFocusedWithin)}\n              id={uaId}\n            />\n          )}\n        </span>\n      </label>\n    );\n  }\n);\n\nexport { CheckboxControl };\n"],"names":["forwardRef","useId","useRef","useTabbableMode","useActive","useCheckboxRadioContext","createRef","useFocus","useComponentTheme","CheckboxRedwoodTheme","useTranslationBundle","_jsx","HiddenAccessible","useFocusWithin","useEffect","layoutSpanStyles","_jsxs","classNames","StyledCheckbox","IconUserAssistance"],"mappings":"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"}