{"version":3,"file":"useSelectCommon-c3f3b7bc.js","sources":["../../src/PRIVATE_SelectCommon/itemTextUtils.ts","../../src/PRIVATE_SelectCommon/DefaultList.tsx","../../src/PRIVATE_SelectCommon/eventUtils.ts","../../src/PRIVATE_SelectCommon/DropdownArrow.tsx","../../src/PRIVATE_SelectCommon/DropdownList.tsx","../../src/PRIVATE_SelectCommon/EmptyResults.tsx","../../src/PRIVATE_SelectCommon/selectUtils.ts","../../src/PRIVATE_SelectCommon/useCollectionRenderer.ts","../../src/PRIVATE_SelectCommon/useSelectCommon.ts"],"sourcesContent":["/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\n\nimport { Item } from '../utils/UNSAFE_dataProvider';\nimport { error } from '../utils/UNSAFE_logger';\nimport { ItemTextFunctionType, ItemTextType } from '../utils/UNSAFE_selectUtils';\n\nexport function renderItemText<K, D>(item: Item<K, D>, itemText: ItemTextType<K, D>) {\n  // if item-text is a string and the data has the specified field, return it;\n  // otherwise log an error\n  if (typeof itemText === 'string') {\n    if ((item.data as any)?.hasOwnProperty(itemText)) {\n      const retData = item.data[itemText];\n      return String(retData);\n    }\n    error('SelectMultiple: itemText specifies field that does not exist: ' + itemText);\n    // return undefined if the field doesn't exist\n    return undefined;\n  }\n  // if item-text is a function, call it to create a display label\n  return (itemText as ItemTextFunctionType<K, D>)(item);\n}\n","/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\n\nimport { List, SkeletonContainer } from '#PRIVATE_List';\nimport type { DataState, ListItemRendererContext, Metadata } from '#UNSAFE_Collection';\nimport { Flex } from '#UNSAFE_Flex';\nimport { HighlightText } from '#UNSAFE_HighlightText';\nimport { ListItemText } from '#UNSAFE_ListItemLayout';\nimport { Skeleton } from '#UNSAFE_Skeleton';\nimport type { Item } from '#utils/UNSAFE_dataProvider';\nimport type { Keys } from '#utils/UNSAFE_keys';\nimport type { ItemTextType } from '#utils/UNSAFE_selectUtils';\nimport type { ComponentChildren, ComponentProps } from 'preact';\nimport { useCallback, useMemo } from 'preact/hooks';\nimport { renderItemText } from './itemTextUtils';\nimport { dropdownStyles } from './themes/dropdownStyles.css';\n\ntype ListProps<K extends string | number, D> = ComponentProps<typeof List<K, D>>;\ntype PickedPropsFromList = Pick<\n  ComponentProps<typeof List>,\n  'aria-label' | 'currentItemVariant' | 'selectionMode'\n>;\n\n// pick the props from the ListItemContext instead of extending it directly so that we\n// don't automatically expose any new props that may be added to it\ntype PickedPropsFromListItemContext<K, D> = Pick<\n  ListItemRendererContext<K, D>,\n  'data' | 'index' | 'selector'\n>;\ntype ItemRendererSelectionDetail<K> = {\n  value: Set<K>;\n  target: EventTarget | null;\n};\ntype ItemRendererMetadata<K> = Pick<Metadata<K>, 'key' | 'suggestion'>;\ntype ItemRendererProps<K, D> = PickedPropsFromListItemContext<K, D> & {\n  metadata: ItemRendererMetadata<K>;\n  searchText?: string;\n  selectedKeys?: Set<K>;\n  onSelectionChange: (detail: ItemRendererSelectionDetail<K>) => void;\n};\n\ntype DefaultListCurrentKeyDetail<K> = { value: K };\ntype DefaultListItemActionDetail<K, D> = { context: Item<K, D> };\ntype DefaultListSelectionDetail<K> = { value: Set<K> };\n\ntype Props<K extends string | number, D extends Record<string, any>> = PickedPropsFromList & {\n  itemRenderer?: (itemRendererProps: ItemRendererProps<K, D>) => ComponentChildren;\n  itemText: ItemTextType<K, D>;\n  // props from List that we constrain or unconstrain\n  currentKey?: K;\n  data?: DataState<K, D> | null;\n  onCurrentKeyChange: (detail: DefaultListCurrentKeyDetail<K>) => void;\n  onItemAction?: (detail: DefaultListItemActionDetail<K, D>) => void;\n  onLoadRange?: ComponentProps<typeof List>['onLoadRange'];\n  onSelectionChange?: (detail: DefaultListSelectionDetail<K>) => void;\n  searchText?: string;\n  selectedKeys?: Set<K>;\n};\n\nconst noOp = () => {};\n\nexport function DefaultList<K extends string | number, D extends Record<string, any>>({\n  'aria-label': ariaLabel,\n  currentItemVariant,\n  currentKey,\n  data,\n  itemRenderer,\n  itemText,\n  onCurrentKeyChange,\n  onItemAction,\n  onLoadRange = noOp,\n  onSelectionChange,\n  searchText,\n  selectedKeys,\n  selectionMode\n}: Props<K, D>) {\n  const listItemRenderer = useCallback(\n    (listItemContext: ListItemRendererContext<K, D>) => {\n      // specify the listItemContext props that we want to expose individually instead of\n      // spreading the whole object so that we don't automatically include any new props that\n      // may be added to it\n      const itemRendererProps: ItemRendererProps<K, D> = {\n        data: listItemContext.data,\n        index: listItemContext.index,\n        metadata: listItemContext.metadata,\n        selector: listItemContext.selector,\n        searchText,\n        selectedKeys,\n        onSelectionChange: ({ value }) => {\n          onSelectionChange?.({ value });\n        }\n      };\n      const itemContext = {\n        data: listItemContext.data,\n        key: listItemContext.metadata.key,\n        metadata: listItemContext.metadata\n      };\n      return itemRenderer ? (\n        itemRenderer(itemRendererProps)\n      ) : (\n        <Flex align=\"center\">\n          {listItemContext.selector && (\n            <div class={dropdownStyles.selectorWrapper}>{listItemContext.selector()}</div>\n          )}\n          <div\n            class={\n              selectionMode === 'single'\n                ? dropdownStyles.singleSelectItem\n                : dropdownStyles.multiSelectItem\n            }>\n            <ListItemText variant=\"primary\">\n              <HighlightText matchText={searchText}>\n                {renderItemText(itemContext, itemText) as string}\n              </HighlightText>\n            </ListItemText>\n          </div>\n        </Flex>\n      );\n    },\n    [itemRenderer, itemText, onSelectionChange, searchText, selectedKeys, selectionMode]\n  );\n\n  const keys = useMemo(() => {\n    return { all: false, keys: selectedKeys ?? new Set<K>() };\n  }, [selectedKeys]) as Keys<K>;\n\n  const currentItemOverride = useMemo(\n    () => (currentKey !== undefined ? { rowKey: currentKey } : undefined),\n    [currentKey]\n  );\n  const handleItemAction = useCallback<NonNullable<ListProps<K, D>['onItemAction']>>(\n    ({ context: { data, metadata } }) => {\n      onItemAction?.({ context: { data, key: metadata.key, metadata } });\n    },\n    [onItemAction]\n  );\n  const handleSelectionChange = useCallback<NonNullable<ListProps<K, D>['onSelectionChange']>>(\n    ({ value }) => {\n      onSelectionChange?.({ value: new Set(value.keys?.values()) });\n    },\n    [onSelectionChange]\n  );\n\n  return (\n    <List<K, D>\n      aria-label={ariaLabel}\n      allowTabbableMode={false}\n      currentItemVariant={currentItemVariant}\n      currentItemOverride={currentItemOverride}\n      data={data ?? null}\n      loadingIndicator={loadingIndicator}\n      onPersistCurrentItem={onCurrentKeyChange}\n      onItemAction={handleItemAction}\n      onLoadRange={onLoadRange}\n      onSelectionChange={handleSelectionChange}\n      role=\"listbox\"\n      selectedKeys={keys}\n      selectionMode={selectionMode}>\n      {(context: ListItemRendererContext<K, D>) => listItemRenderer(context)}\n    </List>\n  );\n}\n\n/**\n * Custom 3 Skeleton loader for select multiple\n * TODO: to remove this once  is solved\n */\nconst loadingIndicator = (\n  <SkeletonContainer minimumCount={3}>\n    {() => {\n      return (\n        <Flex height=\"12x\" align=\"center\">\n          <Skeleton height=\"4x\" />\n        </Flex>\n      );\n    }}\n  </SkeletonContainer>\n);\n","export const isSimpleClick = (event: MouseEvent) => {\n  return event.button === 0 && !event.ctrlKey;\n};\n\nexport const preventDefault = (event: Event) => {\n  event.preventDefault();\n};\n\nexport const preventDefaultForCurrentTarget = (event: MouseEvent) => {\n  if (event.currentTarget === event.target) {\n    event.preventDefault();\n  }\n};\n","/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\n\nimport { useCallback } from 'preact/hooks';\nimport { usePress } from '../hooks/UNSAFE_usePress';\nimport { DropdownArrowIcon } from '../PRIVATE_ThemedIcons/DropdownArrowIcon';\nimport { classNames } from '../utils/UNSAFE_classNames';\nimport { dropdownStyles } from './themes/dropdownStyles.css';\nimport { useComponentTheme } from '#hooks/UNSAFE_useComponentTheme';\nimport { ButtonLabelLayoutRedwoodTheme } from '#UNSAFE_ButtonLabelLayout/themes/redwood/ButtonLabelLayoutTheme';\nimport type { ButtonLabelLayoutVariantOptions } from '#UNSAFE_ButtonLabelLayout/themes/ButtonLabelLayoutStyles.css';\nimport { TestIdProps, useTestId } from '#hooks/UNSAFE_useTestId';\nimport { BaseButtonRedwoodTheme } from '#UNSAFE_BaseButton/themes/redwood/BaseButtonTheme';\n\ntype Props = TestIdProps & {\n  isDisabled?: boolean;\n  onClick?: () => void;\n};\n\nconst noop = () => {};\n\nexport function DropdownArrow({ isDisabled = false, onClick, testId }: Props) {\n  const { classes } = useComponentTheme<ButtonLabelLayoutVariantOptions>(\n    ButtonLabelLayoutRedwoodTheme,\n    { size: 'sm' }\n  );\n  const { baseTheme } = useComponentTheme(BaseButtonRedwoodTheme);\n\n  const preventDefault = useCallback((event: Event) => {\n    event.preventDefault();\n  }, []);\n  const { pressProps } = usePress(onClick ?? noop, { isDisabled });\n\n  // TODO: JET-67410 replace this with a icon button\n  const styleClasses = classNames([\n    classes,\n    baseTheme,\n    dropdownStyles.arrow.base,\n    isDisabled ? dropdownStyles.arrow.disabled : dropdownStyles.arrow.enabled\n  ]);\n\n  const testIdProps = useTestId(testId);\n\n  return (\n    <span\n      aria-hidden=\"true\"\n      class={styleClasses}\n      tabIndex={-1}\n      onMouseDown={preventDefault}\n      {...testIdProps}\n      {...pressProps}>\n      <DropdownArrowIcon />\n    </span>\n  );\n}\n","/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\n\nimport type { ComponentChildren, ComponentProps, Ref } from 'preact';\n\nimport { CollectionInteractionContext } from '#hooks/UNSAFE_useCollectionInteractionContext';\nimport { classNames } from '#utils/UNSAFE_classNames';\nimport { preventDefaultForCurrentTarget } from './eventUtils';\nimport { dropdownStyles } from './themes/dropdownStyles.css';\n\ntype Props = Pick<ComponentProps<'div'>, 'id' | 'onKeyDown'> & {\n  children?: ComponentChildren;\n  dropdownListRef?: Ref<HTMLDivElement>;\n  hasTopGap?: boolean;\n  hasBottomGap?: boolean;\n  isLoading?: boolean;\n};\n\nexport function DropdownList({\n  children,\n  id,\n  dropdownListRef,\n  hasTopGap = true,\n  hasBottomGap = true,\n  isLoading = false,\n  onKeyDown\n}: Props) {\n  const styleClasses = classNames([\n    dropdownStyles.list.base,\n    hasTopGap && dropdownStyles.list.topGap,\n    hasBottomGap && dropdownStyles.list.bottomGap,\n    isLoading && dropdownStyles.list.loading\n  ]);\n  return (\n    <CollectionInteractionContext.Provider value={'embedded'}>\n      <div\n        ref={dropdownListRef}\n        class={styleClasses}\n        id={id}\n        onMouseDown={preventDefaultForCurrentTarget}\n        onKeyDown={onKeyDown}>\n        {children}\n      </div>\n    </CollectionInteractionContext.Provider>\n  );\n}\n","/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\n\nimport { useTranslationBundle } from '../hooks/UNSAFE_useTranslationBundle';\nimport { BundleType } from '../resources/nls/bundle';\nimport { preventDefaultForCurrentTarget } from './eventUtils';\nimport { dropdownStyles } from './themes/dropdownStyles.css';\n\nexport function EmptyResults() {\n  const translations = useTranslationBundle<BundleType>('@oracle/oraclejet-preact');\n\n  // call preventDefault for mousedown on this div so that focus does not transfer from\n  // the input\n  return (\n    <div class={dropdownStyles.results.extraItem} onMouseDown={preventDefaultForCurrentTarget}>\n      {translations.select_noMatchesFound()}\n    </div>\n  );\n}\n","/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\n\nimport type { DataState } from '#UNSAFE_Collection';\nimport { getClientHints } from '#utils/PRIVATE_clientHints';\nimport type { Item } from '#utils/UNSAFE_dataProvider';\n\n/**\n * Helper function to determine whether the current device is a mobile device\n * @returns true if running on a mobile device, false otherwise\n */\nexport function isMobile() {\n  const deviceType = getClientHints().deviceType;\n  return deviceType === 'phone' || deviceType === 'tablet';\n}\n\n/**\n * Helper function to determine whether the current device is a phone\n * @returns true if running on a phone, false otherwise\n */\nexport function isPhone() {\n  return getClientHints().deviceType === 'phone';\n}\n\n/**\n * Helper function to determine whether the current device is a tablet\n * @returns true if running on a tablet, false otherwise\n */\nexport function isTablet() {\n  return getClientHints().deviceType === 'tablet';\n}\n\nexport function isBeforeDataFetch<K, D>(data: DataState<K, D>) {\n  return data.sizePrecision === 'atLeast' && data.totalSize === 0;\n}\n\nexport function isSearchTextEmptyOrUndefined(searchText?: string) {\n  return searchText === undefined || searchText.length === 0;\n}\n\n/**\n * Extract keys from a value items array.\n *\n * @param valueItems The value items from which the keys are to be extracted\n * @returns The set of keys\n */\nexport function createKeysFromValueItems<K, D>(valueItems?: Item<K, D>[]) {\n  const keys = valueItems?.reduce((accumKeys, currentItem) => {\n    accumKeys.add(currentItem.key);\n    return accumKeys;\n  }, new Set<K>());\n  return keys;\n}\n","import type { DataState } from '#UNSAFE_Collection';\nimport type { Item } from '#utils/UNSAFE_dataProvider';\nimport { useMemo } from 'preact/compat';\n\ntype Key = string | number;\ntype Data = Record<string, any>;\n\ntype UseCollectionRendererCommonParams<K> = {\n  currentKey?: K;\n  searchText?: string;\n  selectedKeys?: Set<K>;\n  onCurrentKeyChange: (detail: { value?: K }) => void;\n};\n\nexport type UseCollectionRendererSelectSingleParams<K, D> = UseCollectionRendererCommonParams<K> & {\n  onItemAction: (detail: { context: Item<K, D> }) => void;\n  onSelectedKeysChange?: never;\n  selectedOnlyData?: never;\n};\n\nexport type UseCollectionRendererSelectMultipleParams<K, D> =\n  UseCollectionRendererCommonParams<K> & {\n    onItemAction?: never;\n    onSelectedKeysChange: (detail: { value: Set<K> }) => void;\n    selectedOnlyData?: DataState<K, D>;\n  };\n\ntype UseCollectionRendererParams<K, D> =\n  | UseCollectionRendererSelectSingleParams<K, D>\n  | UseCollectionRendererSelectMultipleParams<K, D>;\n\ntype CommonCollectionRendererContext<K extends Key> = {\n  searchText?: string;\n  currentRowKeyOverride?: K;\n  onPersistCurrentRowKey: (detail: { value?: K }) => void;\n  selected?: Set<K>;\n};\n\nexport type SelectSingleCollectionRendererContext<\n  K extends Key,\n  D extends Data\n> = CommonCollectionRendererContext<K> & {\n  onRowAction: (detail: { context: Item<K, D> }) => void;\n};\n\nexport type SelectMultipleCollectionRendererContext<\n  K extends Key,\n  D extends Data\n> = CommonCollectionRendererContext<K> & {\n  onSelectedChange: (detail: { value: Set<K> }) => void;\n  selectedOnlyData?: DataState<K, D>;\n};\n\ntype CollectionRendererContext<K extends Key, D extends Data> =\n  | SelectSingleCollectionRendererContext<K, D>\n  | SelectMultipleCollectionRendererContext<K, D>;\n\n// NOTE: We will using a single hook that constructs the collection renderer context for both select single and\n// select multiple. This is ok as they both share most of the properties and differ only in a few areas. So, we will\n// be using function overloading to determine which component is calling the hook (based on the args) and return the\n// correct context.\n\n/**\n * A custom hook that constructs the context for SelectSingle's collectionRenderer.\n * @param params Parameters for constructing the collection renderer context\n * @returns the CollectionRendererContext object\n */\nexport function useCollectionRenderer<K extends Key, D extends Data>(\n  params: UseCollectionRendererSelectSingleParams<K, D>\n): SelectSingleCollectionRendererContext<K, D>;\n\n/**\n * A custom hook that constructs the context for SelectMultiple's collectionRenderer.\n * @param params Parameters for constructing the collection renderer context\n * @returns the CollectionRendererContext object\n */\nexport function useCollectionRenderer<K extends Key, D extends Data>(\n  params: UseCollectionRendererSelectMultipleParams<K, D>\n): SelectMultipleCollectionRendererContext<K, D>;\n\n/**\n * A custom hook that constructs the context for SelectSingle/SelectMultiple's collectionRenderer.\n * @param param0 Parameters for constructing the collection renderer context\n * @returns the CollectionRendererContext object\n */\nexport function useCollectionRenderer<K extends Key, D extends Data>({\n  currentKey,\n  onCurrentKeyChange,\n  onItemAction,\n  onSelectedKeysChange,\n  searchText,\n  selectedKeys,\n  selectedOnlyData\n}: UseCollectionRendererParams<K, D>) {\n  return useMemo<CollectionRendererContext<K, D>>(() => {\n    const common = {\n      searchText,\n      currentRowKeyOverride: currentKey,\n      onPersistCurrentRowKey: onCurrentKeyChange,\n      selected: selectedKeys\n    } satisfies CommonCollectionRendererContext<K>;\n\n    // If onItemAction is present, then we are constructing context for SelectSingle. So,\n    // return the context satisfying SelectSingleCollectionRendererContext type.\n    if (onItemAction !== undefined)\n      return {\n        ...common,\n        onRowAction: onItemAction\n      } satisfies SelectSingleCollectionRendererContext<K, D>;\n\n    // If onItemAction is not present, then we are constructing context for SelectMultiple. So,\n    // return the context satisfying SelectMultipleCollectionRendererContext type.\n    return {\n      ...common,\n      onSelectedChange: onSelectedKeysChange,\n      selectedOnlyData\n    } satisfies SelectMultipleCollectionRendererContext<K, D>;\n  }, [\n    currentKey,\n    onCurrentKeyChange,\n    onItemAction,\n    onSelectedKeysChange,\n    searchText,\n    selectedKeys,\n    selectedOnlyData\n  ]);\n}\n","/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\n\nimport type { RefObject } from 'preact';\nimport { useCallback, useEffect, useRef, useState } from 'preact/hooks';\n\nimport type { DataState } from '#UNSAFE_Collection';\nimport type { PositionData } from '#UNSAFE_Floating';\nimport { KEYS, isControlOrFunctionKey } from '#utils/PRIVATE_keyboardUtils';\nimport { allTabbableElements } from '#utils/PRIVATE_tabbableUtils';\nimport type { ValueUpdateDetail } from '#utils/UNSAFE_valueUpdateDetail';\nimport { isSimpleClick } from './eventUtils';\n\ntype UseSelectCommonProps<K, D> = {\n  data?: DataState<K, D> | null;\n  inputRef: RefObject<HTMLElement>;\n  isFocused?: boolean;\n  onFilter?: ({ searchText }: { searchText?: string }) => void;\n};\n\nexport type CurrentKeyDetail<K> = {\n  value?: K;\n};\n\n/**\n * Hook that manages state and behavior for a Select* component.  This hook creates state\n * variables and event listeners, returning properties to apply to components internally\n * rendered by a Select* component, as well as state information.\n *\n * @param data Specifies data for the dropdown list.\n * @param inputRef Ref to the input element.\n * @param isFocused Specifies whether the component has focus.\n * @param onFilter Callback function to trigger loading data for the dropdown list,\n * which may or may not be filtered by user entered text.\n *\n * @returns Component state and event listeners.\n */\nexport function useSelectCommon<K, D>({\n  data,\n  inputRef,\n  isFocused,\n  onFilter\n}: UseSelectCommonProps<K, D>) {\n  const mainFieldRef = useRef<HTMLDivElement>(null);\n  const dropdownRef = useRef<HTMLDivElement>(null);\n  const [isDropdownOpen, setDropdownOpen] = useState(false);\n  const [isDropdownAbove, setDropdownAbove] = useState(false);\n\n  // We only need to push currentRow when we need to override the\n  // current row, like when the dropdown is opened and we want to set the initial\n  // focused row or when filtering and we want to focus the first row.\n  const [currentRowOverride, _setCurrentRowOverride] = useState<{ rowKey?: K }>({\n    rowKey: undefined\n  });\n  // We still need information on what the current row actually is, but we do not need\n  // to react to it until certain scenarios like pressing Tab from the dropdown. So, we\n  // just store this in a ref.\n  const currentRowKeyRef = useRef<K>();\n  // When we want to update the currentRowOverride, we also want to keep the currentRowKeyRef\n  // in sync as the collection will not call onChanged for this change.\n  const setCurrentRowOverride = useCallback((currentRow: { rowKey?: K }) => {\n    currentRowKeyRef.current = currentRow.rowKey;\n    _setCurrentRowOverride(currentRow);\n  }, []);\n  const [isUserFiltering, setUserFiltering] = useState(false);\n  const [userInput, setUserInput] = useState<string>();\n  const [searchText, setSearchText] = useState<string>();\n\n  const [prevIsDropdownOpen, setPrevIsDropdownOpen] = useState(isDropdownOpen);\n  const [prevIsFocused, setPrevIsFocused] = useState(isFocused);\n  const [prevIsUserFiltering, setPrevIsUserFiltering] = useState(isUserFiltering);\n\n  const onMouseDown = useCallback(\n    (event: MouseEvent) => {\n      // const target = event.target as HTMLElement;\n      if (event.defaultPrevented || !isSimpleClick(event)) {\n        return;\n      }\n      if (!isDropdownOpen) {\n        setDropdownOpen(true);\n      }\n      // this is needed to focus the input when clicking on the inside label when there is no\n      // value;  otherwise the component looks focused but doesn't actually have physical focus\n      setTimeout(function () {\n        inputRef.current?.focus();\n      }, 0);\n    },\n    [inputRef, isDropdownOpen]\n  );\n\n  const handleDropdownArrowClick = useCallback(() => {\n    setDropdownOpen(!isDropdownOpen);\n\n    // focus the input so that if the user Tabs afterwards, it loses focus and the dropdown closes\n    inputRef.current?.focus();\n  }, [inputRef, isDropdownOpen]);\n\n  const handleDropdownAutoDismiss = useCallback(\n    (event?: Event) => {\n      if (isDropdownOpen) {\n        setDropdownOpen(false);\n\n        switch (event?.type) {\n          case 'keydown': {\n            const keyboardEvent = event as KeyboardEvent;\n            switch (keyboardEvent.code) {\n              case KEYS.ESC:\n                // focus the input when the user cancels out of the dropdown\n                inputRef.current?.focus();\n                break;\n              default:\n                break;\n            }\n            break;\n          }\n          case 'mousedown':\n            // if focus is in the dropdown, focus the input before the dropdown is hidden so that\n            // focus will transfer correctly when the target is not focusable;\n            // otherwise the text cursor appears in the input again\n            if (dropdownRef.current?.contains(document.activeElement)) {\n              inputRef.current?.focus();\n            }\n            break;\n          default:\n            break;\n        }\n      }\n    },\n    [inputRef, isDropdownOpen]\n  );\n\n  const handleDropdownPosition = useCallback((data: PositionData) => {\n    setDropdownAbove(data.placement.startsWith('top'));\n  }, []);\n\n  const getDropdownTabbableElems = useCallback(() => {\n    return isDropdownOpen && dropdownRef.current\n      ? allTabbableElements(dropdownRef.current)\n      : undefined;\n  }, [isDropdownOpen]);\n\n  const handleUpDownArrowKeys = useCallback(\n    (event: KeyboardEvent) => {\n      if (!isDropdownOpen) {\n        setDropdownOpen(true);\n      } else {\n        // JET-64909 - focus / 'current' dropped when arrow keying during loading\n        // Transfer physical focus into the dropdown only if the data is present and the dropdown\n        // has rendered the data. Otherwise, keep the focus in the field.\n        if (data != null) {\n          const tabbableElems = getDropdownTabbableElems();\n          tabbableElems?.[0]?.focus();\n\n          // if there is no current item set, make the first item current\n          if (currentRowOverride.rowKey === undefined) {\n            setCurrentRowOverride({ rowKey: data.data[0]?.metadata?.key });\n          }\n        }\n      }\n\n      // prevent the page from scrolling\n      event.preventDefault();\n    },\n    [currentRowOverride, data, getDropdownTabbableElems, isDropdownOpen, setCurrentRowOverride]\n  );\n\n  const handleMainFieldKeyDown = useCallback(\n    (event: KeyboardEvent) => {\n      // const target = event.target as HTMLElement;\n      // ignore control key and function key\n      if (isControlOrFunctionKey(event)) {\n        return;\n      }\n\n      switch (event.code) {\n        case KEYS.PAGE_UP:\n        case KEYS.PAGE_DOWN:\n          // prevent the page from scrolling\n          event.preventDefault();\n\n          return;\n\n        case KEYS.UP:\n        case KEYS.DOWN:\n          // prevent the page from scrolling\n          event.preventDefault();\n          break;\n\n        case KEYS.ESC:\n          if (isDropdownOpen) {\n            setDropdownOpen(false);\n\n            event.preventDefault();\n\n            // JET-53183 - core pack compat: stop propagation of handled events\n            // we don't want a parent collection component to stop editing the row when we close\n            // the dropdown\n            event.stopPropagation();\n          }\n          break;\n\n        default:\n          break;\n      }\n    },\n    [isDropdownOpen]\n  );\n\n  const handleMainFieldKeyUp = useCallback(\n    (event: KeyboardEvent) => {\n      // ignore control key and function key\n      if (isControlOrFunctionKey(event)) {\n        return;\n      }\n\n      switch (event.code) {\n        case KEYS.UP:\n        case KEYS.DOWN:\n          handleUpDownArrowKeys(event);\n          break;\n\n        default:\n          break;\n      }\n    },\n    [handleUpDownArrowKeys]\n  );\n\n  const handleInput = useCallback(\n    (detail: ValueUpdateDetail<string>) => {\n      if (!isDropdownOpen) {\n        setDropdownOpen(true);\n      }\n      setUserFiltering(true);\n      setUserInput(detail.value);\n      const str = detail.value;\n      setSearchText(str);\n      onFilter?.({ searchText: str });\n    },\n    [isDropdownOpen, onFilter]\n  );\n\n  const onCurrentKeyChange = useCallback((detail: CurrentKeyDetail<K>) => {\n    // when the collection changes the current key, we only want to store the information\n    // and not do anything.\n    currentRowKeyRef.current = detail.value;\n  }, []);\n\n  const stopFiltering = useCallback(() => {\n    setUserFiltering(false);\n    setUserInput('');\n    setSearchText('');\n  }, []);\n\n  const updateFiltering = useCallback((value?: string) => {\n    setUserFiltering(true);\n    setUserInput(value);\n    setSearchText(value);\n  }, []);\n\n  // the user is not actively filtering if the dropdown is closed and the component doesn't\n  // have focus\n  if (\n    prevIsDropdownOpen !== isDropdownOpen ||\n    prevIsFocused !== isFocused ||\n    prevIsUserFiltering !== isUserFiltering\n  ) {\n    if (!isDropdownOpen && !isFocused && isUserFiltering) {\n      stopFiltering();\n    }\n  }\n\n  // need to call onFilter with undefined searchText when the dropdown opens and the\n  // user is NOT filtering\n  useEffect(() => {\n    if (isDropdownOpen && !isUserFiltering) {\n      onFilter?.({ searchText: undefined });\n    }\n  }, [isDropdownOpen, isUserFiltering, onFilter]);\n\n  // when the dropdown closes, reset the isDropdownAbove flag\n  if (prevIsDropdownOpen !== isDropdownOpen) {\n    if (!isDropdownOpen) {\n      setDropdownAbove(false);\n    }\n    setPrevIsDropdownOpen(isDropdownOpen);\n  }\n\n  if (prevIsFocused !== isFocused) {\n    setPrevIsFocused(isFocused);\n  }\n  if (prevIsUserFiltering !== isUserFiltering) {\n    setPrevIsUserFiltering(isUserFiltering);\n  }\n\n  return {\n    currentRowKeyRef,\n    currentRowOverride,\n    dropdownRef,\n    getDropdownTabbableElems,\n    handleDropdownArrowClick,\n    handleDropdownAutoDismiss,\n    handleDropdownPosition,\n    handleInput,\n    handleMainFieldKeyDown,\n    handleMainFieldKeyUp,\n    handleUpDownArrowKeys,\n    isDropdownAbove,\n    isDropdownOpen,\n    // the field should remain to look focused while the dropdown is open,\n    // in case physical focus is in the dropdown\n    isFocused: isFocused || isDropdownOpen,\n    isUserFiltering,\n    mainFieldRef,\n    onCurrentKeyChange,\n    onMouseDown,\n    searchText,\n    setCurrentRowOverride,\n    setDropdownOpen,\n    setUserInput,\n    stopFiltering,\n    updateFiltering,\n    userInput\n  };\n}\n"],"names":["error","useCallback","_jsxs","Flex","_jsx","dropdownStyles","ListItemText","HighlightText","useMemo","List","SkeletonContainer","Skeleton","useComponentTheme","ButtonLabelLayoutRedwoodTheme","BaseButtonRedwoodTheme","usePress","classNames","useTestId","DropdownArrowIcon","CollectionInteractionContext","useTranslationBundle","getClientHints","useRef","useState","KEYS","allTabbableElements","isControlOrFunctionKey","useEffect"],"mappings":"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"}