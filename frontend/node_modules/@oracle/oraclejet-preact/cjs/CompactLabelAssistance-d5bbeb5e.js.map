{"version":3,"file":"CompactLabelAssistance-d5bbeb5e.js","sources":["../../src/UNSAFE_UserAssistance/usePopupFocusWithin.ts","../../src/UNSAFE_UserAssistance/CompactHelpSource.tsx","../../src/UNSAFE_UserAssistance/CompactLabelAssistance.tsx"],"sourcesContent":["import { useCallback, useRef } from 'preact/hooks';\n\nimport { useFocusWithin } from '../hooks/UNSAFE_useFocusWithin';\n\nexport function usePopupFocusWithin() {\n  const ref = useRef<HTMLElement | null>(null);\n  const { focusProps, isFocused } = useFocusWithin();\n\n  const onTransitionEnd = useCallback(\n    (isAfterOpen?: boolean) => {\n      if (isAfterOpen) {\n        if (focusProps.onFocusIn) {\n          ref.current?.addEventListener('focusin', focusProps.onFocusIn, false);\n        }\n        if (focusProps.onFocusOut) {\n          ref.current?.addEventListener('focusout', focusProps.onFocusOut, false);\n        }\n      } else {\n        if (focusProps.onFocusIn) {\n          ref.current?.removeEventListener('focusin', focusProps.onFocusIn, false);\n        }\n        if (focusProps.onFocusOut) {\n          ref.current?.removeEventListener('focusout', focusProps.onFocusOut, false);\n        }\n      }\n    },\n    [focusProps.onFocusIn, focusProps.onFocusOut, ref]\n  );\n\n  return {\n    isFocused,\n    popupProps: {\n      onTransitionEnd,\n      ref\n    }\n  };\n}\n","import { useState, useRef } from 'preact/hooks';\n\nimport { useTabbableMode } from '../hooks/UNSAFE_useTabbableMode';\nimport { useTranslationBundle } from '../hooks/UNSAFE_useTranslationBundle';\nimport { BundleType } from '../resources/nls/bundle';\nimport { classNames } from '../utils/UNSAFE_classNames';\nimport { HelpIcon } from '../PRIVATE_ThemedIcons/HelpIcon';\nimport { Popup } from '../UNSAFE_Popup';\nimport { usePopupFocusWithin } from './usePopupFocusWithin';\nimport {\n  helpIconBase,\n  helpIconLabelEdgeStart,\n  helpContentStyles\n} from './themes/UserAssistanceStyles.css';\nimport { useComponentTheme } from '../hooks/UNSAFE_useComponentTheme';\nimport { LabelRedwoodTheme } from '../UNSAFE_Label/themes/redwood/LabelTheme';\n\ntype Props = {\n  children?: string;\n  id?: string;\n  labelEdge?: 'inside' | 'start' | 'top';\n  source?: string;\n};\n\nexport function CompactHelpSource({ children, id, labelEdge, source }: Props) {\n  const [isOver, setOver] = useState(false);\n  const translations = useTranslationBundle<BundleType>('@oracle/oraclejet-preact');\n  const userAssistance_learnMoreStr = translations.userAssistance_learnMore();\n  const { isTabbable, tabbableModeProps } = useTabbableMode();\n  const flip = { mainAxis: true, crossAxis: false };\n  // TODO: Implement and use a preact Link component instead of using an anchor tag\n  const anchorRef = useRef<HTMLAnchorElement>(null);\n\n  const text = children ?? userAssistance_learnMoreStr;\n\n  // helpIconBase references 'Label' vars, so we need to get the baseTheme for 'Label' and include it in the class list\n  // so that we pick up the definitions for the labelVars we are using.\n  const { baseTheme: labelBaseTheme } = useComponentTheme(LabelRedwoodTheme);\n\n  const styles = classNames([\n    labelBaseTheme,\n    helpIconBase,\n    labelEdge === 'start' && helpIconLabelEdgeStart\n  ]);\n\n  const { isFocused: isPopupFocused, popupProps } = usePopupFocusWithin();\n\n  const isOpen = isOver === true || isPopupFocused === true;\n\n  return (\n    <>\n      <a\n        target=\"_blank\"\n        {...(source && { href: source })}\n        aria-label={text}\n        class={styles}\n        id={id}\n        ref={anchorRef}\n        role=\"link\"\n        onMouseEnter={() => setOver(true)}\n        onMouseLeave={() => setOver(false)}\n        onFocus={() => setOver(true)}\n        onBlur={() => setOver(false)}\n        {...(!isTabbable ? tabbableModeProps : { tabIndex: 0 })}>\n        <HelpIcon />\n      </a>\n      <Popup\n        {...popupProps}\n        placement=\"end-top-corner\"\n        isOpen={isOpen}\n        anchorRef={anchorRef}\n        flipOptions={flip}\n        role=\"tooltip\"\n        maxWidth={'296px'}>\n        <div class={helpContentStyles}>{text}</div>\n      </Popup>\n    </>\n  );\n}\n","import { useTooltip } from '../hooks/UNSAFE_useTooltip';\nimport { useTranslationBundle } from '../hooks/UNSAFE_useTranslationBundle';\nimport { BundleType } from '../resources/nls/bundle';\nimport { classNames } from '../utils/UNSAFE_classNames';\nimport { CompactHelpSource } from './CompactHelpSource';\nimport { requiredIconBase, requiredIconLabelEdgeStart } from './themes/UserAssistanceStyles.css';\n\ntype Props = {\n  helpIconId?: string;\n  helpSourceLink?: string;\n  helpSourceText?: string;\n  isRequiredShown?: boolean;\n  labelEdge?: 'inside' | 'start' | 'top';\n};\n\nconst CompactLabelAssistance = ({\n  helpIconId,\n  helpSourceLink,\n  helpSourceText,\n  isRequiredShown,\n  labelEdge\n}: Props) => {\n  const translations = useTranslationBundle<BundleType>('@oracle/oraclejet-preact');\n  const requiredStr = translations.userAssistance_required();\n\n  const { tooltipContent, tooltipProps } = useTooltip({\n    text: requiredStr,\n    offset: { mainAxis: 8 }\n  });\n\n  const requiredStyles = classNames([\n    requiredIconBase,\n    labelEdge === 'start' && requiredIconLabelEdgeStart\n  ]);\n  const requiredIndicator = isRequiredShown && (\n    <span>\n      <span class={requiredStyles} {...tooltipProps} />\n      {tooltipContent}\n    </span>\n  );\n\n  const helpIndicator = (helpSourceLink || helpSourceText) && (\n    <CompactHelpSource id={helpIconId} labelEdge={labelEdge} source={helpSourceLink}>\n      {helpSourceText}\n    </CompactHelpSource>\n  );\n\n  return (\n    <>\n      {labelEdge !== 'start' && requiredIndicator}\n      {helpIndicator}\n      {labelEdge === 'start' && requiredIndicator}\n    </>\n  );\n};\n\nexport { CompactLabelAssistance };\n"],"names":["useRef","useFocusWithin","useCallback","useState","useTranslationBundle","useTabbableMode","useComponentTheme","LabelRedwoodTheme","classNames","helpIconBase","helpIconLabelEdgeStart","_jsxs","_Fragment","_jsx","HelpIcon","Popup","helpContentStyles","useTooltip","requiredIconBase","requiredIconLabelEdgeStart"],"mappings":"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"}