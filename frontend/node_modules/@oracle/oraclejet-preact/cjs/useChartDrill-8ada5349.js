/* @oracle/oraclejet-preact: undefined */
'use strict';

var hooks = require('preact/hooks');
var eventsUtils = require('./eventsUtils-d34f8647.js');
require('./accUtils-5c7d3255.js');
var useVisDrill = require('./useVisDrill-61cccf0f.js');

const isDrillable = (info, drilling, levelsArray, getDataItem) => {
    const { seriesIndex, groupIndex, levelIndex } = info;
    if (groupIndex === undefined || levelsArray.length < 1) {
        return false;
    }
    const groupInfo = levelsArray[levelsArray.length - 1][groupIndex];
    if (seriesIndex != null) {
        const itemDrilling = getDataItem(seriesIndex, groupIndex, groupInfo.path)?.drilling != 'off';
        return drilling === 'on' && itemDrilling;
    }
    else if (levelIndex !== undefined) {
        return levelsArray[levelIndex][groupIndex].item.drilling != 'off';
    }
    return false;
};
/**
 * Returns the event handlers for drill support.
 */
function useChartDrill({ rootRef, focusedItemInfo, focusedGroupInfo, levelsArray, selectionMode, drilling, getDataItem, onItemDrill, onGroupDrill }) {
    const processDrill = hooks.useCallback((info) => {
        if (!info ||
            info.groupIndex == undefined ||
            !isDrillable(info, drilling, levelsArray, getDataItem)) {
            return;
        }
        const { seriesIndex, groupIndex, levelIndex } = info;
        const groupInfo = levelsArray[levelIndex != undefined ? levelIndex : levelsArray.length - 1][groupIndex];
        if (seriesIndex != null) {
            const data = getDataItem(seriesIndex, groupIndex, groupInfo.path);
            if (data) {
                onItemDrill?.({
                    groupIndex,
                    seriesIndex,
                    data,
                    id: data?.id,
                    groupPath: groupInfo.path
                });
            }
        }
        else {
            onGroupDrill?.({
                groupIndex,
                group: groupInfo.item,
                id: groupInfo.item.id,
                groupPath: groupInfo.path
            });
        }
    }, [drilling, getDataItem, onGroupDrill, onItemDrill, levelsArray]);
    const onDrill = hooks.useCallback((event) => {
        if (event.type === 'keydown') {
            const focusedInfo = focusedItemInfo.isCurrent ? focusedItemInfo : focusedGroupInfo;
            processDrill(focusedInfo);
        }
        else {
            processDrill(eventsUtils.getInfo(rootRef, event.target));
        }
    }, [rootRef, focusedItemInfo, focusedGroupInfo, processDrill]);
    return useVisDrill.useVisDrill(selectionMode, onDrill);
}

exports.useChartDrill = useChartDrill;
//# sourceMappingURL=useChartDrill-8ada5349.js.map
