{"version":3,"file":"MenuAdapter.js","sources":["../../../../src/UNSAFE_Menu/__testing__/MenuAdapter.ts"],"sourcesContent":["import { TestAdapter } from '@oracle/oraclejet-testing/UNSAFE_TestAdapter';\nimport { TestElement, waitFor } from '@oracle/oraclejet-testing/UNSAFE_Driver';\nimport { byCss } from '@oracle/oraclejet-testing/UNSAFE_Locators';\n\nexport class MenuAdapter extends TestAdapter {\n  /**\n   * Click a MenuItem based on a label/key path\n   * @param path Path that consist of the label/key of the menu item and the label/key of the submenu that leads to the menu item.\n   * @returns Promise<void>\n   */\n  async doMenuAction(\n    path: { label: string | string[]; key?: never } | { key: string | string[]; label?: never }\n  ) {\n    return this._doMenuActionClick(path);\n  }\n\n  /**\n   * Click a SelectMenuItem on a menu group based on a label/key path\n   * @param path Path that consist of the label/key of the menu item and the label/key of the submenu that leads to the menu item. If key is specified it also include item value of the select menu item that is going to be clicked.\n   * @returns Promise<void>\n   */\n  async doMenuGroupAction(\n    path:\n      | { label: string | string[]; key?: never; itemValue?: never }\n      | { key: string | string[]; itemValue?: string; label?: never }\n  ): Promise<void> {\n    return this._doMenuActionClick(path);\n  }\n\n  /**\n   * doMenuActionClick - Coordinates clicking of menu item based on path type.\n   */\n  private async _doMenuActionClick(\n    path:\n      | { label: string | string[]; key?: never; itemValue?: never }\n      | { key: string | string[]; itemValue?: string; label?: never }\n  ) {\n    const pathIdentifier = path.label ? 'label' : 'key';\n    const specificPath = path[pathIdentifier] as string | string[];\n    // We convert path into an array so we handle it in one way for strings and arrays\n    const arraySpecificPath = Array.isArray(specificPath) ? specificPath : [specificPath];\n    for (const [index, identifier] of Object.entries(arraySpecificPath)) {\n      const indexNumber = Number(index);\n\n      // We verify if there are no menu skeletons\n      await waitFor(async () => {\n        const menu = await this.getElement();\n        return !(await menu.waitForElements(byCss(`[oj-menu-skeleton]`))).length;\n      });\n\n      const menuSearchElement = (await this._getMenuElements())[indexNumber];\n      if (path.itemValue && indexNumber === arraySpecificPath.length - 1) {\n        await this._clickSelectMenuItemByKey(identifier, menuSearchElement, path.itemValue);\n      } else {\n        await this._clickActionMenuItem(\n          { [pathIdentifier]: identifier } as { label: string } | { key: string },\n          menuSearchElement\n        );\n      }\n    }\n  }\n  /**\n   * getMenuElements - Returns list of menus available based on the locator of the \"main menu\".\n   */\n  private async _getMenuElements() {\n    const el = await this.getElement();\n    const testId = await el.getAttribute('data-testid');\n    return this.getTestDriver().waitForElements(\n      byCss(`[data-oj-layer]:has([data-testid=${testId}]) [role=menu]`)\n    );\n  }\n  /**\n   * clickActionMenuItem - Click menu item by label or key\n   */\n  private async _clickActionMenuItem(\n    path: { label: string; key?: never } | { key: string; label?: never },\n    searchElement: TestElement\n  ) {\n    const pathType = path.label ? 'label' : 'key';\n    return this._clickingMenuItem(\n      `a[data-oj-${pathType}=${JSON.stringify(path[pathType])}]`,\n      searchElement,\n      `The ${pathType} ${path[pathType]} is invalid or does not exist`\n    );\n  }\n  /**\n   * clickSelectMenuItemByKey - Click a select menu item by group key and value inside an specific menu container. It includes clicking on SelectMenuItem\n   */\n  private async _clickSelectMenuItemByKey(\n    groupKey: string,\n    searchElement: TestElement,\n    itemValue: string\n  ) {\n    return this._clickingMenuItem(\n      `a[data-oj-key=${groupKey}-${itemValue}]`,\n      searchElement,\n      `The group key ${groupKey} or itemValue ${itemValue} is invalid or does not exist`\n    );\n  }\n  /**\n   * clickingMenuItem - Click menu item based on a query. It also handle errors.\n   */\n  private async _clickingMenuItem(query: string, searchElement: TestElement, errMessage: string) {\n    try {\n      const item = await searchElement.waitForElement(byCss(query));\n      return this.getTestDriver().click(item!);\n    } catch {\n      throw new Error(errMessage);\n    }\n  }\n}\n"],"names":["TestAdapter","waitFor","byCss"],"mappings":"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"}