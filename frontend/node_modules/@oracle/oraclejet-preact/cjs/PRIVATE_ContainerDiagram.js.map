{"version":3,"file":"PRIVATE_ContainerDiagram.js","sources":["../../src/PRIVATE_ContainerDiagram/utils/diagramUtils.ts","../../src/PRIVATE_ContainerDiagram/DiagramLabel.tsx","../../src/PRIVATE_ContainerDiagram/DiagramExpandCollapseButton.tsx","../../src/PRIVATE_ContainerDiagram/DiagramNodeElement.tsx","../../src/PRIVATE_ContainerDiagram/DiagramLinkElement.tsx","../../src/PRIVATE_ContainerDiagram/DiagramLabelLayer.tsx","../../src/PRIVATE_ContainerDiagram/DiagramLinkLayer.tsx","../../src/PRIVATE_ContainerDiagram/DiagramPromotedLinkElement.tsx","../../src/PRIVATE_ContainerDiagram/DiagramPromotedLinkLayer.tsx","../../src/PRIVATE_ContainerDiagram/DiagramNodeLayer.tsx","../../src/PRIVATE_ContainerDiagram/DiagramLayers.tsx","../../src/PRIVATE_ContainerDiagram/DiagramPanZoomContainer.tsx","../../src/PRIVATE_ContainerDiagram/utils/navUtils.ts","../../src/PRIVATE_ContainerDiagram/hooks/useDiagramNavigation.ts","../../src/PRIVATE_ContainerDiagram/hooks/useEvents.ts","../../src/PRIVATE_ContainerDiagram/hooks/useDiagramDatatip.ts","../../src/PRIVATE_ContainerDiagram/hooks/usePointerGesture.ts","../../src/PRIVATE_ContainerDiagram/hooks/useDrag.ts","../../src/PRIVATE_ContainerDiagram/utils/panUtils.ts","../../src/PRIVATE_ContainerDiagram/hooks/useDragPan.ts","../../src/PRIVATE_ContainerDiagram/hooks/useWheel.ts","../../src/PRIVATE_ContainerDiagram/utils/zoomUtils.ts","../../src/PRIVATE_ContainerDiagram/hooks/useWheelZoom.ts","../../src/PRIVATE_ContainerDiagram/hooks/usePinch.ts","../../src/PRIVATE_ContainerDiagram/hooks/usePinchZoom.ts","../../src/PRIVATE_ContainerDiagram/hooks/usePanZoom.ts","../../src/PRIVATE_ContainerDiagram/hooks/useDiagramSelection.ts","../../src/PRIVATE_ContainerDiagram/utils/contextMenuUtils.ts","../../src/PRIVATE_ContainerDiagram/hooks/useDiagramContextMenu.ts","../../src/PRIVATE_ContainerDiagram/ContainerDiagramWithDimensions.tsx","../../src/PRIVATE_ContainerDiagram/ContainerDiagram.tsx"],"sourcesContent":["import type {\n  Pan,\n  Zoom,\n  DiagramNodeData,\n  DiagramLinkData,\n  ItemInfo,\n  Bounds,\n  Position,\n  Dimensions,\n  DatatipContext,\n  DiagramLabelStyles,\n  DiagramLabelPosition,\n  DiagramLayoutOutput\n} from '../diagram.types';\nimport type { RefObject } from 'preact';\nimport type { BundleType } from '#resources/nls/bundle';\nimport type { Font, GetTextDimensionsType, TextDimensions } from '#hooks/PRIVATE_useTextDimensions';\nimport { ComponentChildren } from 'preact';\nimport { Property } from 'csstype';\nimport { generateAriaLabel } from '#utils/UNSAFE_visUtils/accUtils';\n\nconst ZOOM_TO_FIT_PADDING = 20;\n/**\n * Returns the pan properties for the diagram.\n */\nexport function getPanProps(\n  props: Pan,\n  contentBounds: Bounds,\n  userDragMode: string | undefined,\n  isDeviceTouch: boolean\n) {\n  return {\n    panning: isDeviceTouch\n      ? userDragMode === 'pan' && props.panning\n        ? props.panning\n        : 'off'\n      : props.panning\n      ? props.panning\n      : 'off',\n    panDirection: props.panDirection ? props.panDirection : 'any',\n    centerX:\n      props.centerX !== undefined ? props.centerX : contentBounds.width / 2 + contentBounds.x,\n    centerY:\n      props.centerY !== undefined ? props.centerY : contentBounds.height / 2 + contentBounds.y,\n    onPan: props.onPan\n  };\n}\n\n/**\n * Returns the zoom properties for the diagram.\n */\nexport function getZoomProps(props: Zoom, width: number, height: number, contentBounds: Bounds) {\n  const zoomTofitZoom = getZoomToFitZoom(width, height, contentBounds);\n  const maxZoom = props.maxZoom || 1;\n  const minZoom = props.minZoom || Math.min(maxZoom, zoomTofitZoom);\n  const zoom = props.zoomValue ? props.zoomValue : zoomTofitZoom;\n  return {\n    zooming: props.zooming ? props.zooming : 'off',\n    // default value of 0 indicates zoom-to-fit level\n    minZoom: minZoom,\n    maxZoom: maxZoom,\n    // zoom value of 0 will default to zoom to fit\n    zoomValue: constrainZoom(zoom, minZoom, maxZoom),\n    onZoom: props.onZoom\n  };\n}\n\n/**\n * Constructs the json object to be passed into the layout function\n */\nexport function constructLayoutJSON<\n  K1,\n  K2,\n  D1 extends DiagramNodeData<K1, D1>,\n  D2 extends DiagramLinkData<K2, K1>\n>(\n  nodeItems: Map<K1, D1>,\n  linkItems: Map<K2, D2>,\n  promotedLinks: DiagramLinkData<string, K1>[],\n  dimensions: Map<K1, Dimensions>,\n  width: number,\n  height: number,\n  nodeBounds: Map<K1, Bounds>,\n  zoom: number,\n  nodeIdToParentMap: Map<K1, K1>,\n  nodeBoundsRef: Map<K1, Bounds>,\n  rootRef?: RefObject<HTMLDivElement>,\n  getTextDimensions?: GetTextDimensionsType\n) {\n  const labelDims: Map<K1 | K2, TextDimensions> = new Map();\n  const nodeValues = Array.from(nodeItems.values());\n  const linkValues = Array.from(linkItems.values());\n  if (getTextDimensions) {\n    getLabelProps(nodeValues, linkValues, labelDims, getTextDimensions);\n  }\n\n  const linkKeys = Array.from(linkItems.keys());\n  for (const id of linkKeys) {\n    const item = linkItems.get(id as K2);\n    if (item && getTextDimensions && item.label) {\n      const label = item.label;\n      const fontProps = _getFontProps(item.labelStyle);\n      labelDims.set(id as K1 | K2, getTextDimensions(label, fontProps));\n    }\n  }\n  const getLabelDimensions = function (data: D1 | D2) {\n    return labelDims.get(data.id);\n  };\n  const getNodeDimensions = function (data: D1) {\n    return dimensions.get(data.id);\n  };\n  const getRelativeNodeBounds = function (id: K1, containerId?: K1) {\n    const absPos = getAbsoluteItemPosition(id, containerId, rootRef);\n    const bounds = nodeBounds.get(id)!;\n    if (absPos && bounds) {\n      return {\n        x: absPos.x / zoom,\n        y: absPos.y / zoom,\n        width: bounds.width,\n        height: bounds.height\n      };\n    } else {\n      return undefined;\n    }\n  };\n\n  const getContainerId = function (startNode: K1, endNode: K1) {\n    return getCommonAncestorId(startNode, endNode, nodeIdToParentMap);\n  };\n\n  const getNodeBounds = function (data: D1) {\n    const id = data.id;\n    const linkBounds = nodeBoundsRef.get(id);\n    const bounds = nodeBounds.get(id)!;\n    if (linkBounds) {\n      if (rootRef && rootRef.current) {\n        const childElement = rootRef.current.querySelector(`[data-oj-child=${id}]`);\n        const nodeContainer = rootRef.current.querySelector(`[data-oj-private-node=${id}]`);\n        const dims = nodeBounds.get(id);\n        if (childElement && nodeContainer && dims) {\n          const childBoundingRect = normalizeBounds(childElement.getBoundingClientRect(), zoom);\n          const nodeBoundingRect = normalizeBounds(nodeContainer.getBoundingClientRect(), zoom);\n          const extraWidth = Math.max(\n            childBoundingRect.x -\n              nodeBoundingRect.x +\n              (linkBounds.width + linkBounds.x) -\n              nodeBoundingRect.width,\n            0\n          );\n          const extraHeight = Math.max(\n            childBoundingRect.y -\n              nodeBoundingRect.y +\n              (linkBounds.height + linkBounds.y) -\n              nodeBoundingRect.height,\n            0\n          );\n          return {\n            x: childBoundingRect.x - nodeBoundingRect.x + linkBounds.x,\n            y: childBoundingRect.y - nodeBoundingRect.y + linkBounds.y,\n            width: nodeBoundingRect.width + extraWidth,\n            height: nodeBoundingRect.height + extraHeight\n          };\n        }\n      }\n    } else if (bounds) {\n      return {\n        x: 0,\n        y: 0,\n        width: bounds.width,\n        height: bounds.height\n      };\n    }\n    return undefined;\n  };\n\n  const getPromotedLinks = function () {\n    return promotedLinks;\n  };\n\n  return {\n    layoutJSON: {\n      getNodeDimensions: getNodeDimensions,\n      getLabelDimensions: getLabelDimensions,\n      getContainerId,\n      getNodeBounds,\n      getRelativeNodeBounds,\n      getPromotedLinks,\n      componentSize: {\n        width: width,\n        height: height\n      }\n    },\n    labelDims: labelDims\n  };\n}\n\nfunction normalizeBounds(bounds: Bounds, zoom: number) {\n  return {\n    x: bounds.x / zoom,\n    y: bounds.y / zoom,\n    width: bounds.width / zoom,\n    height: bounds.height / zoom\n  };\n}\n\nexport function getAbsoluteLinkBounds<K1, K2>(\n  itemId: K1 | K2,\n  referenceId: K1 | undefined,\n  bounds: Map<K1 | K2, Bounds | Dimensions>,\n  zoom: number,\n  rootRef?: RefObject<HTMLDivElement>\n) {\n  if (rootRef && rootRef.current) {\n    const linkElement = rootRef.current.querySelector(`[data-oj-private-link=${itemId}]`);\n    let nodeContainer;\n    if (referenceId) {\n      nodeContainer = rootRef.current.querySelector(`[data-oj-private-node=${referenceId}]`);\n    }\n    const dims = bounds.get(itemId);\n    if (linkElement && nodeContainer && dims) {\n      const linkBoundingRect = normalizeBounds(linkElement.getBoundingClientRect(), zoom);\n      const diagramBoundingRect = normalizeBounds(nodeContainer.getBoundingClientRect(), zoom);\n      return {\n        x: linkBoundingRect.x - diagramBoundingRect.x,\n        y: linkBoundingRect.y - diagramBoundingRect.y,\n        width: dims.width,\n        height: dims.height\n      };\n    }\n  }\n  return null;\n}\n\nexport function getBounds<\n  K1,\n  K2,\n  D1 extends DiagramNodeData<K1, D1>,\n  D2 extends DiagramLinkData<K2, K1>\n>(\n  nodes: D1[],\n  links: D2[],\n  promotedLinks: DiagramLinkData<string, K1>[],\n  nodeBounds: Map<K1, Bounds>,\n  linkDimensions: Map<K2, Dimensions>,\n  promotedLinkDimensions: Map<string, Dimensions>,\n  zoom: number,\n  rootRef?: RefObject<HTMLDivElement>\n) {\n  let minX = Infinity;\n  let minY = Infinity;\n  let maxX = -Infinity;\n  let maxY = -Infinity;\n  let id;\n  let topId;\n  let leftId;\n  for (let i = 0; i < nodes.length; i++) {\n    id = nodes[i].id;\n    const bounds = nodeBounds.get(id);\n    if (bounds) {\n      if (minX > bounds.x) {\n        minX = bounds.x;\n        leftId = id;\n      }\n      if (minY > bounds.y) {\n        minY = bounds.y;\n        topId = id;\n      }\n      if (maxX < bounds.x + bounds.width) {\n        maxX = bounds.x + bounds.width;\n      }\n      if (maxY < bounds.y + bounds.height) {\n        maxY = bounds.y + bounds.height;\n      }\n    }\n  }\n  const nodeMinX = minX;\n  const nodeMinY = minY;\n  let linkMinX = Infinity;\n  let linkMinY = Infinity;\n  let linkMaxX = -Infinity;\n  let linkMaxY = -Infinity;\n\n  for (let i = 0; i < links.length; i++) {\n    id = links[i].id;\n    //Top and left bounds are relative to the current most top and left nodes\n    const topBounds = getAbsoluteLinkBounds(id, topId, linkDimensions, zoom, rootRef);\n    const leftBounds = getAbsoluteLinkBounds(id, leftId, linkDimensions, zoom, rootRef);\n    if (leftBounds) {\n      if (leftBounds.x < linkMinX) {\n        linkMinX = leftBounds.x;\n      }\n      if (linkMaxX < leftBounds.x + leftBounds.width) {\n        linkMaxX = leftBounds.x + leftBounds.width;\n      }\n    }\n    if (topBounds) {\n      if (topBounds.y < linkMinY) {\n        linkMinY = topBounds.y;\n      }\n      if (linkMaxY < topBounds.y + topBounds.height) {\n        linkMaxY = topBounds.y + topBounds.height;\n      }\n    }\n  }\n\n  for (let i = 0; i < promotedLinks.length; i++) {\n    id = promotedLinks[i].id;\n    //Top and left bounds are relative to the current most top and left nodes\n    const topBounds = getAbsoluteLinkBounds(id, topId, promotedLinkDimensions, zoom, rootRef);\n    const leftBounds = getAbsoluteLinkBounds(id, leftId, promotedLinkDimensions, zoom, rootRef);\n    if (leftBounds) {\n      if (leftBounds.x < linkMinX) {\n        linkMinX = leftBounds.x;\n      }\n      if (linkMaxX < leftBounds.x + leftBounds.width) {\n        linkMaxX = leftBounds.x + leftBounds.width;\n      }\n    }\n    if (topBounds) {\n      if (topBounds.y < linkMinY) {\n        linkMinY = topBounds.y;\n      }\n      if (linkMaxY < topBounds.y + topBounds.height) {\n        linkMaxY = topBounds.y + topBounds.height;\n      }\n    }\n  }\n  return {\n    minX: nodeMinX,\n    minY: nodeMinY,\n    contentWidth: maxX - minX,\n    contentHeight: maxY - minY,\n    linkBounds:\n      linkMinX !== Infinity\n        ? { x: linkMinX, y: linkMinY, width: linkMaxX - linkMinX, height: linkMaxY - linkMinY }\n        : undefined\n  };\n}\n\nfunction getAbsoluteItemPosition<K1>(\n  nodeId: K1,\n  containerId?: K1,\n  rootRef?: RefObject<HTMLDivElement>\n) {\n  if (rootRef && rootRef.current) {\n    const nodeElement = rootRef.current.querySelector(`[data-oj-private-node=${nodeId}]`);\n    let nodeContainer;\n    if (containerId) {\n      nodeContainer = rootRef.current.querySelector(`[data-oj-child=${containerId}]`);\n    } else {\n      nodeContainer = rootRef.current.querySelector('[data-node-container]');\n    }\n    if (nodeElement && nodeContainer) {\n      const nodeBoundingRect = nodeElement.getBoundingClientRect();\n      const diagramBoundingRect = nodeContainer.getBoundingClientRect();\n      return {\n        x: nodeBoundingRect.x - diagramBoundingRect.x,\n        y: nodeBoundingRect.y - diagramBoundingRect.y\n      };\n    }\n  }\n  return null;\n}\n\nfunction getLabelProps<\n  K1,\n  K2,\n  D1 extends DiagramNodeData<K1, D1>,\n  D2 extends DiagramNodeData<K2, K1>\n>(\n  nodeItems: D1[],\n  linkItems: D2[],\n  labelDims: Map<K1 | K2, TextDimensions>,\n  getTextDimensions: GetTextDimensionsType\n) {\n  nodeItems.forEach((value) => {\n    if (value.children) {\n      getNodeLabelProps<K1, K2, D1>(value.children, labelDims, getTextDimensions);\n    }\n    if (value.label) {\n      const label = value.label;\n      const fontProps = _getFontProps(value.labelStyle);\n      labelDims.set(value.id as K1, getTextDimensions(label, fontProps));\n    }\n  });\n  linkItems.forEach((value) => {\n    if (value.label) {\n      const label = value.label;\n      const fontProps = _getFontProps(value.labelStyle);\n      labelDims.set(value.id as K2, getTextDimensions(label, fontProps));\n    }\n  });\n}\n\nfunction getNodeLabelProps<K1, K2, D1 extends DiagramNodeData<K1, D1>>(\n  nodeItems: D1[],\n  labelDims: Map<K1 | K2, TextDimensions>,\n  getTextDimensions: GetTextDimensionsType\n) {\n  nodeItems.forEach((value) => {\n    if (value.children) {\n      getNodeLabelProps<K1, K2, D1>(value.children, labelDims, getTextDimensions);\n    }\n    if (value.label) {\n      const label = value.label;\n      const fontProps = _getFontProps(value.labelStyle);\n      labelDims.set(value.id as K1, getTextDimensions(label, fontProps));\n    }\n  });\n}\n\n/**\n * Deconstructs the output of the layout function\n */\nexport function deconstructLayoutJSON<\n  K1 extends string | number,\n  K2 extends string | number,\n  D1 extends DiagramNodeData<K1, D1>,\n  D2 extends DiagramLinkData<K2, K1>\n>(layoutJSON: DiagramLayoutOutput<K1, K2>, nodeData: D1[], linkData: D2[]) {\n  //const nodes = layoutJSON.nodes;\n  const links = layoutJSON.links;\n  //const promotedLinks = layoutJSON.promotedLinks;\n  const positions: Map<K1, Position> = new Map();\n  const nodeLabelPos: Map<K1, DiagramLabelPosition> = new Map();\n  const linkLabelPos: Map<K2, DiagramLabelPosition> = new Map();\n  //let hasNodeLabels = false;\n  // hasLinkLabels = false;\n  let link;\n  findPoints(layoutJSON, nodeData, positions, nodeLabelPos);\n  if (links) {\n    for (let i = 0; i < linkData.length; i++) {\n      link = links[linkData[i].id];\n      if (link && link.label) linkLabelPos.set(linkData[i].id, link.label);\n    }\n  }\n  return {\n    nodePoints: positions,\n    nodeLabelPos: nodeLabelPos,\n    linkLabelPos: linkLabelPos\n  };\n}\n\nfunction findPoints<\n  K1 extends string | number,\n  K2 extends string | number,\n  D1 extends DiagramNodeData<K1, D1>\n>(\n  output: DiagramLayoutOutput<K1, K2>,\n  nodeData: D1[],\n  positions: Map<K1, Position>,\n  nodeLabelPos: Map<K1, DiagramLabelPosition>\n) {\n  const nodes = output.nodes;\n  let node;\n  if (nodes) {\n    for (let i = 0; i < nodeData.length; i++) {\n      const data = nodeData[i];\n      const id = data.id;\n      if (data.children) {\n        findPoints(output, data.children, positions, nodeLabelPos);\n      }\n      node = nodes[id];\n      if (node) {\n        positions.set(id, node.position);\n        if (node.label) {\n          nodeLabelPos.set(id, node.label);\n        }\n      }\n    }\n  }\n}\n\n/**\n * Merges the node points into the dimensions\n */\nexport function mergeDimensions<K1>(\n  dimensions: Map<K1, Dimensions>,\n  nodePoints: Map<K1, Position>\n) {\n  const newBounds: Map<K1, Bounds> = new Map();\n  dimensions.forEach((value, key) => {\n    const point = nodePoints.get(key)!;\n    if (point) {\n      newBounds.set(key, { x: point.x, y: point.y, width: value.width, height: value.height });\n    }\n  });\n  return newBounds;\n}\n\n/**\n * Deep equality check for whether two arrays of bounds are the same\n */\nexport function isEqualBounds<K1>(bounds1: Map<K1, Bounds>, bounds2: Map<K1, Bounds>) {\n  if (bounds1.size !== bounds2.size) return false;\n  let equal = true;\n  bounds1.forEach((value, key) => {\n    const b2Value = bounds2.get(key);\n    if (!b2Value) equal = false;\n    else if (\n      Math.abs(value.x - b2Value.x) > 0.5 ||\n      Math.abs(value.y - b2Value.y) > 0.5 ||\n      Math.abs(value.width - b2Value.width) > 0.5 ||\n      Math.abs(value.height - b2Value.height) > 0.5\n    )\n      equal = false;\n  });\n  return equal;\n}\n\n/**\n * Deep equality check for whether two arrays of bounds are the same\n */\nexport function isEqualLabelBounds(bounds1: Bounds, bounds2: Bounds) {\n  return (\n    bounds1.x === bounds2.x &&\n    bounds1.y === bounds2.y &&\n    bounds1.width === bounds2.width &&\n    bounds1.height === bounds2.height\n  );\n}\n\n/**\n * Returns the text for the diagram datatip.\n */\nexport function getDatatipContent<\n  K1,\n  K2,\n  D1 extends DiagramNodeData<K1, D1>,\n  D2 extends DiagramLinkData<K2, K1>\n>(\n  nodesMap: Map<K1, D1>,\n  linksMap: Map<K2, D2>,\n  focusedItem?: ItemInfo<K1, K2>,\n  hoveredItem?: ItemInfo<K1, K2>,\n  datatip?: (detail: DatatipContext<D1, D2>) => {\n    content: ComponentChildren;\n    borderColor?: Property.BorderColor;\n  }\n) {\n  let itemInfo;\n  const isPointerActive = hoveredItem?.isCurrent;\n  if (isPointerActive && hoveredItem.id != null) {\n    itemInfo = hoveredItem;\n  }\n  if (focusedItem && focusedItem.isCurrent) {\n    itemInfo = focusedItem;\n  }\n  if (itemInfo && datatip) {\n    return datatip(\n      itemInfo.type === 'node'\n        ? { data: nodesMap.get(itemInfo.id as K1) as D1, type: 'node' }\n        : { data: linksMap.get(itemInfo.id as K2) as D2, type: 'link' }\n    );\n  }\n  if (itemInfo) {\n    const text = (\n      itemInfo.type === 'node' ? nodesMap.get(itemInfo.id as K1) : linksMap.get(itemInfo.id as K2)\n    )?.accessibleLabel;\n    return {\n      content: text\n    };\n  }\n  return;\n}\n\n/**\n * Creates a map with key id and value node or link data\n */\nexport function createLinksMap<K1, K2, D2 extends DiagramLinkData<K2, K1>>(\n  items: (D2 | DiagramLinkData<string, K1>)[]\n) {\n  const itemIdToDataMap = new Map();\n  const itemIdToIndexMap = new Map();\n  const itemIndexToIdMap = new Map();\n  const itemIdToParentMap = new Map();\n  for (let i = 0; i < items.length; i++) {\n    const item = items[i];\n    itemIdToDataMap.set(item.id, item);\n    itemIdToIndexMap.set(item.id, i);\n    itemIndexToIdMap.set(i, item.id);\n  }\n  return {\n    itemIdToDataMap,\n    itemIdToIndexMap,\n    itemIndexToIdMap,\n    itemIdToParentMap\n  };\n}\n\n/**\n * Creates a map with key id and value node or link data\n */\nexport function createPromotedLinksMap<K1>(items: DiagramLinkData<string, K1>[]) {\n  const itemIdToDataMap = new Map();\n  const itemIdToIndexMap = new Map();\n  const itemIndexToIdMap = new Map();\n  const itemIdToParentMap = new Map();\n  for (let i = 0; i < items.length; i++) {\n    const item = items[i];\n    itemIdToDataMap.set(item.id, item);\n    itemIdToIndexMap.set(item.id, i);\n    itemIndexToIdMap.set(i, item.id);\n  }\n  return {\n    itemIdToDataMap,\n    itemIdToIndexMap,\n    itemIndexToIdMap,\n    itemIdToParentMap\n  };\n}\n\n/**\n * Creates a map with key id and value node or link data\n */\nexport function createNodesMap<K1, D1 extends DiagramNodeData<K1, D1>>(items: D1[]) {\n  const itemIdToDataMap = new Map();\n  const itemIdToIndexMap = new Map();\n  const itemIndexToIdMap = new Map();\n  const itemIdToParentMap = new Map();\n  for (let i = 0; i < items.length; i++) {\n    const item = items[i];\n    const index = String(i);\n    itemIdToDataMap.set(item.id, item);\n    itemIdToIndexMap.set(item.id, index);\n    itemIndexToIdMap.set(index, item.id);\n    if ((item as D1).children) {\n      _createItemMap<K1, D1>(\n        (item as D1).children!,\n        itemIdToDataMap,\n        itemIdToIndexMap,\n        itemIndexToIdMap,\n        itemIdToParentMap,\n        item.id as K1,\n        String(i)\n      );\n    }\n  }\n  return {\n    itemIdToDataMap,\n    itemIdToIndexMap,\n    itemIndexToIdMap,\n    itemIdToParentMap\n  };\n}\n\nfunction _createItemMap<K1, D1 extends DiagramNodeData<K1, D1>>(\n  items: D1[],\n  itemIdToDataMap: Map<K1, D1>,\n  itemIdToIndexMap: Map<K1, string>,\n  itemIndexToIdMap: Map<string, K1>,\n  itemIdToParentMap: Map<K1, K1>,\n  parentId: K1,\n  parentIndex: string\n) {\n  for (let i = 0; i < items.length; i++) {\n    const item = items[i];\n    const index = `${parentIndex}_${i}`;\n    itemIdToDataMap.set(item.id, item);\n    itemIdToIndexMap.set(item.id, index);\n    itemIndexToIdMap.set(index, item.id);\n    itemIdToParentMap.set(item.id, parentId);\n    if (item.children) {\n      _createItemMap(\n        item.children,\n        itemIdToDataMap,\n        itemIdToIndexMap,\n        itemIndexToIdMap,\n        itemIdToParentMap,\n        item.id,\n        index\n      );\n    }\n  }\n}\n\n/**\n * Filter out links with no start or end nodes\n */\nexport function filterLinksWithNoEndNodes<K2, K1, D1, D2 extends DiagramLinkData<K2, K1>>(\n  links: D2[],\n  nodesMap: Map<K1, D1>\n) {\n  const newLinks: D2[] = [];\n  for (let i = 0; i < links.length; i++) {\n    const link = links[i];\n    if (nodesMap.get(link.startNode) && nodesMap.get(link.endNode)) {\n      newLinks.push(link);\n    }\n  }\n  return newLinks;\n}\n\n/**\n * Pulls out the dimensions from an array of bounds\n */\nexport function getDimensionsFromBounds<K1>(bounds: Map<K1, Bounds>) {\n  const dims: Map<K1, Dimensions> = new Map();\n  bounds.forEach((value, key) => {\n    dims.set(key, { width: value.width, height: value.height });\n  });\n  return dims;\n}\n\n/**\n * Returns true if event is a selection event\n */\nexport function isSelectionEvent(event: KeyboardEvent): boolean {\n  if (event.altKey && (event.key === '≥' || event.key === '≤')) {\n    return true;\n  }\n  return false;\n}\n\n/**\n * Returns the center position of the node or link\n * For links, draws a straight line between the centers of the start/end node\n * and returns the center of that line\n */\nexport function getFocusedItemBounds<K1, K2, D2 extends DiagramLinkData<K2, K1>>(\n  focusedItemInfo: ItemInfo<K1, K2>,\n  bounds: Map<K1, Bounds>,\n  links: D2[],\n  linkIdToIndexMap: Map<K2, number>,\n  rootRef?: RefObject<HTMLDivElement>\n) {\n  if (focusedItemInfo.type === 'node') {\n    // Return the first element if cannot find the Node index\n    const position = getAbsoluteItemPosition(focusedItemInfo.id as K1, undefined, rootRef);\n    const nodeBounds = bounds.get(focusedItemInfo.id as K1) || bounds.values().next().value!;\n    return {\n      x: position ? position.x : nodeBounds.x,\n      y: position ? position.y : nodeBounds.y,\n      width: nodeBounds.width,\n      height: nodeBounds.height\n    };\n  } else {\n    // Center of a straight line between start/end node centers\n    const link = links[linkIdToIndexMap.get(focusedItemInfo.id as K2) || 0];\n    const startNB = bounds.get(link.startNode) || bounds.values().next().value!;\n    const endNB = bounds.get(link.endNode) || bounds.values().next().value!;\n    const startPosition = getAbsoluteItemPosition(link.startNode, undefined, rootRef)!;\n    const endPosition = getAbsoluteItemPosition(link.endNode, undefined, rootRef)!;\n    const startNCenter = {\n      x: startPosition.x + startNB.width / 2,\n      y: startPosition.y + startNB.height / 2\n    };\n    const endNCenter = { x: endPosition.x + endNB.width / 2, y: endPosition.y + endNB.height / 2 };\n\n    const minX = Math.min(startNCenter.x, endNCenter.x);\n    const minY = Math.min(startNCenter.y, endNCenter.y);\n    return {\n      x: minX,\n      y: minY,\n      width: Math.abs(startNCenter.x - endNCenter.x),\n      height: Math.abs(startNCenter.y - endNCenter.y)\n    };\n  }\n}\n/**\n * Combines the node and link ids into one array\n */\nexport function combineIds<K1, K2>(nodeIds?: K1[], linkIds?: K2[]) {\n  const combinedIds: (K1 | K2)[] = [];\n  if (nodeIds) {\n    for (let i = 0; i < nodeIds.length; i++) {\n      combinedIds.push(nodeIds[i]);\n    }\n  }\n  if (linkIds) {\n    for (let i = 0; i < linkIds.length; i++) {\n      combinedIds.push(linkIds[i]);\n    }\n  }\n  return combinedIds;\n}\n\n/**\n * Returns the bounds of the diagram content\n */\nexport function getContentBounds<K1>(nodeBounds: Map<K1, Bounds>, labelBounds?: Bounds): Bounds {\n  if (nodeBounds.size === 0) return { x: 0, width: Infinity, y: 0, height: Infinity };\n  let minX = Infinity;\n  let minY = Infinity;\n  let maxX = -Infinity;\n  let maxY = -Infinity;\n  let dims;\n  nodeBounds.forEach((value) => {\n    dims = value;\n    minX = dims.x < minX ? dims.x : minX;\n    minY = dims.y < minY ? dims.y : minY;\n    maxX = dims.x + dims.width > maxX ? dims.x + dims.width : maxX;\n    maxY = dims.y + dims.height > maxY ? dims.y + dims.height : maxY;\n  });\n  if (labelBounds) {\n    minX = labelBounds.x < minX ? labelBounds.x : minX;\n    minY = labelBounds.y < minY ? labelBounds.y : minY;\n    maxX = labelBounds.x + labelBounds.width > maxX ? labelBounds.x + labelBounds.width : maxX;\n    maxY = labelBounds.y + labelBounds.height > maxY ? labelBounds.y + labelBounds.height : maxY;\n  }\n  return { x: minX, width: maxX - minX, y: minY, height: maxY - minY };\n}\n\n/**\n * Returns the label bounds\n */\nexport function getAllLabelBounds<K1, K2, D1 extends DiagramNodeData<K1, D1>>(\n  labelDims: Map<K1 | K2, TextDimensions>,\n  nodeLabelPos: Map<K1, DiagramLabelPosition> = new Map(),\n  //linkLabelPos: Map<K2, DiagramLabelPosition> = new Map(),\n  isRTL: boolean\n) {\n  if (nodeLabelPos.size === 0) return undefined;\n  let minX = Infinity;\n  let minY = Infinity;\n  let maxX = -Infinity;\n  let maxY = -Infinity;\n  let dims;\n\n  nodeLabelPos.forEach((value, key) => {\n    dims = getLabelBounds(value, labelDims.get(key)!, isRTL);\n    minX = dims.x < minX ? dims.x : minX;\n    minY = dims.y < minY ? dims.y : minY;\n    maxX = dims.x + dims.width > maxX ? dims.x + dims.width : maxX;\n    maxY = dims.y + dims.height > maxY ? dims.y + dims.height : maxY;\n  });\n  /*linkLabelPos.forEach((value, key)=> {\n    dims = getLabelBounds(value, labelDims.get(key)!, isRTL);\n    minX = dims.x < minX ? dims.x : minX;\n    minY = dims.y < minY ? dims.y : minY;\n    maxX = dims.x + dims.width > maxX ? dims.x + dims.width : maxX;\n    maxY = dims.y + dims.height > maxY ? dims.y + dims.height : maxY;\n  })*/\n\n  return { x: minX, width: maxX - minX, y: minY, height: maxY - minY };\n}\n\nfunction getLabelBounds(label: DiagramLabelPosition, dims: TextDimensions, isRTL: boolean) {\n  const labelPos = getLabelPosition(dims, label, isRTL);\n  const isRotating = label.rotationAngle;\n  if (!isRotating) {\n    return { x: labelPos.x, y: labelPos.y, width: dims.width, height: dims.height };\n  } else {\n    // Find the 4 corners of the label bounds relative to the rotation point\n    const rotationPoint = label.rotationPoint\n      ? label.rotationPoint\n      : { x: dims.width / 2, y: dims.height / 2 };\n    const angle = label.rotationAngle!;\n    const topLeft = getCoordsRelToRotPoint({ x: 0, y: 0 }, rotationPoint);\n    const topRight = getCoordsRelToRotPoint({ x: dims.width, y: 0 }, rotationPoint);\n    const bottomLeft = getCoordsRelToRotPoint({ x: 0, y: dims.height }, rotationPoint);\n    const bottomRight = getCoordsRelToRotPoint({ x: dims.width, y: dims.height }, rotationPoint);\n    const rotTopLeft = rotatePoint(topLeft, angle);\n    const rotBotLeft = rotatePoint(bottomLeft, angle);\n    const rotTopRight = rotatePoint(topRight, angle);\n    const rotBotRight = rotatePoint(bottomRight, angle);\n    const points = [rotTopLeft, rotBotLeft, rotTopRight, rotBotRight].map((pos: Position) => {\n      return {\n        x: pos.x + labelPos.x + rotationPoint.x,\n        y: pos.y + labelPos.y + rotationPoint.y\n      };\n    });\n    return getBoundsFromPoints(points);\n  }\n}\n\nfunction getCoordsRelToRotPoint(labelPoint: Position, rotPoint: Position) {\n  return { x: labelPoint.x - rotPoint.x, y: labelPoint.y - rotPoint.y };\n}\n\nfunction rotatePoint(pos: Position, angle: number) {\n  return {\n    x: pos.x * Math.cos(angle) - pos.y * Math.sin(angle),\n    y: pos.x * Math.sin(angle) + pos.y * Math.cos(angle)\n  };\n}\n\nfunction getBoundsFromPoints(points: Position[]) {\n  let minX = points[0].x;\n  let minY = points[0].y;\n  let maxX = points[0].x;\n  let maxY = points[0].y;\n  for (let i = 1; i < points.length; i++) {\n    const point = points[i];\n    if (point.x < minX) minX = point.x;\n    else if (point.x > maxX) maxX = point.x;\n    if (point.y < minY) minY = point.y;\n    else if (point.y > maxY) maxY = point.y;\n  }\n  return {\n    x: minX,\n    y: minY,\n    width: maxX - minX,\n    height: maxY - minY\n  };\n}\n\n/**\n * Returns the position of the label\n * @param dimensions\n * @param positionProps\n * @returns position of the label\n */\nexport function getLabelPosition(\n  dimensions: TextDimensions,\n  positionProps: DiagramLabelPosition,\n  isRTL: boolean\n) {\n  const position = positionProps.position;\n  const hAlign = positionProps.hAlign ? positionProps.hAlign : isRTL ? 'right' : 'left';\n  const vAlign = positionProps.vAlign;\n  let x, y;\n  if (hAlign === 'center') {\n    x = position.x - dimensions.width / 2;\n  } else if (hAlign === 'right') {\n    x = position.x - dimensions.width;\n  } else {\n    x = position.x;\n  }\n\n  if (vAlign === 'middle') {\n    y = position.y - dimensions.height / 2;\n  } else if (vAlign === 'bottom') {\n    y = position.y - dimensions.height;\n  } else if (vAlign === 'baseline') {\n    y = position.y + dimensions.y;\n  } else {\n    y = position.y;\n  }\n  return {\n    x: x,\n    y: y\n  };\n}\n\n/**\n * Converts centerX,Y coordinates to panX,Y coordinates\n */\nexport function centerXYToPanXY(\n  centerX: number,\n  centerY: number,\n  zoom: number,\n  width: number,\n  height: number\n) {\n  return {\n    panX: width / 2 - centerX * zoom,\n    panY: height / 2 - centerY * zoom\n  };\n}\n/**\n * Converts panX,Y coordinates to centerX,Y coordinates\n */\nexport function panXYToCenterXY(\n  panX: number,\n  panY: number,\n  zoom: number,\n  width: number,\n  height: number\n) {\n  return {\n    centerX: (width / 2 - panX) / zoom,\n    centerY: (height / 2 - panY) / zoom\n  };\n}\n\n/**\n * Compares if two ItemInfo are equal\n */\nexport function isEqualItem<K1, K2>(item1?: ItemInfo<K1, K2>, item2?: ItemInfo<K1, K2>) {\n  return item1?.id === item2?.id && item1?.type === item2?.type;\n}\n\n/**\n * Returns the item info of the data-oj-node or data-oj-link attribute for a given element.\n */\nexport function getNavigableInfo<K1, K2>(\n  element: HTMLElement,\n  rootElementRef?: RefObject<HTMLDivElement>\n): ItemInfo<K1, K2> {\n  let type;\n  let elem = element;\n  let navigableId;\n  while (!navigableId) {\n    navigableId = elem.dataset['ojPrivateNode'];\n    if (navigableId) {\n      type = 'node';\n    } else {\n      navigableId = elem.dataset['ojPrivateLink'];\n      type = 'link';\n    }\n    if (!navigableId) {\n      if (elem.parentElement && elem.parentElement !== rootElementRef?.current) {\n        elem = elem.parentElement;\n      } else {\n        break;\n      }\n    }\n  }\n  return {\n    id: navigableId as K1 | K2,\n    type: type\n  } as ItemInfo<K1, K2>;\n}\n\n/**\n * Returns the item info of the data-oj-node or data-oj-link attribute for a given element.\n */\nexport function expCollapseButtonId<K1>(\n  element: HTMLElement,\n  rootElementRef?: RefObject<HTMLDivElement>\n): K1 | undefined {\n  let elem = element;\n  let id;\n  while (!id) {\n    id = elem.dataset['ojButton'] as K1;\n    if (!id) {\n      if (\n        elem.parentElement &&\n        !elem.parentElement.dataset['ojPrivateNode'] &&\n        elem.parentElement !== rootElementRef?.current\n      ) {\n        elem = elem.parentElement;\n      } else {\n        break;\n      }\n    }\n  }\n  return id;\n}\n\n/**\n * Returns the id of the focused item.\n */\nexport function getFocusedItem<K1, K2>(\n  focusedItemInfo: ItemInfo<K1, K2>,\n  hoveredItemInfo?: ItemInfo<K1, K2>\n) {\n  let focused;\n  if (focusedItemInfo.isCurrent && focusedItemInfo.isFocusVisible) {\n    focused = focusedItemInfo.id;\n  } else if (hoveredItemInfo?.isCurrent) {\n    focused = hoveredItemInfo.id;\n  }\n  return focused;\n}\n\n/**\n * Returns the aria label\n */\nexport function getItemAriaLabel(\n  translations: BundleType,\n  supportsSelection: boolean,\n  isSelected?: boolean,\n  accessibleLabel?: string\n) {\n  return generateAriaLabel(translations, accessibleLabel || '', {\n    isSelected: !supportsSelection ? undefined : isSelected\n  });\n}\n\n/**\n * Returns the zoom to fit zoom level\n */\nexport function getZoomToFitZoom(width: number, height: number, contentBounds: Bounds) {\n  const zoomX = (width - 2 * ZOOM_TO_FIT_PADDING) / contentBounds.width;\n  const zoomY = (height - 2 * ZOOM_TO_FIT_PADDING) / contentBounds.height;\n  return Math.min(zoomX, zoomY);\n}\n\n/**\n * Constrains the zoom level\n */\nfunction constrainZoom(zoom: number, minZoom: number, maxZoom: number) {\n  let newZoom = Math.max(minZoom, zoom);\n  newZoom = Math.min(maxZoom, newZoom);\n  return newZoom;\n}\n\n/**\n * Returns the font props for a node or link\n */\nfunction _getFontProps(styles?: DiagramLabelStyles) {\n  const fontProps: Font = {};\n  if (!styles) return fontProps;\n  if (styles.fontFamily) fontProps.fontFamily = styles.fontFamily;\n  if (styles.fontSize) fontProps.fontSize = styles.fontSize;\n  if (styles.fontStyle) fontProps.fontStyle = styles.fontStyle;\n  if (styles.fontWeight) fontProps.fontWeight = styles.fontWeight;\n  return fontProps;\n}\n\n/**\n * Returns the panX, panY, and zoom when zooming and centering an item\n */\nexport function zoomAndCenterItemFromInfo<K1, K2, D2 extends DiagramLinkData<K2, K1>>(\n  info: ItemInfo<K1, K2>,\n  linkIdToDataMap: Map<K2, D2>,\n  bounds: Map<K1, Bounds>,\n  width: number,\n  height: number,\n  maxZoom: number\n) {\n  const type = info.type;\n  let totalBounds;\n  if (type === 'node') {\n    totalBounds = bounds.get(info.id as K1)!;\n  } else {\n    const link = linkIdToDataMap.get(info.id as K2)!;\n    const startNodeBounds = bounds.get(link.startNode)!;\n    const endNodeBounds = bounds.get(link.endNode)!;\n    const minX = Math.min(startNodeBounds.x, endNodeBounds.x);\n    const minY = Math.min(startNodeBounds.y, endNodeBounds.y);\n    const maxX = Math.max(\n      startNodeBounds.x + startNodeBounds.width,\n      endNodeBounds.x + startNodeBounds.width\n    );\n    const maxY = Math.max(\n      startNodeBounds.y + startNodeBounds.height,\n      endNodeBounds.y + endNodeBounds.height\n    );\n    totalBounds = { x: minX, y: minY, width: maxX - minX, height: maxY - minY };\n  }\n  return getPanZoomToCenterNode(totalBounds, maxZoom, width, height);\n}\n\n/**\n * Returns the pan and zoom values in order\n * to center a node or link\n */\nfunction getPanZoomToCenterNode(bounds: Bounds, maxZoom: number, width: number, height: number) {\n  const zoomX = (width - 2 * ZOOM_TO_FIT_PADDING) / bounds.width;\n  const zoomY = (height - 2 * ZOOM_TO_FIT_PADDING) / bounds.height;\n  const zoom = Math.min(zoomX, zoomY, maxZoom);\n  const cX = bounds.width / 2 + bounds.x;\n  const cY = bounds.height / 2 + bounds.y;\n  return { centerX: cX, centerY: cY, zoom: zoom };\n}\n\n/**\n * Returns whether the node is a leaf node\n */\n\nexport function isLeafNode<K1, D1 extends DiagramNodeData<K1, D1>>(nodeData: D1) {\n  return !nodeData.children;\n}\n\nexport function isContainerReady<\n  K1,\n  K2,\n  D1 extends DiagramNodeData<K1, D1>,\n  D2 extends DiagramLinkData<K2, K1>\n>(\n  nodeData: D1,\n  nodeBounds: Map<K1, Bounds>,\n  links: D2[],\n  promotedLinks: DiagramLinkData<string, K1>[],\n  linkDimensions: Map<K2, Dimensions>,\n  promotedLinkDimensions: Map<string, Dimensions>\n) {\n  const children = nodeData.children!;\n  for (let i = 0; i < children?.length; i++) {\n    const child = children[i].id;\n    if (!nodeBounds.get(child)) {\n      return false;\n    }\n  }\n  for (let i = 0; i < links.length; i++) {\n    const link = links[i].id;\n    const linkDims = linkDimensions.get(link);\n    if (!linkDims || linkDims.width === 0 || linkDims.height === 0) {\n      return false;\n    }\n  }\n  for (let i = 0; i < promotedLinks.length; i++) {\n    const link = promotedLinks[i].id;\n    const linkDims = promotedLinkDimensions.get(link);\n    if (!linkDims || linkDims.width === 0 || linkDims.height === 0) {\n      return false;\n    }\n  }\n  return true;\n}\n\nexport function getLinkData<K1, K2, D2 extends DiagramLinkData<K2, K1>>(\n  links: K2[],\n  linkData: D2[]\n) {\n  const data: D2[] = [];\n  linkData.forEach((value) => {\n    if (links.includes(value.id)) {\n      data.push(value);\n    }\n  });\n  return data;\n}\n\nfunction getCommonAncestorId<K1>(startId: K1, endId: K1, nodeIdToParentMap: Map<K1, K1>) {\n  const startAnc = _getAncestorIds(startId, nodeIdToParentMap);\n  const endAnc = _getAncestorIds(endId, nodeIdToParentMap);\n  for (let i = 0; i < startAnc.length; i++) {\n    if (endAnc.indexOf(startAnc[i]) > -1) {\n      return startAnc[i];\n    }\n  }\n  return undefined;\n}\n\nexport function getLinksForNode<K1, K2, D2 extends DiagramLinkData<K2, K1>>(\n  containerId: K1 | undefined,\n  links: D2[],\n  promotedLinks: DiagramLinkData<string, K1>[],\n  nodeIdToParentMap: Map<K1, K1>\n) {\n  const containerLinks = [];\n  for (let i = 0; i < links.length; i++) {\n    const link = links[i];\n    const ancId = getCommonAncestorId(link.startNode, link.endNode, nodeIdToParentMap);\n    if (ancId === containerId) {\n      containerLinks.push(link);\n    }\n  }\n  const containerPromotedLinks = [];\n  for (let i = 0; i < promotedLinks.length; i++) {\n    const link = promotedLinks[i];\n    const ancId = getCommonAncestorId(link.startNode, link.endNode, nodeIdToParentMap);\n    if (ancId === containerId) {\n      containerPromotedLinks.push(link);\n    }\n  }\n  return { containerLinks, containerPromotedLinks };\n}\n\nfunction _getAncestorIds<K1, D1 extends DiagramNodeData<K1, D1>>(nodeId: K1, nodes: Map<K1, K1>) {\n  const ancestors = [];\n  let anc = nodes.get(nodeId);\n  while (anc !== undefined) {\n    ancestors.push(anc);\n    anc = nodes.get(anc);\n  }\n  return ancestors;\n}\n\nexport function containerLinksReady<\n  K1 extends string | number,\n  K2 extends string | number,\n  D2 extends DiagramLinkData<K2, K1>,\n  L extends DiagramLayoutOutput<K1, K2>\n>(containerLinks: (D2 | DiagramLinkData<string, K1>)[], layoutOutput: L) {\n  const nodes = layoutOutput.nodes;\n  //if (!links) return false;\n  for (let i = 0; i < containerLinks.length; i++) {\n    const link = containerLinks[i];\n    if (!(nodes[link.startNode] && nodes[link.endNode])) {\n      return false;\n    }\n  }\n  return true;\n}\n\nexport function changeExpanded<K1>(id: K1, expanded: Array<K1>) {\n  const index = expanded.indexOf(id);\n  if (index === -1) {\n    expanded.push(id);\n  } else if (expanded.includes(id)) {\n    expanded.splice(index, 1);\n  }\n  return expanded;\n}\n\nexport function getPromotedLinks<K1, K2, D2 extends DiagramLinkData<K2, K1>>(\n  nodeIdToParentMap: Map<K1, K1>,\n  links: D2[],\n  expanded: K1[]\n) {\n  const promotedLinks = [];\n  const linkToPromotedMap = new Map<K2, string>();\n  const promotedToLinkMap = new Map<string, D2[]>();\n  for (let i = 0; i < links.length; i++) {\n    const link = links[i];\n    const linkId = link.id;\n    if (!hasCollapsedParent(link, nodeIdToParentMap, expanded)) {\n      continue;\n    }\n    const startVisible = firstVisibleAncestor(link.startNode, nodeIdToParentMap, expanded);\n    const endVisible = firstVisibleAncestor(link.endNode, nodeIdToParentMap, expanded);\n    const promotedLinkId = `${startVisible}_${endVisible}`;\n    let subLinks = promotedToLinkMap.get(promotedLinkId);\n    if (subLinks) {\n      subLinks.push(link);\n    } else {\n      const promotedLink = {\n        id: promotedLinkId,\n        startNode: startVisible,\n        endNode: endVisible\n      };\n      promotedLinks.push(promotedLink);\n      subLinks = [link];\n    }\n    promotedToLinkMap.set(promotedLinkId, subLinks);\n    linkToPromotedMap.set(linkId, promotedLinkId);\n  }\n  return {\n    promotedLinks,\n    linkToPromotedMap,\n    promotedToLinkMap\n  };\n}\n\nfunction hasCollapsedParent<K1, K2, D2 extends DiagramLinkData<K2, K1>>(\n  link: D2,\n  nodeIdToParentMap: Map<K1, K1>,\n  expanded: K1[]\n) {\n  if (\n    (nodeIdToParentMap.get(link.startNode) &&\n      expanded.includes(nodeIdToParentMap.get(link.startNode)!)) ||\n    (nodeIdToParentMap.get(link.endNode) && expanded.includes(nodeIdToParentMap.get(link.endNode)!))\n  ) {\n    return false;\n  }\n  return true;\n}\n\nfunction firstVisibleAncestor<K1>(nodeId: K1, nodeIdToParentMap: Map<K1, K1>, expanded: K1[]) {\n  let visibleAnc: K1 | undefined = nodeId;\n  let parentId = nodeIdToParentMap.get(nodeId);\n  let currentId = nodeId;\n  while (parentId) {\n    if (expanded.includes(parentId)) {\n      visibleAnc = currentId;\n    } else {\n      visibleAnc = undefined;\n      currentId = parentId;\n    }\n    parentId = nodeIdToParentMap.get(parentId);\n  }\n  return visibleAnc || currentId;\n}\n","import type { DiagramLabelPosition, DiagramLabelStyles } from './diagram.types';\nimport { getLabelPosition } from './utils/diagramUtils';\nimport { classNames } from '#utils/UNSAFE_classNames';\nimport { labelStyles } from './themes/DiagramStyles.css';\nimport type { TextDimensions } from '#hooks/PRIVATE_useTextDimensions';\nimport { Property } from 'csstype';\n\n/**\n * Props for the label component\n */\ntype LabelProps = {\n  styles?: LabelStyles;\n  text: string;\n  position: DiagramLabelPosition;\n  dimensions: TextDimensions;\n  isRTL: boolean;\n};\n\n/**\n * Label styles\n */\ntype LabelStyles = DiagramLabelStyles & {\n  borderStyle?: Property.BorderStyle;\n};\n\nexport const DiagramLabel = ({ text, position, styles, dimensions, isRTL }: LabelProps) => {\n  const { labelStyle, labelBorderStyle } = labelStyles;\n\n  const labelPosition = getLabelPosition(dimensions, position, isRTL);\n  const labelRotation = getLabelRotation(position);\n  return (\n    <div\n      class={classNames([labelStyle, styles && styles.borderColor && labelBorderStyle])}\n      style={{\n        top: labelPosition.y,\n        left: labelPosition.x,\n        ...styles,\n        ...labelRotation\n      }}>\n      {text}\n    </div>\n  );\n};\n\n/**\n * Returns the label rotation props\n * @param position\n * @returns rotation props\n */\nfunction getLabelRotation(position: DiagramLabelPosition) {\n  const rotationAngle = position.rotationAngle;\n  const rotationPoint = position.rotationPoint;\n  const rotation: {\n    transform?: string;\n    'transform-origin'?: string;\n  } = {};\n  if (rotationAngle) {\n    rotation['transform'] = `rotate(${rotationAngle}deg)`;\n  }\n  if (rotationPoint) {\n    rotation['transform-origin'] = `${rotationPoint.x}px ${rotationPoint.y}px`;\n  }\n  return rotation;\n}\n","import { Minus } from '#UNSAFE_RedwoodIcons/Minus';\nimport { Plus } from '#UNSAFE_RedwoodIcons/Plus';\nimport { buttonStyle } from './themes/DiagramStyles.css';\n\n/**\n * Props for the label component\n */\ntype ButtonProps<K1> = {\n  isRTL: boolean;\n  type: 'expand' | 'collapse';\n  id: K1;\n};\n\nexport const DiagramExpandCollapseButton = <K1,>({ type, id }: ButtonProps<K1>) => {\n  return (\n    <div\n      data-oj-button={id}\n      class={buttonStyle}\n      style={{\n        top: 0,\n        left: 0,\n        width: '5x',\n        height: '5x',\n        border: '1px solid black'\n      }}>\n      {type == 'collapse' ? <Plus size={'5x'} /> : <Minus size={'5x'} />}\n    </div>\n  );\n};\n","import type {\n  Position,\n  State,\n  NodeRendererContext,\n  DiagramLabelPosition,\n  DiagramNodeData\n} from './diagram.types';\nimport { useResizeObserver } from '#hooks/UNSAFE_useResizeObserver';\nimport { useCallback, useRef } from 'preact/hooks';\nimport { getItemAriaLabel } from './utils/diagramUtils';\nimport { classNames } from '#utils/UNSAFE_classNames';\nimport { itemStyles, layerStyles } from './themes/DiagramStyles.css';\nimport { ComponentChildren } from 'preact';\nimport { useTranslationBundle } from '#hooks/UNSAFE_useTranslationBundle';\nimport type { BundleType } from '#resources/nls/bundle';\nimport { useUser } from '#hooks/UNSAFE_useUser';\nimport { DiagramLabel } from './DiagramLabel';\nimport { TextDimensions } from '#hooks/PRIVATE_useTextDimensions';\nimport { DiagramExpandCollapseButton } from './DiagramExpandCollapseButton';\n\n/**\n * Props for node component\n */\ntype NodeProps<K1, K2, D1> = {\n  id: K1;\n  position?: Position;\n  label?: string;\n  state: State;\n  previousState: State;\n  isExpanded: boolean;\n  isDimmed?: boolean;\n  activeId?: string;\n  accessibleLabel?: string;\n  data: D1;\n  nodeRenderer: (context: NodeRendererContext<D1>) => ComponentChildren;\n  onNodeSizeChanged: (width: number, height: number, id: K1) => void;\n  supportsSelection: boolean;\n  content?: { element: JSX.Element; width: number; height: number };\n  labelPosition?: DiagramLabelPosition;\n  labelDimensions?: Map<K1 | K2, TextDimensions>;\n};\n\nexport const DiagramNodeElement = <K1, K2, D1 extends DiagramNodeData<K1, D1>>({\n  id,\n  state,\n  previousState,\n  position,\n  activeId,\n  nodeRenderer,\n  onNodeSizeChanged,\n  data,\n  accessibleLabel,\n  isDimmed,\n  supportsSelection,\n  content,\n  labelPosition,\n  labelDimensions\n}: NodeProps<K1, K2, D1>) => {\n  const { nodeStyles, dimmedItemStyle } = itemStyles;\n  const context = {\n    state: state,\n    previousState: previousState,\n    data: data,\n    content: content\n  };\n\n  const translations = useTranslationBundle<BundleType>('@oracle/oraclejet-preact');\n  const ref = useRef<HTMLDivElement>(null);\n  // TODO JET-62472 change to one resize observer function\n  const optionsRef = useRef({ box: 'border-box' as const });\n  useResizeObserver(\n    ref,\n    useCallback(\n      (entry: ResizeObserverEntry) => {\n        const boxSize = entry.borderBoxSize;\n        const width = boxSize[0].inlineSize;\n        const height = boxSize[0].blockSize;\n        onNodeSizeChanged(width, height, id);\n      },\n      [id, onNodeSizeChanged]\n    ),\n    optionsRef.current\n  );\n  const nodePos = position ? position : { x: 0, y: 0 };\n  const { direction } = useUser();\n  const hasLabel = data.label && labelPosition && labelDimensions;\n  return (\n    <div\n      ref={ref}\n      key={id}\n      class={classNames([nodeStyles, isDimmed ? dimmedItemStyle : undefined])}\n      data-oj-private-node={id}\n      role=\"img\"\n      aria-label={getItemAriaLabel(\n        translations,\n        supportsSelection,\n        state.selected,\n        accessibleLabel\n      )}\n      style={{\n        top: nodePos.y,\n        left: nodePos.x\n      }}\n      id={state.focused || state.hovered ? activeId : undefined}>\n      {nodeRenderer(context)}\n      {hasLabel ? (\n        <div class={layerStyles}>\n          <DiagramLabel\n            styles={data.labelStyle}\n            text={data.label!}\n            position={labelPosition!}\n            dimensions={labelDimensions.get(id)!}\n            isRTL={direction === 'rtl'}\n          />\n        </div>\n      ) : undefined}\n      {data.children && data.showDisclosure !== 'off' ? (\n        <DiagramExpandCollapseButton\n          type={content ? 'expand' : 'collapse'}\n          isRTL={direction === 'rtl'}\n          id={id}\n        />\n      ) : undefined}\n    </div>\n  );\n};\n","import type {\n  State,\n  LinkRendererContext,\n  DiagramLinkData,\n  DiagramLabelPosition\n} from './diagram.types';\nimport { getItemAriaLabel } from './utils/diagramUtils';\nimport { classNames } from '#utils/UNSAFE_classNames';\nimport { itemStyles } from './themes/DiagramStyles.css';\nimport { ComponentChildren } from 'preact';\nimport { useTranslationBundle } from '#hooks/UNSAFE_useTranslationBundle';\nimport type { BundleType } from '#resources/nls/bundle';\nimport { useCallback, useRef } from 'preact/hooks';\nimport { useResizeObserver } from '#hooks/UNSAFE_useResizeObserver';\nimport { TextDimensions } from '#hooks/PRIVATE_useTextDimensions';\n\n/**\n * Props for Link\n */\nexport type LinkProps<K1, K2, D2, L> = {\n  id: K2;\n  label?: string;\n  state: State;\n  previousState: State;\n  isDimmed?: boolean;\n  activeId?: string;\n  accessibleLabel?: string;\n  data: D2 | DiagramLinkData<string, K1>;\n  linkRenderer: (context: LinkRendererContext<K1, D2, L>) => ComponentChildren;\n  supportsSelection: boolean;\n  layoutOutput: L;\n  onLinkSizeChanged: (width: number, height: number, id: K2) => void;\n  labelPosition?: DiagramLabelPosition;\n  labelDimensions?: Map<K1 | K2, TextDimensions>;\n  isPromoted?: boolean;\n  promotedToLinkMap: Map<string, D2[]>;\n};\n\nexport const DiagramLinkElement = <K1, K2, D2 extends DiagramLinkData<K2, K1>, L>({\n  id,\n  state,\n  previousState,\n  activeId,\n  data,\n  linkRenderer,\n  accessibleLabel,\n  isDimmed,\n  supportsSelection,\n  layoutOutput,\n  onLinkSizeChanged,\n  isPromoted,\n  promotedToLinkMap\n} //labelPosition,\n//labelDimensions\n: LinkProps<K1, K2, D2, L>) => {\n  const translations = useTranslationBundle<BundleType>('@oracle/oraclejet-preact');\n  const { dimmedItemStyle, linkStyles } = itemStyles;\n  const context = (\n    isPromoted\n      ? {\n          state: state,\n          previousState: previousState,\n          data: promotedToLinkMap.get(id as string)!,\n          layoutOutput: layoutOutput,\n          startNode: data.startNode,\n          endNode: data.endNode,\n          type: 'promotedLink'\n        }\n      : {\n          state: state,\n          previousState: previousState,\n          data: data,\n          layoutOutput: layoutOutput,\n          type: 'link'\n        }\n  ) as LinkRendererContext<K1, D2, L>;\n  const ref = useRef<SVGGElement>(null);\n  const optionsRef = useRef({ box: 'border-box' as const });\n  useResizeObserver(\n    ref,\n    useCallback(\n      (entry: ResizeObserverEntry) => {\n        const boxSize = entry.borderBoxSize;\n        const width = boxSize[0].inlineSize;\n        const height = boxSize[0].blockSize;\n        onLinkSizeChanged(width, height, id);\n      },\n      [id, onLinkSizeChanged]\n    ),\n    optionsRef.current\n  );\n  //const hasLabel = data.label && labelPosition && labelDimensions;\n  return (\n    <g\n      ref={ref}\n      key={id}\n      id={state.focused ? activeId : undefined}\n      aria-label={getItemAriaLabel(\n        translations,\n        supportsSelection,\n        state.selected,\n        accessibleLabel\n      )}\n      data-oj-private-link={id}\n      role=\"img\"\n      class={classNames([linkStyles, isDimmed && dimmedItemStyle])}>\n      {linkRenderer(context)}\n    </g>\n  );\n};\n","import type { DiagramLabelPosition, DiagramLinkData } from './diagram.types';\nimport { DiagramLabel } from './DiagramLabel';\nimport type { TextDimensions } from '#hooks/PRIVATE_useTextDimensions';\nimport { layerStyles } from './themes/DiagramStyles.css';\nimport { useUser } from '#hooks/UNSAFE_useUser';\n\ntype Props<K1, K2, D2 extends DiagramLinkData<K2, K1>> = {\n  labelPosition: Map<K2, DiagramLabelPosition>;\n  itemProps: D2[];\n  labelDimensions: Map<K2, TextDimensions>;\n};\n\nexport function DiagramLabelLayer<K1, K2, D2 extends DiagramLinkData<K2, K1>>({\n  labelPosition,\n  itemProps,\n  labelDimensions\n}: Props<K1, K2, D2>) {\n  const { direction } = useUser();\n  return (\n    <div class={layerStyles}>\n      {itemProps.map((item) => {\n        if (item.label && labelPosition.get(item.id)) {\n          return (\n            <DiagramLabel\n              styles={item.labelStyle}\n              text={item.label}\n              position={labelPosition.get(item.id)!}\n              dimensions={labelDimensions.get(item.id)!}\n              isRTL={direction === 'rtl'}\n            />\n          );\n        }\n        return undefined;\n      })}\n    </div>\n  );\n}\n","import { ComponentChildren } from 'preact';\nimport type {\n  States,\n  LinkRendererContext,\n  DiagramLinkData,\n  DiagramLayoutOutput,\n  Bounds,\n  DiagramLabelPosition\n} from './diagram.types';\nimport { DiagramLinkElement } from './DiagramLinkElement';\nimport { layerStyles } from './themes/DiagramStyles.css';\nimport { getZoomToFitZoom } from './utils/diagramUtils';\nimport { DiagramLabelLayer } from './DiagramLabelLayer';\nimport { TextDimensions } from '#hooks/PRIVATE_useTextDimensions';\n\ntype Props<K2, K1, D2, L> = {\n  links: D2[];\n  states: States<K1, K2>;\n  previousStates: States<K1, K2>;\n  linkRenderer: (context: LinkRendererContext<K1, D2, L>) => ComponentChildren;\n  width: number;\n  height: number;\n  supportsSelection: boolean;\n  layoutOutput: L;\n  combinedNodeBounds: Bounds;\n  labelDimensions: Map<K1 | K2, TextDimensions>;\n  linkLabelPositions: Map<K2, DiagramLabelPosition>;\n  onLinkSizeChanged: (width: number, height: number, id: K2) => void;\n  minX: number;\n  minY: number;\n  isPromoted?: boolean;\n  promotedToLinkMap: Map<string, D2[]>;\n};\n\nexport function DiagramLinkLayer<\n  K2 extends string | number,\n  K1 extends string | number,\n  D2 extends DiagramLinkData<K2, K1>,\n  L extends DiagramLayoutOutput<K1, K2>\n>({\n  links,\n  states,\n  previousStates,\n  linkRenderer,\n  width,\n  height,\n  supportsSelection,\n  onLinkSizeChanged,\n  layoutOutput,\n  combinedNodeBounds,\n  linkLabelPositions,\n  labelDimensions,\n  isPromoted,\n  promotedToLinkMap\n}: Props<K2, K1, D2, L>) {\n  const zoom = getZoomToFitZoom(width, height, combinedNodeBounds);\n  return (\n    <div>\n      <svg width={width / zoom} height={height / zoom} class={layerStyles} overflow=\"visible\">\n        {links.map((link) => {\n          const state = {\n            selected: isPromoted\n              ? states.selectedPromotedLinkIds.includes(link.id as string)\n              : states.selectedLinkIds.includes(link.id),\n            focused: states.focusedId === link.id,\n            hovered: states.hoveredId === link.id,\n            zoom: states.zoom\n          };\n          const previousState = {\n            selected: isPromoted\n              ? previousStates.selectedPromotedLinkIds.includes(link.id as string)\n              : previousStates.selectedLinkIds.includes(link.id),\n            focused: previousStates.focusedId === link.id,\n            hovered: previousStates.hoveredId === link.id,\n            zoom: previousStates.zoom\n          };\n          return (\n            <DiagramLinkElement\n              id={link.id}\n              label={link.label}\n              state={state}\n              previousState={previousState}\n              isDimmed={\n                states.highlightedLinkIds.length !== 0 &&\n                !states.highlightedLinkIds.includes(link.id)\n              }\n              activeId={states.activeId}\n              accessibleLabel={link.accessibleLabel}\n              data={link}\n              linkRenderer={linkRenderer}\n              supportsSelection={supportsSelection}\n              layoutOutput={layoutOutput}\n              onLinkSizeChanged={onLinkSizeChanged}\n              promotedToLinkMap={promotedToLinkMap}\n              isPromoted={isPromoted}\n            />\n          );\n        })}\n      </svg>\n      {labelDimensions ? (\n        <div>\n          {links && linkLabelPositions ? (\n            <DiagramLabelLayer\n              labelPosition={linkLabelPositions}\n              itemProps={links}\n              labelDimensions={labelDimensions}\n            />\n          ) : undefined}\n        </div>\n      ) : undefined}\n    </div>\n  );\n}\n","import type {\n  State,\n  LinkRendererContext,\n  DiagramLabelPosition,\n  PromotedLinkData\n} from './diagram.types';\nimport { classNames } from '#utils/UNSAFE_classNames';\nimport { itemStyles } from './themes/DiagramStyles.css';\nimport { ComponentChildren } from 'preact';\nimport { useCallback, useRef } from 'preact/hooks';\nimport { useResizeObserver } from '#hooks/UNSAFE_useResizeObserver';\n\n/**\n * Props for Link\n */\nexport type LinkProps<K1, D2, L> = {\n  id: string;\n  state: State;\n  previousState: State;\n  isDimmed?: boolean;\n  activeId?: string;\n  data: PromotedLinkData<K1>;\n  linkRenderer: (context: LinkRendererContext<K1, D2, L>) => ComponentChildren;\n  supportsSelection: boolean;\n  layoutOutput: L;\n  onLinkSizeChanged: (width: number, height: number, id: string) => void;\n  labelPosition?: DiagramLabelPosition;\n  isPromoted?: boolean;\n  promotedToLinkMap: Map<string, D2[]>;\n};\n\nexport const DiagramPromotedLinkElement = <K1, D2, L>({\n  id,\n  state,\n  previousState,\n  activeId,\n  data,\n  linkRenderer,\n  isDimmed,\n  layoutOutput,\n  onLinkSizeChanged,\n  promotedToLinkMap\n} //labelPosition,\n//labelDimensions\n: LinkProps<K1, D2, L>) => {\n  const { dimmedItemStyle, linkStyles } = itemStyles;\n  const context = {\n    state: state,\n    previousState: previousState,\n    data: promotedToLinkMap.get(id as string)!,\n    layoutOutput: layoutOutput,\n    startNode: data.startNode,\n    endNode: data.endNode,\n    type: 'promotedLink',\n    id: id\n  } as LinkRendererContext<K1, D2, L>;\n  const ref = useRef<SVGGElement>(null);\n  const optionsRef = useRef({ box: 'border-box' as const });\n  useResizeObserver(\n    ref,\n    useCallback(\n      (entry: ResizeObserverEntry) => {\n        const boxSize = entry.borderBoxSize;\n        const width = boxSize[0].inlineSize;\n        const height = boxSize[0].blockSize;\n        onLinkSizeChanged(width, height, id);\n      },\n      [id, onLinkSizeChanged]\n    ),\n    optionsRef.current\n  );\n  //const hasLabel = data.label && labelPosition && labelDimensions;\n  return (\n    <g\n      ref={ref}\n      key={id}\n      id={state.focused ? activeId : undefined}\n      data-oj-private-link={id}\n      role=\"img\"\n      class={classNames([linkStyles, isDimmed && dimmedItemStyle])}>\n      {linkRenderer(context)}\n    </g>\n  );\n};\n","import { ComponentChildren } from 'preact';\nimport type {\n  States,\n  LinkRendererContext,\n  DiagramLinkData,\n  DiagramLayoutOutput,\n  Bounds,\n  PromotedLinkData\n} from './diagram.types';\nimport { layerStyles } from './themes/DiagramStyles.css';\nimport { getZoomToFitZoom } from './utils/diagramUtils';\nimport { DiagramPromotedLinkElement } from './DiagramPromotedLinkElement';\n\ntype Props<K2, K1, D2, L> = {\n  links: PromotedLinkData<K1>[];\n  states: States<K1, K2>;\n  previousStates: States<K1, K2>;\n  linkRenderer: (context: LinkRendererContext<K1, D2, L>) => ComponentChildren;\n  width: number;\n  height: number;\n  supportsSelection: boolean;\n  layoutOutput: L;\n  combinedNodeBounds: Bounds;\n  onLinkSizeChanged: (width: number, height: number, id: string) => void;\n  minX: number;\n  minY: number;\n  promotedToLinkMap: Map<string, D2[]>;\n};\n\nexport function DiagramPromotedLinkLayer<\n  K2 extends string | number,\n  K1 extends string | number,\n  D2 extends DiagramLinkData<K2, K1> = DiagramLinkData<K2, K1>,\n  L extends DiagramLayoutOutput<K1, K2> = DiagramLayoutOutput<K1, K2>\n>({\n  links,\n  states,\n  previousStates,\n  linkRenderer,\n  width,\n  height,\n  supportsSelection,\n  onLinkSizeChanged,\n  layoutOutput,\n  combinedNodeBounds,\n  promotedToLinkMap\n}: Props<K2, K1, D2, L>) {\n  const zoom = getZoomToFitZoom(width, height, combinedNodeBounds);\n  return (\n    <div>\n      <svg width={width / zoom} height={height / zoom} class={layerStyles} overflow=\"visible\">\n        {links.map((link) => {\n          const state = {\n            selected: states.selectedPromotedLinkIds.includes(link.id),\n            focused: states.focusedId === link.id,\n            hovered: states.hoveredId === link.id,\n            zoom: states.zoom\n          };\n          const previousState = {\n            selected: previousStates.selectedPromotedLinkIds.includes(link.id),\n            focused: previousStates.focusedId === link.id,\n            hovered: previousStates.hoveredId === link.id,\n            zoom: previousStates.zoom\n          };\n          return (\n            <DiagramPromotedLinkElement\n              id={link.id}\n              state={state}\n              previousState={previousState}\n              isDimmed={\n                states.highlightedPromotedLinkIds.length !== 0 &&\n                !states.highlightedPromotedLinkIds.includes(link.id)\n              }\n              activeId={states.activeId}\n              data={link}\n              linkRenderer={linkRenderer}\n              supportsSelection={supportsSelection}\n              layoutOutput={layoutOutput}\n              onLinkSizeChanged={onLinkSizeChanged}\n              promotedToLinkMap={promotedToLinkMap}\n              isPromoted={true}\n            />\n          );\n        })}\n      </svg>\n    </div>\n  );\n}\n","import { ComponentChildren, RefObject } from 'preact';\nimport type {\n  States,\n  NodeRendererContext,\n  Bounds,\n  DiagramNodeData,\n  DiagramLabelPosition,\n  Dimensions,\n  DiagramLinkData,\n  LinkRendererContext,\n  DiagramLayoutOutput,\n  PromotedLinkData\n} from './diagram.types';\nimport { DiagramNodeElement } from './DiagramNodeElement';\nimport { layerStyles } from './themes/DiagramStyles.css';\nimport {\n  containerLinksReady,\n  getBounds,\n  getLinksForNode,\n  isContainerReady,\n  isLeafNode\n} from './utils/diagramUtils';\nimport { TextDimensions } from '#hooks/PRIVATE_useTextDimensions';\nimport { DiagramLinkLayer } from './DiagramLinkLayer';\nimport { DiagramPromotedLinkLayer } from './DiagramPromotedLinkLayer';\n\ntype Props<K1, K2, D1, D2, L> = {\n  nodes: D1[];\n  states: States<K1, K2>;\n  previousStates: States<K1, K2>;\n  nodeRenderer: (context: NodeRendererContext<D1>) => ComponentChildren;\n  linkRenderer?: (context: LinkRendererContext<K1, D2, L>) => ComponentChildren;\n  onNodeSizeChanged: (width: number, height: number, id: K1) => void;\n  onLinkSizeChanged: (width: number, height: number, id: K2) => void;\n  onPromotedLinkSizeChanged: (width: number, height: number, id: string) => void;\n  nodeBounds: Map<K1, Bounds>;\n  supportsSelection: boolean;\n  minX?: number;\n  minY?: number;\n  nodeLabelPositions: Map<K1, DiagramLabelPosition>;\n  linkLabelPositions: Map<K2, DiagramLabelPosition>;\n  labelDimensions: Map<K1 | K2, TextDimensions>;\n  contentDims?: Map<K1, Dimensions>;\n  links: D2[];\n  promotedLinks: PromotedLinkData<K1>[];\n  //linkAncestors: Map<K1, K2[]>;\n  parentId?: K1;\n  nodeIdToParentMap: Map<K1, K1>;\n  layoutOutput?: L;\n  // width height are for svg for links\n  width: number;\n  height: number;\n  zoom: number;\n  linkDimensions: Map<K2, Dimensions>;\n  promotedLinkDimensions: Map<string, Dimensions>;\n  rootRef?: RefObject<HTMLDivElement>;\n  combinedNodeBounds: Bounds;\n  nodeBoundsRef: RefObject<Map<K1, Bounds>>;\n  promotedToLinkMap: Map<string, D2[]>;\n};\n\nexport function DiagramNodeLayer<\n  K1 extends string | number,\n  K2 extends string | number,\n  D1 extends DiagramNodeData<K1, D1>,\n  D2 extends DiagramLinkData<K2, K1>,\n  L extends DiagramLayoutOutput<K1, K2>\n>({\n  nodes,\n  states,\n  previousStates,\n  nodeRenderer,\n  linkRenderer,\n  nodeBounds,\n  width,\n  height,\n  onNodeSizeChanged,\n  onLinkSizeChanged,\n  onPromotedLinkSizeChanged,\n  supportsSelection,\n  nodeLabelPositions,\n  linkLabelPositions,\n  labelDimensions,\n  minX = 0,\n  minY = 0,\n  parentId,\n  links,\n  promotedLinks,\n  layoutOutput,\n  zoom,\n  nodeIdToParentMap,\n  linkDimensions,\n  promotedLinkDimensions,\n  rootRef,\n  combinedNodeBounds,\n  nodeBoundsRef,\n  promotedToLinkMap\n}: Props<K1, K2, D1, D2, L>) {\n  const {\n    containerLinks: containerParentLinks,\n    containerPromotedLinks: containerParentPromotedLinks\n  } = getLinksForNode<K1, K2, D2>(parentId, links, promotedLinks, nodeIdToParentMap);\n  return (\n    <div class={layerStyles} data-node-container>\n      {nodes.map((node) => {\n        // this is for initial render before the layout function so render all nodes at 0,0\n        const position =\n          nodeBounds && nodeBounds.get(node.id)\n            ? { x: nodeBounds.get(node.id)!.x - minX, y: nodeBounds.get(node.id)!.y - minY }\n            : undefined;\n        const state = {\n          selected: states.selectedNodeIds.includes(node.id),\n          focused: states.focusedId === node.id,\n          hovered: states.hoveredId === node.id,\n          zoom: states.zoom,\n          expanded: states.expanded && states.expanded.includes(node.id)\n        };\n        const previousState = {\n          selected: previousStates.selectedNodeIds.includes(node.id),\n          focused: previousStates.focusedId === node.id,\n          hovered: previousStates.hoveredId === node.id,\n          zoom: previousStates.zoom,\n          expanded: previousStates.expanded && previousStates.expanded.includes(node.id)\n        };\n        const { containerLinks, containerPromotedLinks } = getLinksForNode<K1, K2, D2>(\n          node.id,\n          links,\n          promotedLinks,\n          nodeIdToParentMap\n        );\n\n        // Leaf node or node is collapsed\n        if (isLeafNode(node) || !states.expanded.includes(node.id)) {\n          return (\n            <DiagramNodeElement\n              id={node.id}\n              position={position}\n              state={state}\n              previousState={previousState}\n              isDimmed={\n                states.highlightedNodeIds.length !== 0 &&\n                !states.highlightedNodeIds.includes(node.id)\n              }\n              activeId={states.activeId}\n              nodeRenderer={nodeRenderer}\n              onNodeSizeChanged={onNodeSizeChanged}\n              accessibleLabel={node.accessibleLabel}\n              data={node}\n              isExpanded={false}\n              supportsSelection={supportsSelection}\n              labelDimensions={labelDimensions}\n              labelPosition={nodeLabelPositions?.get(node.id)}\n            />\n          );\n          // Expanded container where children are ready\n        } else if (\n          nodeBounds &&\n          isContainerReady<K1, K2, D1, D2>(\n            node,\n            nodeBounds,\n            containerLinks,\n            containerPromotedLinks,\n            linkDimensions,\n            promotedLinkDimensions\n          )\n        ) {\n          //const links = linkAncestors.get(node.id);\n          const childContent = getContent<K1, K2, D1, D2, L>(\n            node,\n            states,\n            previousStates,\n            nodeRenderer,\n            onNodeSizeChanged,\n            onLinkSizeChanged,\n            onPromotedLinkSizeChanged,\n            supportsSelection,\n            links,\n            promotedLinks,\n            nodeIdToParentMap,\n            width,\n            height,\n            zoom,\n            node.id,\n            nodeBounds,\n            linkDimensions,\n            promotedLinkDimensions,\n            combinedNodeBounds,\n            nodeBoundsRef,\n            nodeLabelPositions,\n            linkLabelPositions,\n            labelDimensions,\n            promotedToLinkMap,\n            linkRenderer,\n            layoutOutput,\n            rootRef\n          );\n          return (\n            <DiagramNodeElement\n              id={node.id}\n              position={position}\n              state={state}\n              previousState={previousState}\n              isDimmed={\n                states.highlightedNodeIds.length !== 0 &&\n                !states.highlightedNodeIds.includes(node.id)\n              }\n              activeId={states.activeId}\n              nodeRenderer={nodeRenderer}\n              onNodeSizeChanged={onNodeSizeChanged}\n              accessibleLabel={node.accessibleLabel}\n              data={node}\n              isExpanded={true}\n              supportsSelection={supportsSelection}\n              content={childContent}\n              labelDimensions={labelDimensions}\n              labelPosition={nodeLabelPositions?.get(node.id)}\n            />\n          );\n        } else {\n          const childContent = getContent<K1, K2, D1, D2, L>(\n            node,\n            states,\n            previousStates,\n            nodeRenderer,\n            onNodeSizeChanged,\n            onLinkSizeChanged,\n            onPromotedLinkSizeChanged,\n            supportsSelection,\n            links,\n            promotedLinks,\n            nodeIdToParentMap,\n            width,\n            height,\n            zoom,\n            node.id,\n            nodeBounds,\n            linkDimensions,\n            promotedLinkDimensions,\n            combinedNodeBounds,\n            nodeBoundsRef,\n            nodeLabelPositions,\n            linkLabelPositions,\n            labelDimensions,\n            promotedToLinkMap,\n            linkRenderer,\n            layoutOutput,\n            rootRef\n          );\n          return <div>{childContent.element}</div>;\n        }\n      })}\n      {links.length > 0 &&\n        layoutOutput &&\n        linkRenderer &&\n        width !== Infinity &&\n        containerParentLinks.length > 0 &&\n        containerLinksReady<K1, K2, D2, L>(containerParentLinks, layoutOutput) && (\n          <DiagramLinkLayer\n            links={containerParentLinks}\n            states={states}\n            previousStates={previousStates}\n            linkRenderer={linkRenderer}\n            width={width / zoom}\n            height={height}\n            supportsSelection={supportsSelection}\n            labelDimensions={labelDimensions}\n            layoutOutput={layoutOutput}\n            onLinkSizeChanged={onLinkSizeChanged}\n            linkLabelPositions={linkLabelPositions}\n            combinedNodeBounds={combinedNodeBounds}\n            minX={minX}\n            minY={minY}\n            promotedToLinkMap={promotedToLinkMap}\n          />\n        )}\n      {promotedLinks.length > 0 &&\n        layoutOutput &&\n        linkRenderer &&\n        width !== Infinity &&\n        containerParentPromotedLinks.length > 0 &&\n        containerLinksReady<K1, K2, D2, L>(containerParentPromotedLinks, layoutOutput) && (\n          <DiagramPromotedLinkLayer\n            links={containerParentPromotedLinks as PromotedLinkData<K1>[]}\n            states={states}\n            previousStates={previousStates}\n            linkRenderer={linkRenderer}\n            width={width / zoom}\n            height={height}\n            supportsSelection={supportsSelection}\n            layoutOutput={layoutOutput}\n            onLinkSizeChanged={onPromotedLinkSizeChanged}\n            combinedNodeBounds={combinedNodeBounds}\n            minX={minX}\n            minY={minY}\n            promotedToLinkMap={promotedToLinkMap}\n          />\n        )}\n    </div>\n  );\n}\n\nfunction getContent<\n  K1 extends string | number,\n  K2 extends string | number,\n  D1 extends DiagramNodeData<K1, D1>,\n  D2 extends DiagramLinkData<K2, K1>,\n  L extends DiagramLayoutOutput<K1, K2>\n>(\n  nodeData: D1,\n  states: States<K1, K2>,\n  previousStates: States<K1, K2>,\n  nodeRenderer: (context: NodeRendererContext<D1>) => ComponentChildren,\n  onNodeSizeChanged: (width: number, height: number, id: K1) => void,\n  onLinkSizeChanged: (width: number, height: number, id: K2) => void,\n  onPromotedLinkSizeChanged: (width: number, height: number, id: string) => void,\n  supportsSelection: boolean,\n  links: D2[],\n  promotedLinks: PromotedLinkData<K1>[],\n  nodeIdToParentMap: Map<K1, K1>,\n  width: number,\n  height: number,\n  zoom: number,\n  parentId: K1,\n  nodeBounds: Map<K1, Bounds>,\n  linkDimensions: Map<K2, Dimensions>,\n  promotedLinkDimensions: Map<string, Dimensions>,\n  combinedNodeBounds: Bounds,\n  nodeBoundsRef: RefObject<Map<K1, Bounds>>,\n  nodeLabelPositions: Map<K1, DiagramLabelPosition>,\n  linkLabelPositions: Map<K2, DiagramLabelPosition>,\n  labelDimensions: Map<K1 | K2, TextDimensions>,\n  promotedToLinkMap: Map<string, D2[]>,\n  linkRenderer?: (context: LinkRendererContext<K1, D2, L>) => ComponentChildren,\n  layoutOutput?: L,\n  rootRef?: RefObject<HTMLDivElement>\n) {\n  //let minX;\n  //let minY;\n  //let maxX;\n  //let maxY;\n  //let validBounds;\n  const children = nodeData.children!;\n  const { containerLinks, containerPromotedLinks } = getLinksForNode<K1, K2, D2>(\n    parentId,\n    links,\n    promotedLinks,\n    nodeIdToParentMap\n  );\n  const { minX, minY, contentWidth, contentHeight, linkBounds } = getBounds(\n    children,\n    containerLinks,\n    containerPromotedLinks,\n    nodeBounds,\n    linkDimensions,\n    promotedLinkDimensions,\n    zoom,\n    rootRef\n  );\n  if (linkBounds) {\n    const nodeFullBounds = nodeBoundsRef.current;\n    nodeFullBounds?.set(nodeData.id, linkBounds);\n    nodeBoundsRef.current = nodeFullBounds;\n  }\n  //console.log('children', minX, minY, contentWidth, contentHeight);\n\n  const element = (\n    <div data-oj-child={parentId} style={{ position: 'relative' }}>\n      <DiagramNodeLayer\n        nodes={children}\n        nodeBounds={nodeBounds}\n        states={states}\n        minX={nodeBounds ? minX : undefined}\n        minY={nodeBounds ? minY : undefined}\n        previousStates={previousStates}\n        nodeRenderer={nodeRenderer}\n        onNodeSizeChanged={onNodeSizeChanged}\n        onLinkSizeChanged={onLinkSizeChanged}\n        onPromotedLinkSizeChanged={onPromotedLinkSizeChanged}\n        supportsSelection={supportsSelection}\n        nodeLabelPositions={nodeLabelPositions}\n        linkLabelPositions={linkLabelPositions}\n        labelDimensions={labelDimensions}\n        links={links}\n        promotedLinks={promotedLinks}\n        nodeIdToParentMap={nodeIdToParentMap}\n        linkRenderer={linkRenderer}\n        layoutOutput={layoutOutput}\n        width={width}\n        height={height}\n        zoom={zoom}\n        parentId={parentId}\n        linkDimensions={linkDimensions}\n        promotedLinkDimensions={promotedLinkDimensions}\n        rootRef={rootRef}\n        combinedNodeBounds={combinedNodeBounds}\n        nodeBoundsRef={nodeBoundsRef}\n        promotedToLinkMap={promotedToLinkMap}\n      />\n    </div>\n  );\n  return {\n    element,\n    width: contentWidth ? contentWidth : 0,\n    height: contentHeight ? contentHeight - minY! : 0,\n    linkBounds\n  };\n}\n","import type {\n  NodeRendererContext,\n  LinkRendererContext,\n  States,\n  Bounds,\n  DiagramLabelPosition,\n  DiagramNodeData,\n  DiagramLinkData,\n  DiagramLayoutOutput,\n  Dimensions,\n  PromotedLinkData\n} from './diagram.types';\nimport { DiagramNodeLayer } from './DiagramNodeLayer';\nimport { ComponentChildren, RefObject } from 'preact';\nimport type { TextDimensions } from '#hooks/PRIVATE_useTextDimensions';\nimport { getBounds, getLinksForNode } from './utils/diagramUtils';\n\n/**\n * Props for Diagram layers component\n */\ntype DiagramLayersProps<K1, K2, D1, D2, L> = {\n  nodes: D1[];\n  links: D2[];\n  nodeRenderer: (context: NodeRendererContext<D1>) => ComponentChildren;\n  linkRenderer?: (context: LinkRendererContext<K1, D2, L>) => ComponentChildren;\n  states: States<K1, K2>;\n  previousStates: States<K1, K2>;\n  nodeBounds: Map<K1, Bounds>;\n  // width height are for svg for links\n  width: number;\n  height: number;\n  onNodeSizeChanged: (width: number, height: number, id: K1) => void;\n  onLinkSizeChanged: (width: number, height: number, id: K2) => void;\n  onPromotedLinkSizeChanged: (width: number, height: number, id: string) => void;\n  nodeLabelPositions: Map<K1, DiagramLabelPosition>;\n  linkLabelPositions: Map<K2, DiagramLabelPosition>;\n  labelDimensions: Map<K1 | K2, TextDimensions>;\n  supportsSelection: boolean;\n  layoutOutput?: L;\n  combinedNodeBounds: Bounds;\n  zoom: number;\n  nodeIdToParentMap: Map<K1, K1>;\n  linkDimensions: Map<K2, Dimensions>;\n  promotedLinkDimensions: Map<string, Dimensions>;\n  rootRef?: RefObject<HTMLDivElement>;\n  nodeBoundsRef: RefObject<Map<K1, Bounds>>;\n  promotedLinks: PromotedLinkData<K1>[];\n  promotedToLinkMap: Map<string, D2[]>;\n};\n\nexport function DiagramLayers<\n  K1 extends string | number,\n  K2 extends string | number,\n  D1 extends DiagramNodeData<K1, D1>,\n  D2 extends DiagramLinkData<K2, K1>,\n  L extends DiagramLayoutOutput<K1, K2>\n>({\n  nodes,\n  links,\n  promotedLinks,\n  nodeRenderer,\n  linkRenderer,\n  states,\n  previousStates,\n  nodeBounds,\n  width,\n  height,\n  onNodeSizeChanged,\n  onLinkSizeChanged,\n  onPromotedLinkSizeChanged,\n  labelDimensions,\n  nodeLabelPositions,\n  linkLabelPositions,\n  supportsSelection,\n  layoutOutput,\n  zoom,\n  nodeIdToParentMap,\n  linkDimensions,\n  promotedLinkDimensions,\n  rootRef,\n  combinedNodeBounds,\n  nodeBoundsRef,\n  promotedToLinkMap\n}: DiagramLayersProps<K1, K2, D1, D2, L>) {\n  const { containerLinks, containerPromotedLinks } = getLinksForNode<K1, K2, D2>(\n    undefined,\n    links,\n    promotedLinks,\n    nodeIdToParentMap\n  );\n  const { minX, minY } = getBounds(\n    nodes,\n    containerLinks,\n    containerPromotedLinks,\n    nodeBounds,\n    linkDimensions,\n    promotedLinkDimensions,\n    zoom,\n    rootRef\n  );\n  return (\n    <>\n      <DiagramNodeLayer\n        nodes={nodes}\n        nodeBounds={nodeBounds}\n        states={states}\n        previousStates={previousStates}\n        nodeRenderer={nodeRenderer}\n        onNodeSizeChanged={onNodeSizeChanged}\n        onLinkSizeChanged={onLinkSizeChanged}\n        onPromotedLinkSizeChanged={onPromotedLinkSizeChanged}\n        supportsSelection={supportsSelection}\n        nodeLabelPositions={nodeLabelPositions}\n        linkLabelPositions={linkLabelPositions}\n        labelDimensions={labelDimensions}\n        linkDimensions={linkDimensions}\n        promotedLinkDimensions={promotedLinkDimensions}\n        rootRef={rootRef}\n        links={links}\n        promotedLinks={promotedLinks}\n        nodeIdToParentMap={nodeIdToParentMap}\n        linkRenderer={linkRenderer}\n        layoutOutput={layoutOutput}\n        width={width}\n        height={height}\n        zoom={zoom}\n        minX={nodeBounds && minX !== Infinity ? minX : undefined}\n        minY={nodeBounds && minY !== Infinity ? minY : undefined}\n        combinedNodeBounds={combinedNodeBounds}\n        nodeBoundsRef={nodeBoundsRef}\n        promotedToLinkMap={promotedToLinkMap}\n      />\n    </>\n  );\n}\n","import { ComponentChildren } from 'preact';\nimport { centerXYToPanXY } from './utils/diagramUtils';\nimport { panZoomStyles } from './themes/DiagramStyles.css';\n\ntype Props = {\n  centerX: number;\n  centerY: number;\n  zoom: number;\n  width: number;\n  height: number;\n  children: ComponentChildren;\n};\n\nexport function DiagramPanZoomContainer({\n  centerX,\n  centerY,\n  children,\n  zoom,\n  width,\n  height\n}: Props) {\n  const panValues = centerXYToPanXY(centerX, centerY, zoom, width, height);\n  return (\n    <div\n      class={panZoomStyles}\n      style={{\n        //TODO JET-62471 look at using matrices or both in transform instead\n        translate: `${panValues.panX}px ${panValues.panY}px`,\n        transform: `scale(${zoom})`\n      }}>\n      {children}\n    </div>\n  );\n}\n","/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\n\nimport type { DiagramNodeData, DiagramLinkData, Bounds, ItemInfo } from '../diagram.types';\n\n/**\n * Navigation direction\n */\nexport type NavDirection = 'right' | 'left' | 'up' | 'down';\n\ntype linkDetailType<K2> = {\n  id: K2;\n  angle: number;\n  distance: number;\n  /**\n   * Ingoing = 1, outgoing = 0\n   */\n  direction: 0 | 1;\n};\n\n/**\n * Returns the node data based on node info in a diagram.\n * @param itemInfo\n * @returns\n */\nexport function getNodeDetailFromInfo<K1, K2, D1 extends DiagramNodeData<K1, D1>>(\n  itemInfo: ItemInfo<K1, K2>,\n  nodes: D1[]\n): D1 | undefined {\n  let node;\n  for (let i = 0; i < nodes.length; i++) {\n    node = nodes[i];\n    if (itemInfo.id === node.id) {\n      return node;\n    }\n  }\n  return undefined;\n}\n\n/**\n * Returns the link data based on link info in a diagram.\n * @param itemInfo\n * @returns\n */\nexport function getLinkDetailFromInfo<K1, K2, D2 extends DiagramLinkData<K2, K1>>(\n  itemInfo: ItemInfo<K1, K2>,\n  links: D2[]\n): D2 | undefined {\n  let link;\n  for (let i = 0; i < links.length; i++) {\n    link = links[i];\n    if (itemInfo.id === link.id) {\n      return link;\n    }\n  }\n  return undefined;\n}\n\n/**\n * Utility method that adds sorting attributes of each link to an array\n */\nexport function addSortingAttributes<\n  K1,\n  K2,\n  D1 extends DiagramNodeData<K1, D1>,\n  D2 extends DiagramLinkData<K2, K1>\n>(node: D1, listOfLinks: D2[], nodes: D1[], nodeBounds: Map<K1, Bounds>) {\n  let angle, distance, direction;\n  const linkDetail: linkDetailType<K2>[] = [];\n  for (let i = 0; i < listOfLinks.length; i++) {\n    const link = listOfLinks[i];\n    angle = _getClockwiseAngle(node, link, nodes, nodeBounds);\n    distance = _getNodesDistance(link, nodes, nodeBounds);\n    direction = _getLinkDirection(node, link);\n    linkDetail.push({ id: link.id, angle: angle, distance: distance, direction: direction });\n  }\n  return linkDetail;\n}\n\n/**\n * Returns a function that compares two link around a given node\n * The links are analyzed by angle, distance from the node and direction. The sorting attributes are added to the links before sorting.\n */\nexport function getLinkComparator<K2>() {\n  return (link1: linkDetailType<K2>, link2: linkDetailType<K2>) => {\n    const { angle: linkAngle1, distance: linkDistance1, direction: linkDirection1 } = link1;\n    const { angle: linkAngle2, distance: linkDistance2, direction: linkDirection2 } = link2;\n    let res = -1;\n\n    if (!_anglesAreEqualWithinTolerance(linkAngle1, linkAngle2) && linkAngle1 > linkAngle2) {\n      res = 1;\n    } else if (_anglesAreEqualWithinTolerance(linkAngle1, linkAngle2)) {\n      //check distance and direction\n      if (linkDistance1 > linkDistance2) {\n        res = 1;\n      } else if (linkDistance2 == linkDistance1 && linkDirection1 > linkDirection2) {\n        //outgoing to ingoing\n        res = 1;\n      } else if (linkDistance2 == linkDistance1 && linkDirection1 == linkDirection2) {\n        res = 0;\n      }\n    }\n    return res;\n  };\n}\n\n/**\n * Returns navigable links for a given node\n */\nexport function getNavigableLinksForNodeId<K1, K2, D2 extends DiagramLinkData<K2, K1>>(\n  nodeId: K1,\n  listOfLinks: D2[]\n) {\n  const links: D2[] = [];\n  listOfLinks.forEach((link) => {\n    const startId = link.startNode;\n    const endId = link.endNode;\n\n    if (startId == nodeId || endId == nodeId) links.push(link);\n  });\n  return links;\n}\n\n/**\n * Get the clockwise angle for the link given node as a center\n */\nfunction _getClockwiseAngle<\n  K1,\n  K2,\n  D1 extends DiagramNodeData<K1, D1>,\n  D2 extends DiagramLinkData<K2, K1>\n>(node: D1, link: D2, nodes: D1[], nodeBounds: Map<K1, Bounds>) {\n  //find opposite node\n  let currNode;\n  let startNode = nodes[0];\n  let endNode = nodes[0];\n  for (let i = 0; i < nodes.length; i++) {\n    currNode = nodes[i];\n    if (currNode.id === link.startNode) {\n      startNode = currNode;\n    } else if (currNode.id === link.endNode) {\n      endNode = currNode;\n    }\n  }\n  const oppositeNode = node.id == startNode.id ? endNode : startNode;\n\n  const p1 = _getNodeCenter(node, nodeBounds);\n  const p2 = _getNodeCenter(oppositeNode, nodeBounds);\n  let angle = Math.atan2(p2.y - p1.y, p2.x - p1.x);\n  angle = angle < 0 ? angle + Math.PI * 2 : angle;\n  return angle;\n}\n\n/**\n * Get the distance between start and end nodes for the given link\n */\nfunction _getNodesDistance<\n  K1,\n  K2,\n  D1 extends DiagramNodeData<K1, D1>,\n  D2 extends DiagramLinkData<K2, K1>\n>(link: D2, nodes: D1[], nodeBounds: Map<K1, Bounds>) {\n  let currNode;\n  let startNode = nodes[0];\n  let endNode = nodes[0];\n  for (let i = 0; i < nodes.length; i++) {\n    currNode = nodes[i];\n    if (currNode.id === link.startNode) {\n      startNode = currNode;\n    } else if (currNode.id === link.endNode) {\n      endNode = currNode;\n    }\n  }\n  const p1 = _getNodeCenter(startNode, nodeBounds);\n  const p2 = _getNodeCenter(endNode, nodeBounds);\n  return Math.sqrt(Math.pow(p2.x - p1.x, 2) + Math.pow(p2.y - p1.y, 2));\n}\n\n/**\n * Get link direction for the given node.  1 if the node is the end node\n * and 0 if it is the start node\n */\nfunction _getLinkDirection<\n  K1,\n  K2,\n  D1 extends DiagramNodeData<K1, D1>,\n  D2 extends DiagramLinkData<K2, K1>\n>(node: D1, link: D2): 0 | 1 {\n  if (link.endNode === node.id) {\n    return 1;\n  }\n  return 0;\n}\n\n/**\n * Get node center\n */\nfunction _getNodeCenter<K1, D1 extends DiagramNodeData<K1, D1>>(\n  node: D1,\n  nodeBounds: Map<K1, Bounds>\n) {\n  const nodeBB = nodeBounds.get(node.id)!;\n  return { x: nodeBB.x + nodeBB.width / 2, y: nodeBB.y + nodeBB.height / 2 };\n}\n\n/**\n * Calculates the angle weighted by distance\n */\nexport function calcDistanceAngleWeighted(\n  objectBB: Bounds,\n  currentBB: Bounds,\n  direction: NavDirection\n) {\n  // Variables used for calculating penalties when calculating distances between two navigables.\n  const optimalAngle1 = (15 / 180) * Math.PI;\n  const optimalAngle2 = (40 / 180) * Math.PI;\n  const suboptimalAnglePenalty1 = 2; // multiplier to the distance\n  const suboptimalAnglePenalty2 = 6; // multiplier to the distance\n\n  const objCenterX = objectBB.x + objectBB.width / 2;\n  const objCenterY = objectBB.y + objectBB.height / 2;\n\n  const curCenterX = currentBB.x + currentBB.width / 2;\n  const curCenterY = currentBB.y + currentBB.height / 2;\n\n  const x_dist = Math.abs(objCenterX - curCenterX);\n  const y_dist = Math.abs(objCenterY - curCenterY);\n\n  const angle = Math.atan2(y_dist, x_dist);\n\n  let distance = Math.sqrt(x_dist * x_dist + y_dist * y_dist);\n\n  // Angle penalty based on direction\n  if (\n    (angle > optimalAngle1 && (direction == 'right' || direction == 'left')) ||\n    (angle < Math.PI / 2 - optimalAngle1 && (direction == 'up' || direction == 'down'))\n  ) {\n    if (\n      (angle > optimalAngle2 && (direction == 'right' || direction == 'left')) ||\n      (angle < Math.PI / 2 - optimalAngle2 && (direction == 'up' || direction == 'down'))\n    ) {\n      distance *= suboptimalAnglePenalty2;\n    } else {\n      distance *= suboptimalAnglePenalty1;\n    }\n  }\n\n  return distance;\n}\n\n/**\n * Given a direction, is a certain node is a valid destination to navigate to\n */\nexport function isValidDestination(\n  objBB: Bounds,\n  curBB: Bounds,\n  direction: NavDirection,\n  compareCenters: boolean\n) {\n  // compare the centers of the navigable and to be valid, the navigable must be in the right direction\n  // without tolerance\n  if (compareCenters) {\n    const objCenterX = objBB.x + 0.5 * objBB.width;\n    const curCenterX = curBB.x + 0.5 * curBB.width;\n    const objCenterY = objBB.y + 0.5 * objBB.height;\n    const curCenterY = curBB.y + 0.5 * curBB.height;\n\n    switch (direction) {\n      case 'up':\n        return objCenterY < curCenterY;\n      case 'down':\n        return objBB.y > curCenterY;\n      case 'right':\n        return objCenterX > curCenterX;\n      case 'left':\n        return objCenterX < curCenterX;\n      default:\n        break;\n    }\n    return true;\n  }\n\n  switch (direction) {\n    case 'up':\n      return objBB.y < curBB.y || _areEqualWithinTolerance(objBB.y, curBB.y);\n    case 'down':\n      return objBB.y > curBB.y || _areEqualWithinTolerance(objBB.y, curBB.y);\n    case 'right':\n      return objBB.x > curBB.x || _areEqualWithinTolerance(objBB.x, curBB.x);\n    case 'left':\n      return objBB.x < curBB.x || _areEqualWithinTolerance(objBB.x, curBB.x);\n    default:\n      break;\n  }\n  return true;\n}\n\n/**\n * Returns true if two nodes are in contact\n */\nexport function calcInContact(objRect: Bounds, curRect: Bounds, direction: NavDirection) {\n  switch (direction) {\n    case 'up':\n      return (\n        _isVerticallyAligned(objRect, curRect) &&\n        (curRect.y <= objRect.y + objRect.height ||\n          _areEqualWithinTolerance(curRect.y, objRect.y + objRect.height))\n      );\n    case 'down':\n      return (\n        _isVerticallyAligned(objRect, curRect) &&\n        (objRect.y <= curRect.y + curRect.height ||\n          _areEqualWithinTolerance(objRect.y, curRect.y + curRect.height))\n      );\n    case 'right':\n      return (\n        _isHorizontallyAligned(objRect, curRect) &&\n        (objRect.x <= curRect.x + curRect.width ||\n          _areEqualWithinTolerance(objRect.x, curRect.x + curRect.width))\n      );\n    case 'left':\n      return (\n        _isHorizontallyAligned(objRect, curRect) &&\n        (curRect.x <= objRect.x + objRect.width ||\n          _areEqualWithinTolerance(curRect.x, objRect.x + objRect.width))\n      );\n    default:\n      break;\n  }\n\n  return false;\n}\n\nfunction _isVerticallyAligned(rect1: Bounds, rect2: Bounds) {\n  return (\n    (rect1.x >= rect2.x && rect1.x <= rect2.x + rect2.width) ||\n    (rect2.x >= rect1.x && rect2.x <= rect1.x + rect1.width)\n  );\n}\n\nfunction _isHorizontallyAligned(rect1: Bounds, rect2: Bounds) {\n  return (\n    (rect1.y >= rect2.y && rect1.y <= rect2.y + rect2.height) ||\n    (rect2.y >= rect1.y && rect2.y <= rect1.y + rect1.height)\n  );\n}\n\nfunction _areEqualWithinTolerance(a: number, b: number) {\n  return Math.abs(a - b) <= 0.0000001;\n}\n\nfunction _anglesAreEqualWithinTolerance(a1: number, a2: number) {\n  let res = Math.abs(a1 - a2) <= 0.0000001;\n  if (!res) {\n    res = Math.abs(Math.PI * 2 + Math.min(a1, a2) - Math.max(a1, a2)) <= 0.0000001;\n  }\n  return res;\n}\n","/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\n\nimport {\n  NavDirection,\n  addSortingAttributes,\n  calcDistanceAngleWeighted,\n  calcInContact,\n  getLinkComparator,\n  getNavigableLinksForNodeId,\n  getNodeDetailFromInfo,\n  isValidDestination\n} from '../utils/navUtils';\nimport type { DiagramNodeData, DiagramLinkData, Bounds, ItemInfo } from '../diagram.types';\nimport { useRef } from 'preact/hooks';\n\nexport function useDiagramNavigation<\n  K1,\n  K2,\n  D1 extends DiagramNodeData<K1, D1>,\n  D2 extends DiagramLinkData<K2, K1>\n>(nodes: D1[], links: D2[], bounds: Map<K1, Bounds>, linkIdToDataMap: Map<K2, D2>) {\n  const currentKeyboardFocusNode = useRef<K1>();\n  const nodeBoundsById = bounds;\n\n  function getNextNavigableNode(\n    direction: NavDirection,\n    compareCenters: boolean,\n    current?: D1,\n    listOfObjects?: D1[]\n  ) {\n    if (!listOfObjects) return current;\n\n    if (!current) return listOfObjects[0];\n    const currBB = nodeBoundsById.get(current.id);\n    if (!currBB) return listOfObjects[0];\n\n    let nextObject = current; //init to current object\n    let nextDistance = Number.MAX_VALUE;\n\n    // If an object is in contact it overrules all other attributes\n    // Only another in contact object with better attributes will have higher precedence\n    let nextInContact = false;\n\n    // Whether or not the for loop has encountered the current object\n    let hasFoundCurrent = false;\n\n    let object, inContact, distance;\n    for (let i = 0; i < listOfObjects.length; i++) {\n      object = listOfObjects[i];\n\n      if (object === current) {\n        hasFoundCurrent = true;\n        continue;\n      }\n      const objBB = nodeBoundsById.get(object.id);\n      if (!objBB) continue;\n\n      const objBounds = { x: objBB.x, y: objBB.y, width: objBB.width, height: objBB.height };\n      const currBounds = { x: currBB.x, y: currBB.y, width: currBB.width, height: currBB.height };\n      if (!isValidDestination(objBounds, currBounds, direction, compareCenters)) continue;\n\n      inContact = calcInContact(objBounds, currBounds, direction);\n\n      if (nextInContact && !inContact) continue;\n\n      distance = calcDistanceAngleWeighted(objBounds, currBounds, direction);\n\n      if (distance == 0 && !hasFoundCurrent) continue;\n\n      // Make sure incontact flag have highest precedence\n      if (\n        (!nextInContact && inContact) ||\n        (distance < nextDistance && ((nextInContact && inContact) || !nextInContact))\n      ) {\n        nextDistance = distance;\n        nextObject = object;\n        nextInContact = inContact;\n      }\n    }\n    return nextObject;\n  }\n\n  /**\n   * Get next navigavle link depending on direction - clockwise or conter clockwise.\n   * The decision is made based on location of nodes centers rather than link paths or link angles.\n   */\n  function getNextNavigableLink(\n    direction: string,\n    listOfNodes: D1[],\n    currentLink?: D2,\n    listOfLinks?: D2[]\n  ) {\n    if (!listOfLinks) return currentLink;\n\n    if (!currentLink) return listOfLinks[0];\n    const keyboardFocusNode = currentKeyboardFocusNode.current;\n    const nodeId = keyboardFocusNode ? keyboardFocusNode : currentLink.startNode;\n    const node = getNodeDetailFromInfo({ id: nodeId, type: 'node' }, listOfNodes);\n\n    if (!node) return currentLink;\n    const adjLinks = getNavigableLinksForNodeId(node.id, listOfLinks);\n    listOfLinks = adjLinks;\n    const linksWithSortingAttributes = addSortingAttributes<K1, K2, D1, D2>(\n      node,\n      listOfLinks,\n      listOfNodes,\n      nodeBoundsById\n    );\n    linksWithSortingAttributes.sort(getLinkComparator());\n    //clockwise direction\n    const bForward = direction == 'down' ? true : false;\n    let index = 0;\n    for (let i = 0; i < linksWithSortingAttributes.length; i++) {\n      const link = linksWithSortingAttributes[i];\n      if (link.id === currentLink.id) {\n        if (bForward) index = i == linksWithSortingAttributes.length - 1 ? 0 : i + 1;\n        else index = i == 0 ? linksWithSortingAttributes.length - 1 : i - 1;\n        break;\n      }\n    }\n    return linksWithSortingAttributes[index];\n  }\n\n  /**\n   * Returns the link detail when a node to link navigation occurs\n   */\n  function navigateFromNodeToLink(listOfLinks: D2[], event: KeyboardEvent, node?: D1) {\n    if (!node) return undefined;\n    const adjLinks = getNavigableLinksForNodeId(node.id, listOfLinks);\n    if (adjLinks.length < 1) return undefined;\n    let link = adjLinks[0];\n    const nodeBB = nodeBoundsById.get(node.id)!;\n    let object, currNode, currNodeBB, currNodeBBCenterX;\n    const nodeCenterX = nodeBB.x + nodeBB.width / 2;\n    currentKeyboardFocusNode.current = node.id;\n    for (let i = 0; i < adjLinks.length; i++) {\n      object = adjLinks[i];\n      currNode = object.startNode === node.id ? object.endNode : object.startNode;\n      currNodeBB = nodeBoundsById.get(currNode);\n      currNodeBBCenterX = currNodeBB!.x + currNodeBB!.width / 2;\n      if (\n        // equivalent of ≤ and ≥\n        (event.altKey && event.code === 'Comma' && currNodeBBCenterX <= nodeCenterX) ||\n        (event.altKey && event.code === 'Period' && currNodeBBCenterX >= nodeCenterX)\n      ) {\n        link = object;\n        break;\n      }\n    }\n    return { id: link.id, type: 'link' };\n  }\n\n  /**\n   * Returns the node detail when a link to node navigation occurs\n   */\n  function navigateFromLinkToNode(linkId: K2, event: KeyboardEvent) {\n    const key = event.key;\n    const linkData = linkIdToDataMap.get(linkId)!;\n    const startNodeBB = nodeBoundsById.get(linkData.startNode);\n    const endNodeBB = nodeBoundsById.get(linkData.endNode);\n    if (!startNodeBB || !endNodeBB) return undefined;\n    const startNodeCenterX = startNodeBB.x + startNodeBB.width / 2;\n    const endNodeCenterX = endNodeBB.x + endNodeBB.width / 2;\n    const newNode =\n      (endNodeCenterX > startNodeCenterX && key === 'ArrowRight') ||\n      (endNodeCenterX < startNodeCenterX && key === 'ArrowLeft')\n        ? linkData.endNode\n        : linkData.startNode;\n    return { id: newNode, type: 'node' };\n  }\n\n  return {\n    isNode: (itemInfo: ItemInfo<K1, K2>): boolean => {\n      let node, link;\n      for (let i = 0; i < nodes.length; i++) {\n        node = nodes[i];\n        link = links[i];\n        if (itemInfo.id === node.id) {\n          return true;\n        }\n        if (itemInfo.id === link.id) {\n          return true;\n        }\n      }\n      return false;\n    },\n    getNextNavigableNode,\n    getNextNavigableLink,\n    navigateFromNodeToLink,\n    navigateFromLinkToNode\n  };\n}\n","import {\n  ItemInfo,\n  ItemHoverDetail,\n  ItemFocusDetail,\n  Bounds,\n  DiagramNodeData,\n  DiagramLinkData,\n  ExpandedItemDetail\n} from '../diagram.types';\nimport { useRef, useState } from 'preact/hooks';\nimport {\n  isEqualItem,\n  getNavigableInfo,\n  zoomAndCenterItemFromInfo,\n  changeExpanded,\n  expCollapseButtonId\n} from '../utils/diagramUtils';\nimport { getRandomId } from '#utils/PRIVATE_visLayoutUtils/layoutUtils';\nimport { getNodeDetailFromInfo, getLinkDetailFromInfo } from '../utils/navUtils';\nimport { useDiagramNavigation } from './useDiagramNavigation';\nimport type { NavDirection } from '../utils/navUtils';\nimport { useVisHover } from '#hooks/PRIVATE_useVisHover';\nimport { mergeProps } from '#utils/UNSAFE_mergeProps';\nimport { gestureTypes } from '#hooks/PRIVATE_useVisContextMenu';\n\nconst DEFAULT_KB_PAN = 15;\nconst DEFAULT_KB_ZOOM = 0.15;\n\nexport function useEvents<\n  K1,\n  K2,\n  D1 extends DiagramNodeData<K1, D1>,\n  D2 extends DiagramLinkData<K2, K1>\n>(\n  touchResponse: 'touchStart' | 'touchHold',\n  initNode: D1,\n  nodes: D1[],\n  links: D2[],\n  nodeBounds: Map<K1, Bounds>,\n  linkIdToDataMap: Map<K2, D2>,\n  nodeIdToDataMap: Map<K1, D1>,\n  promotedLinkIdToDataMap: Map<string, DiagramLinkData<string, K1>>,\n  width: number,\n  height: number,\n  maxZoom: number,\n  expanded: K1[],\n  itemIdToParentMap: Map<K1, K1>,\n  onItemHover?: (detail: ItemHoverDetail<K1, K2, D1, D2>) => void,\n  onItemFocus?: (detail: ItemFocusDetail<K1, K2, D1, D2>) => void,\n  kbPanCallback?: (props: {\n    dPan?: { dx: number; dy: number };\n    nPan?: { cx: number; cy: number };\n    center?: boolean;\n  }) => void,\n  kbZoomCallback?: (props: { dZoom?: number; nZoom?: number }) => void,\n  onExpandedChange?: (detail: ExpandedItemDetail<K1>) => void\n) {\n  const {\n    getNextNavigableNode,\n    getNextNavigableLink,\n    navigateFromNodeToLink,\n    navigateFromLinkToNode\n  } = useDiagramNavigation<K1, K2, D1, D2>(nodes, links, nodeBounds, linkIdToDataMap);\n  const [focusedItemInfo, setfocusedItemInfo] = useState<ItemInfo<K1, K2>>({\n    id: initNode.id,\n    type: 'node'\n  });\n  const [hoveredItemInfo, sethoveredItemInfo] = useState<ItemInfo<K1, K2>>();\n  const activeId = useRef<string>();\n\n  const cancelEvent = (event: Event) => {\n    event.preventDefault();\n    event.stopPropagation();\n  };\n\n  const keyDownHandler = (event: KeyboardEvent) => {\n    const key = event.key;\n    let eventConsumed = false;\n    // tabbing out of the diagram\n    if (key === 'TAB') {\n      return;\n    }\n    // if this a switch from node to link or vice versa\n    if (isChangeItemType(event)) {\n      const nextItemInfo = (\n        focusedItemInfo.type === 'node'\n          ? navigateFromNodeToLink(links, event, getNodeDetailFromInfo(focusedItemInfo, nodes))\n          : navigateFromLinkToNode(focusedItemInfo.id as K2, event)\n      ) as ItemInfo<K1, K2>;\n      handleKeyboardInput(nextItemInfo);\n      eventConsumed = true;\n    } else if (isNavigationEvent(key)) {\n      const nextItemInfo = handleKeyboardNavigationEvent(key) as ItemInfo<K1, K2>;\n      handleKeyboardInput(nextItemInfo);\n      eventConsumed = true;\n    } else {\n      switch (key) {\n        case 'PageUp': {\n          kbPanCallback &&\n            kbPanCallback({\n              dPan: {\n                dx: event.shiftKey ? -DEFAULT_KB_PAN : 0,\n                dy: event.shiftKey ? 0 : -DEFAULT_KB_PAN\n              }\n            });\n          eventConsumed = true;\n          break;\n        }\n        case 'PageDown': {\n          kbPanCallback &&\n            kbPanCallback({\n              dPan: {\n                dx: event.shiftKey ? DEFAULT_KB_PAN : 0,\n                dy: event.shiftKey ? 0 : DEFAULT_KB_PAN\n              }\n            });\n          eventConsumed = true;\n          eventConsumed = true;\n          break;\n        }\n        case '+':\n        case '=': {\n          kbZoomCallback && kbZoomCallback({ dZoom: DEFAULT_KB_ZOOM });\n          eventConsumed = true;\n          break;\n        }\n        case '-':\n        case '_': {\n          kbZoomCallback && kbZoomCallback({ dZoom: -DEFAULT_KB_ZOOM });\n          eventConsumed = true;\n          break;\n        }\n        case '0': {\n          if (event.ctrlKey && event.altKey) {\n            const { centerX, centerY, zoom } = zoomAndCenterItemFromInfo(\n              focusedItemInfo,\n              linkIdToDataMap,\n              nodeBounds,\n              width,\n              height,\n              maxZoom\n            );\n            kbZoomCallback && kbZoomCallback({ nZoom: zoom });\n            kbPanCallback && kbPanCallback({ nPan: { cx: centerX, cy: centerY } });\n          } else {\n            // zoom to fit\n            kbZoomCallback && kbZoomCallback({});\n            kbPanCallback && kbPanCallback({ center: true });\n          }\n          eventConsumed = true;\n          break;\n        }\n        case ' ': {\n          if (event.ctrlKey && event.shiftKey) {\n            if (focusedItemInfo.type === 'node') {\n              const id = focusedItemInfo.id as K1;\n              const newExpanded = changeExpanded(id, expanded);\n              const data: D1[] = [];\n              newExpanded.forEach((id) => {\n                data.push(nodeIdToDataMap.get(id)!);\n              });\n              onExpandedChange && onExpandedChange(newExpanded);\n            }\n          }\n          break;\n        }\n        case '[': {\n          if (focusedItemInfo.type === 'node') {\n            const child = getChildInfo(focusedItemInfo.id as K1);\n            if (child) {\n              const item = { id: child.id, type: 'node' } as ItemInfo<K1, K2>;\n              handleKeyboardInput(item);\n            }\n          }\n          eventConsumed = true;\n          break;\n        }\n        case ']': {\n          if (focusedItemInfo.type === 'node') {\n            const parentId = itemIdToParentMap.get(focusedItemInfo.id as K1);\n            if (parentId) {\n              const item = { id: parentId, type: 'node' } as ItemInfo<K1, K2>;\n              handleKeyboardInput(item);\n            }\n          }\n          eventConsumed = true;\n          break;\n        }\n      }\n    }\n    if (eventConsumed) {\n      cancelEvent(event);\n    }\n  };\n\n  const getChildInfo = (id: K1) => {\n    const children = nodeIdToDataMap.get(id)?.children;\n    if (children && children.length > 0) {\n      return children[0];\n    }\n    return undefined;\n  };\n\n  const keyUpHandler = (event: KeyboardEvent) => {\n    const key = event.code;\n    switch (key) {\n      case 'Tab': {\n        updatefocusedItemInfo({\n          ...focusedItemInfo,\n          isCurrent: true,\n          isFocusVisible: true\n        });\n        break;\n      }\n    }\n  };\n\n  const blurHandler = () => {\n    if (hoveredItemInfo != null || focusedItemInfo.isCurrent) {\n      onItemFocus?.({ id: undefined, data: undefined });\n    }\n    const itemInfo = { ...focusedItemInfo, isCurrent: false, isFocusVisible: false };\n    setfocusedItemInfo(itemInfo);\n  };\n\n  const onHover = (event: PointerEvent) => {\n    const itemInfo = getNavigableInfo<K1, K2>(event.target as HTMLElement);\n    if (itemInfo && !isEqualItem(itemInfo, hoveredItemInfo)) {\n      sethoveredItemInfo({ ...itemInfo, isCurrent: true });\n      activeId.current = getRandomId();\n      setfocusedItemInfo({ ...focusedItemInfo, isCurrent: false });\n      if (itemInfo.type === 'node') {\n        onItemHover?.({\n          id: itemInfo.id,\n          type: 'node',\n          data: nodeIdToDataMap.get(itemInfo.id as K1)\n        });\n      } else if (itemInfo.type === 'link') {\n        onItemHover?.({\n          id: itemInfo.id,\n          type: 'link',\n          data: linkIdToDataMap.get(itemInfo.id as K2)\n        });\n      } else if (itemInfo.type === 'promotedLink') {\n        onItemHover?.({\n          id: itemInfo.id,\n          type: 'promotedLink',\n          data: promotedLinkIdToDataMap.get(itemInfo.id)\n        });\n      }\n    }\n  };\n\n  const onHoverLeave = () => {\n    sethoveredItemInfo(undefined);\n    activeId.current = undefined;\n    onItemHover?.({ id: undefined, data: undefined });\n  };\n\n  const hoverHandlers = useVisHover(onHover, undefined, onHoverLeave, touchResponse);\n\n  const pointerUpHandler = (event: PointerEvent) => {\n    const itemInfo = getNavigableInfo<K1, K2>(event.target as HTMLElement);\n    if (itemInfo.id != null) {\n      let buttonId;\n      if (itemInfo.type === 'node') {\n        buttonId = expCollapseButtonId<K1>(event.target as HTMLElement);\n        if (buttonId) {\n          console.log('button');\n          const newExpanded = changeExpanded(buttonId, expanded);\n          const data: D1[] = [];\n          newExpanded.forEach((id) => {\n            data.push(nodeIdToDataMap.get(id)!);\n          });\n          onExpandedChange && onExpandedChange(newExpanded);\n          console.log(newExpanded);\n          event.preventDefault();\n          event.stopPropagation();\n          return;\n        }\n      }\n      console.log(itemInfo);\n      console.log(event.target);\n      setfocusedItemInfo(itemInfo);\n      activeId.current = getRandomId();\n    }\n  };\n\n  function updatefocusedItemInfo(itemInfo: ItemInfo<K1, K2>) {\n    if (itemInfo.type === 'node') {\n      onItemFocus?.({\n        id: itemInfo.id as K1,\n        type: 'node',\n        data: nodeIdToDataMap.get(itemInfo.id)\n      });\n    } else if (itemInfo.type === 'link') {\n      onItemFocus?.({\n        id: itemInfo.id as K2,\n        type: 'link',\n        data: linkIdToDataMap.get(itemInfo.id)\n      });\n    } else if (itemInfo.type === 'promotedLink') {\n      onItemFocus?.({\n        id: itemInfo.id,\n        type: 'promotedLink',\n        data: promotedLinkIdToDataMap.get(itemInfo.id)\n      });\n    }\n    activeId.current = getRandomId();\n    setfocusedItemInfo(itemInfo);\n  }\n\n  function handleKeyboardInput(item?: ItemInfo<K1, K2>) {\n    if (!item) return;\n    if (!isEqualItem(item, focusedItemInfo)) {\n      item.isCurrent = true;\n      item.isFocusVisible = true;\n      if (hoveredItemInfo) {\n        sethoveredItemInfo({ ...hoveredItemInfo, isCurrent: false });\n      }\n      updatefocusedItemInfo(item);\n    }\n  }\n\n  function isNavigationEvent(key: string) {\n    switch (key) {\n      case 'ArrowDown':\n      case 'ArrowUp':\n      case 'ArrowRight':\n      case 'ArrowLeft': {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  function isChangeItemType(event: KeyboardEvent) {\n    const key = event.code;\n    // check if switching from node to link\n    // equivalent of ≤ and ≥\n    if (focusedItemInfo.type === 'node' && event.altKey && (key === 'Period' || key === 'Comma')) {\n      return true;\n      // check if switching from link to node\n    } else if (\n      !(focusedItemInfo.type === 'node') &&\n      (key === 'ArrowLeft' || key === 'ArrowRight')\n    ) {\n      return true;\n    }\n    return false;\n  }\n\n  function handleKeyboardNavigationEvent(key: string) {\n    let direction: NavDirection = 'down';\n    switch (key) {\n      case 'ArrowDown': {\n        direction = 'down';\n        break;\n      }\n      case 'ArrowUp': {\n        direction = 'up';\n        break;\n      }\n      case 'ArrowRight': {\n        direction = 'right';\n        break;\n      }\n      case 'ArrowLeft': {\n        direction = 'left';\n        break;\n      }\n    }\n    if (focusedItemInfo.type === 'node') {\n      const parent = itemIdToParentMap.get(focusedItemInfo.id as K1);\n      const navigableNodes =\n        parent && nodeIdToDataMap.get(parent) ? nodeIdToDataMap.get(parent)!.children! : nodes;\n      const itemDetail = getNextNavigableNode(\n        direction,\n        true,\n        nodeIdToDataMap.get(focusedItemInfo.id as K1),\n        navigableNodes\n      );\n      return itemDetail ? { id: itemDetail.id, type: 'node' } : focusedItemInfo;\n    } else {\n      const linkDetail = getLinkDetailFromInfo<K1, K2, D2>(focusedItemInfo, links);\n      const itemDetail = getNextNavigableLink(direction, nodes, linkDetail, links);\n      return itemDetail\n        ? { id: itemDetail.id, type: 'link' }\n        : { id: focusedItemInfo.id, type: 'link' };\n    }\n  }\n  const onContextMenuDismissed = (gesture: gestureTypes) => {\n    if (gesture === 'keyboard') {\n      updatefocusedItemInfo({\n        ...focusedItemInfo,\n        isFocusVisible: true,\n        isCurrent: true\n      });\n    }\n  };\n\n  return {\n    focusedItemInfo,\n    hoveredItemInfo,\n    activeId: activeId.current,\n    onContextMenuDismissed,\n    eventsProps: mergeProps(hoverHandlers, {\n      onKeyUp: keyUpHandler,\n      onKeyDown: keyDownHandler,\n      onBlur: blurHandler,\n      onPointerUp: pointerUpHandler\n    })\n  };\n}\n","/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\nimport type {\n  ItemInfo,\n  Bounds,\n  DatatipContext,\n  DiagramNodeData,\n  DiagramLinkData\n} from '../diagram.types';\nimport type { RefObject } from 'preact';\nimport { useDatatip } from '#hooks/PRIVATE_useDatatip';\nimport { calculateOffset } from '#utils/PRIVATE_visLayoutUtils/layoutUtils';\nimport type { Pan } from '../utils/panUtils';\nimport { useUser } from '#hooks/UNSAFE_useUser';\nimport { getDatatipContent } from '../utils/diagramUtils';\nimport { ComponentChildren } from 'preact';\nimport { Property } from 'csstype';\n\ntype props<K1, K2, D1, D2> = {\n  touchResponse: 'touchStart' | 'touchHold';\n  datatip?: (context: DatatipContext<D1, D2>) => {\n    content: ComponentChildren;\n    borderColor?: Property.BorderColor;\n  };\n  text?: string;\n  focusedItemInfo: ItemInfo<K1, K2>;\n  focusedItemBoundsRef: RefObject<Bounds | null>;\n  panState: Pan;\n  zoom: number;\n  width: number;\n  nodesMap: Map<K1, D1>;\n  linksMap: Map<K2, D2>;\n  hoveredItem?: ItemInfo<K1, K2>;\n};\n\n/**\n * Returns the datatip.\n * @param text The text string for the diagram item.\n * @param rootRef The ref for root of the diagram.\n * @param focusedItemBoundsRef The ref for focused item bounds.\n * @param focusedItemInfo The ItemInfo for focused item.\n * @returns\n */\nexport const useDiagramDatatip = <\n  K1,\n  K2,\n  D1 extends DiagramNodeData<K1, D1>,\n  D2 extends DiagramLinkData<K2, K1>\n>({\n  touchResponse,\n  datatip,\n  focusedItemBoundsRef,\n  focusedItemInfo,\n  panState,\n  zoom,\n  width,\n  nodesMap,\n  linksMap,\n  hoveredItem\n}: props<K1, K2, D1, D2>) => {\n  const { direction } = useUser();\n  const isRtl = direction === 'rtl';\n\n  const datatipC = getDatatipContent(nodesMap, linksMap, focusedItemInfo, hoveredItem, datatip);\n\n  const elementBounds = focusedItemBoundsRef.current\n    ? {\n        x: focusedItemBoundsRef.current.x * zoom + panState.panX,\n        y: focusedItemBoundsRef.current.y * zoom + panState.panY,\n        width: focusedItemBoundsRef.current.width * zoom,\n        height: focusedItemBoundsRef.current.height * zoom\n      }\n    : undefined;\n  const offset = focusedItemInfo.isCurrent\n    ? calculateOffset(isRtl, width, elementBounds)\n    : calculateOffset(isRtl, width);\n\n  const { datatipContent, datatipProps } = useDatatip({\n    content: datatipC?.content,\n    borderColor: datatipC?.borderColor,\n    placement: 'top-start',\n    offset,\n    anchor: focusedItemInfo?.isCurrent ? 'element' : 'pointer',\n    touchResponse\n  });\n  return { datatipContent: datatipContent, datatipProps: datatipProps };\n};\n","/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * Licensed under The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\nimport type { RefObject } from 'preact';\nimport { useRef } from 'preact/hooks';\n\ntype PointerGesture = {\n  pointers: PointerEvent[];\n};\n\ntype UsePointerGestureOptions = {\n  captureTargetRef: RefObject<HTMLDivElement>;\n  numPointers: number;\n  onPointerGestureDown?: (detail: PointerGesture) => void;\n  onPointerGestureMove?: (detail: PointerGesture) => void;\n  onPointerGestureEnd?: (detail: PointerGesture) => void;\n  onExtraneousPointerDown?: (detail: PointerGesture) => void;\n  isDisabled?: boolean;\n};\n\nconst usePointerGesture = ({\n  captureTargetRef,\n  numPointers = 1,\n  onPointerGestureDown,\n  onPointerGestureMove,\n  onPointerGestureEnd,\n  onExtraneousPointerDown,\n  isDisabled = false\n}: UsePointerGestureOptions) => {\n  const activePointers = useRef<PointerEvent[]>([]);\n\n  if (isDisabled) {\n    activePointers.current = [];\n  }\n\n  const onPointerDown = (e: PointerEvent) => {\n    activePointers.current.push(e);\n    if (activePointers.current.length === numPointers) {\n      onPointerGestureDown && onPointerGestureDown({ pointers: activePointers.current });\n    } else if (activePointers.current.length > numPointers) {\n      onExtraneousPointerDown && onExtraneousPointerDown({ pointers: activePointers.current });\n    }\n  };\n\n  const onPointerMove = (e: PointerEvent) => {\n    if (activePointers.current.length === 0) return;\n\n    const index = activePointers.current.findIndex(\n      (pointerEvent) => pointerEvent.pointerId === e.pointerId\n    );\n    if (index === -1) return;\n\n    activePointers.current[index] = e;\n    if (activePointers.current.length === numPointers) {\n      activePointers.current.forEach((e) =>\n        captureTargetRef.current!.setPointerCapture(e.pointerId)\n      );\n\n      onPointerGestureMove && onPointerGestureMove({ pointers: activePointers.current });\n    }\n  };\n\n  const onPointerUp = (e: PointerEvent) => {\n    const index = activePointers.current.findIndex(\n      (pointerEvent) => pointerEvent.pointerId === e.pointerId\n    );\n    if (index === -1) return;\n\n    activePointers.current[index] = e;\n    if (activePointers.current.length === numPointers) {\n      onPointerGestureEnd && onPointerGestureEnd({ pointers: activePointers.current });\n    }\n    activePointers.current.splice(index, 1);\n  };\n\n  const onPointerCancel = onPointerUp;\n  const onPointerLeave = onPointerUp;\n\n  return isDisabled\n    ? {}\n    : {\n        onPointerDown,\n        onPointerMove,\n        onPointerUp,\n        onPointerCancel,\n        onPointerLeave\n      };\n};\n\nexport { usePointerGesture };\n","/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * Licensed under The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\nimport type { RefObject } from 'preact';\nimport { useRef } from 'preact/hooks';\nimport { usePointerGesture } from './usePointerGesture';\n/**\n * Draggable region\n */\ntype DraggableRegion = {\n  xMin: number;\n  xMax: number;\n  yMin: number;\n  yMax: number;\n};\n\ntype DragDetail = {\n  x: number;\n  y: number;\n  dx: number;\n  dy: number;\n  regionOffsetX: number;\n  regionOffsetY: number;\n  originalEvent: PointerEvent;\n};\n\ntype UseDragOptions = {\n  captureTargetRef: RefObject<HTMLDivElement>;\n  draggableRegion?: DraggableRegion;\n  onDragStart?: (detail: Omit<DragDetail, 'dx' | 'dy'>) => void;\n  onDragMove?: (detail: DragDetail) => void;\n  onDragEnd?: (detail: DragDetail) => void;\n  isDisabled?: boolean;\n};\n/**\n * Whether point with coordinates are in the draggable region\n */\nconst inDraggableRegion = (x: number, y: number, region?: DraggableRegion) => {\n  if (!region) return true;\n  const { xMin, xMax, yMin, yMax } = region;\n  return x >= xMin && x <= xMax && y >= yMin && y <= yMax;\n};\n\n/**\n * Returns region offset\n */\nconst getRegionOffset = (x: number, y: number, region?: DraggableRegion) => {\n  if (!region) return { regionOffsetX: x, regionOffsetY: y };\n  return { regionOffsetX: x - region.xMin, regionOffsetY: y - region.yMin };\n};\n\nconst useDrag = ({\n  captureTargetRef,\n  draggableRegion,\n  onDragStart,\n  onDragMove,\n  onDragEnd,\n  isDisabled = false\n}: UseDragOptions) => {\n  const inactiveState = { isDragging: false, x0: -1, y0: -1, regionOffsetX: -1, regionOffsetY: -1 };\n  const dragState = useRef(inactiveState);\n\n  const handlePointerEvent = (e: PointerEvent, cb?: (detail: DragDetail) => void) => {\n    const { isDragging, x0, y0, regionOffsetX, regionOffsetY } = dragState.current;\n    if (!isDragging) return;\n    const x = e.pageX;\n    const y = e.pageY;\n    cb && cb({ x, y, dx: x - x0, dy: y - y0, regionOffsetX, regionOffsetY, originalEvent: e });\n  };\n\n  const dragProps = usePointerGesture({\n    captureTargetRef,\n    numPointers: 1, // Only allow 1 pointer dragging\n    onExtraneousPointerDown: () => {\n      dragState.current = inactiveState;\n    },\n    onPointerGestureDown: ({ pointers: [e] }) => {\n      const x = e.pageX;\n      const y = e.pageY;\n      if (e.button !== 0 || !inDraggableRegion(x, y, draggableRegion)) return;\n      const { regionOffsetX, regionOffsetY } = getRegionOffset(x, y, draggableRegion);\n      dragState.current = { isDragging: true, x0: x, y0: y, regionOffsetX, regionOffsetY };\n      onDragStart && onDragStart({ x, y, regionOffsetX, regionOffsetY, originalEvent: e });\n    },\n    onPointerGestureMove: ({ pointers: [e] }) => {\n      handlePointerEvent(e, onDragMove);\n    },\n    onPointerGestureEnd: ({ pointers: [e] }) => {\n      handlePointerEvent(e, onDragEnd);\n      dragState.current = inactiveState;\n    }\n  });\n\n  return isDisabled ? {} : dragProps;\n};\n\nexport { useDrag };\n","/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * Licensed under The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\nimport { Bounds, PanState } from '../diagram.types';\nimport { panXYToCenterXY } from './diagramUtils';\nexport type PanBounds = {\n  minX: number;\n  minY: number;\n  maxX: number;\n  maxY: number;\n};\n\n/**\n * The pan values that describes where the diagram content\n * is panned\n */\nexport type Pan = {\n  panX: number;\n  panY: number;\n};\n\nconst constrainPan = (\n  previousPan: Pan,\n  nextPan: Pan,\n  panBounds: PanBounds,\n  panDirection: 'x' | 'y' | 'any'\n) => {\n  const panX = panDirection !== 'y' ? nextPan.panX : previousPan.panX;\n  const panY = panDirection !== 'x' ? nextPan.panY : previousPan.panY;\n  return {\n    panX: panX > panBounds.maxX ? panBounds.maxX : panX < panBounds.minX ? panBounds.minX : panX,\n    panY: panY > panBounds.maxY ? panBounds.maxY : panY < panBounds.minY ? panBounds.minY : panY\n  };\n};\n\nexport const pan = (\n  previousPan: Pan,\n  nextPan: Pan,\n  panDirection: 'x' | 'y' | 'any',\n  zoom: number,\n  width: number,\n  height: number,\n  panBounds?: PanBounds,\n  onPanChange?: (detail: PanState) => void\n) => {\n  if (!panBounds) {\n    //On initial render before nodes are rendered\n    return { newPan: { panX: 0, panY: 0 } };\n  }\n  const newPan = constrainPan(previousPan, nextPan, panBounds, panDirection);\n  const isPanChanged = newPan.panX !== previousPan.panX || newPan.panY !== previousPan.panY;\n  const center = panXYToCenterXY(newPan.panX, newPan.panY, zoom, width, height);\n  isPanChanged &&\n    onPanChange &&\n    onPanChange({\n      centerX: center.centerX,\n      centerY: center.centerY\n    });\n  return { newPan };\n};\n\nexport const getPanBounds = (\n  dWidth: number,\n  dHeight: number,\n  elemBounds: Bounds,\n  zoom: number,\n  minZoom: number,\n  initPanZoomState: {\n    zoom: number;\n    centerX?: number;\n    centerY?: number;\n  },\n  panType?: string\n): PanBounds => {\n  const { x, y, width, height } = elemBounds;\n  let minX, maxX, minY, maxY;\n  if (panType === 'centerContent') {\n    minX = dWidth / 2 - (width + x) * zoom;\n    minY = dHeight / 2 - (height + y) * zoom;\n    maxX = dWidth / 2 - x * zoom;\n    maxY = dHeight / 2 - y * zoom;\n  } else {\n    // panType equals fixed\n    const zoomRatio = zoom / minZoom;\n    // Find left corner of the content at min zoom and content is centered\n    const minZoomX = (dWidth - width * minZoom) / 2 - x * minZoom;\n    const minZoomY = (dHeight - height * minZoom) / 2 - y * minZoom;\n    // When we pan all the way to the right, the left corner of displayable area is 0,0 as in min zoom.\n    // When we pan all the way to the left, lets find the corner of the displayable area\n    const leftCornerX = dWidth - dWidth * zoomRatio;\n    const leftCornerY = dHeight - dHeight * zoomRatio;\n    // Now we have everything to calculate pan zoom constraints\n    minX = leftCornerX + minZoomX * zoomRatio;\n    minY = leftCornerY + minZoomY * zoomRatio;\n    maxX = minZoomX * zoomRatio;\n    maxY = minZoomY * zoomRatio;\n  }\n  const initZoom = initPanZoomState.zoom;\n  const initCenterX = initPanZoomState.centerX;\n  const initCenterY = initPanZoomState.centerY;\n  // If an initial panZoomState is set, should expand pan bounds to include it\n  let dx, dy;\n  if (initCenterX) {\n    const boundsX = initCenterX * initZoom - dWidth / 2;\n    if (-boundsX * initZoom < minX) {\n      dx = minX - boundsX * initZoom;\n      minX -= dx;\n      maxX += dx;\n    } else if (-boundsX * initZoom > maxX) {\n      dx = -boundsX * initZoom - maxX;\n      minX -= dx;\n      maxX += dx;\n    }\n  }\n  if (initCenterY) {\n    const boundsY = initCenterY * initZoom - dHeight / 2;\n    if (-boundsY * initZoom < minY) {\n      dy = minY - boundsY * initZoom;\n      minY -= dy;\n      maxY += dy;\n    } else if (-boundsY * initZoom > maxY) {\n      dy = -boundsY * initZoom - maxY;\n      minY -= dy;\n      maxY += dy;\n    }\n  }\n  return {\n    minX: minX,\n    maxX: maxX,\n    minY: minY,\n    maxY: maxY\n  };\n};\n","/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * Licensed under The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\nimport type { PanState } from '../diagram.types';\nimport type { RefObject } from 'preact';\nimport { useRef } from 'preact/hooks';\nimport { useDrag } from './useDrag';\nimport { PanBounds, pan } from '../utils/panUtils';\nimport { centerXYToPanXY } from '../utils/diagramUtils';\n/**\n * Options for useDragPan hook\n */\ntype UseDragPanOptions = {\n  panProps: {\n    centerX: number;\n    centerY: number;\n    panDirection: 'x' | 'y' | 'any';\n    onPan?: (detail: PanState) => void;\n    panning?: 'centerContent' | 'fixed' | 'off';\n  };\n  captureTargetRef: RefObject<HTMLDivElement>;\n  panBounds?: PanBounds;\n  onDragPanStart?: () => void;\n  onDragPanEnd?: () => void;\n  zoom: number;\n  width: number;\n  height: number;\n};\n\nconst useDragPan = ({\n  panProps,\n  captureTargetRef,\n  panBounds,\n  width,\n  height,\n  zoom,\n  onDragPanStart,\n  onDragPanEnd\n}: UseDragPanOptions) => {\n  const prevPanState = useRef({ panX: 0, panY: 0 });\n  const initialPanState = useRef({ panX: 0, panY: 0 });\n  const dragProps = useDrag({\n    captureTargetRef,\n    onDragStart: () => {\n      const panValues = centerXYToPanXY(panProps.centerX, panProps.centerY, zoom, width, height);\n      initialPanState.current = {\n        panX: panValues.panX,\n        panY: panValues.panY\n      };\n      onDragPanStart && onDragPanStart();\n    },\n    onDragMove: ({ dx, dy }) => {\n      const nextPan = {\n        panX: initialPanState.current.panX + dx,\n        panY: initialPanState.current.panY + dy\n      };\n      const { newPan } = pan(\n        prevPanState.current,\n        nextPan,\n        panProps.panDirection,\n        zoom,\n        width,\n        height,\n        panBounds,\n        panProps.onPan\n      );\n      prevPanState.current = newPan;\n    },\n    onDragEnd: ({ originalEvent }) => {\n      // If panning occurred, call preventDefault to prevent selection from occurring\n      if (\n        initialPanState.current.panX !== prevPanState.current.panX ||\n        initialPanState.current.panY !== prevPanState.current.panY\n      )\n        originalEvent.preventDefault();\n      onDragPanEnd && onDragPanEnd();\n    },\n    isDisabled: panProps.panning === 'off'\n  });\n\n  return dragProps;\n};\n\nexport { useDragPan };\n","/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * Licensed under The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\ntype WheelDetail = {\n  x: number;\n  y: number;\n  deltaX: number;\n  deltaY: number;\n  ctrlKey: boolean;\n};\n\ntype UseWheelOptions = {\n  onWheel: (detail: WheelDetail) => void;\n  preventDefault?: boolean;\n  isDisabled?: boolean;\n};\n\nconst PX_FACTOR_PER_LINE = 15; // Value used in Toolkit\nconst PX_FACTOR_PER_PAGE = 40; // Value copied from datagrid; this is not handled in Toolkit\n\nconst getNormalizedDelta = (e: WheelEvent) => {\n  const { deltaX, deltaY, deltaMode } = e;\n\n  switch (deltaMode) {\n    case e.DOM_DELTA_PIXEL:\n      return { deltaX: -deltaX, deltaY: -deltaY };\n    case e.DOM_DELTA_LINE:\n      return { deltaX: -deltaX * PX_FACTOR_PER_LINE, deltaY: -deltaY * PX_FACTOR_PER_LINE };\n    case e.DOM_DELTA_PAGE:\n      return { deltaX: -deltaX * PX_FACTOR_PER_PAGE, deltaY: -deltaY * PX_FACTOR_PER_PAGE };\n    default:\n      return { deltaX: -deltaX, deltaY: -deltaY };\n  }\n};\n\nconst useWheel = ({\n  onWheel: onWheelCallback,\n  preventDefault = true,\n  isDisabled = false\n}: UseWheelOptions) => {\n  const onWheel = (e: WheelEvent) => {\n    const { deltaX, deltaY } = getNormalizedDelta(e);\n    if (preventDefault) e.preventDefault();\n    onWheelCallback({\n      x: e.offsetX,\n      y: e.offsetY,\n      deltaX,\n      deltaY,\n      ctrlKey: e.ctrlKey || e.metaKey\n    });\n  };\n  return isDisabled ? {} : { onWheel };\n};\n\nexport { useWheel, PX_FACTOR_PER_LINE };\n","/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * Licensed under The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\n\nexport const ZOOM_INCREMENT = 0.05;\n\nexport const zoom = (\n  nextZoom: number,\n  zoom: number,\n  minZoom: number,\n  maxZoom: number,\n  onZoomChange?: (detail: { zoomValue: number }) => void\n) => {\n  const newZoom = nextZoom > maxZoom || nextZoom < minZoom ? zoom : nextZoom;\n  const isZoomChanged = newZoom !== zoom;\n  isZoomChanged &&\n    onZoomChange &&\n    onZoomChange({\n      zoomValue: newZoom\n    });\n};\n","/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * Licensed under The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\nimport { useWheel } from './useWheel';\nimport { zoom, ZOOM_INCREMENT } from '../utils/zoomUtils';\n\ntype UseWheelZoomOptions = {\n  zooming: 'on' | 'off';\n  minZoom: number;\n  maxZoom: number;\n  zoomValue: number;\n  onZoom?: (detail: { zoomValue: number }) => void;\n};\n\nconst useWheelZoom = ({ zooming, minZoom, maxZoom, zoomValue, onZoom }: UseWheelZoomOptions) => {\n  const wheelProps = useWheel({\n    onWheel: ({ deltaY }) => {\n      const newZoom = zoomValue * (1 + ZOOM_INCREMENT * deltaY);\n      zoom(newZoom, zoomValue, minZoom, maxZoom, onZoom);\n    },\n    isDisabled: zooming === 'off'\n  });\n\n  return wheelProps;\n};\n\nexport { useWheelZoom };\n","/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * Licensed under The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\nimport type { RefObject } from 'preact';\nimport { useRef } from 'preact/hooks';\nimport { usePointerGesture } from './usePointerGesture';\n\ntype Point = { x: number; y: number };\n\nconst getMidpoint = (p1: Point, p2: Point) => ({ x: (p1.x + p2.x) / 2, y: (p1.y + p2.y) / 2 });\nconst getDistance = (p1: Point, p2: Point) => Math.sqrt((p2.x - p1.x) ** 2 + (p2.y - p2.y) ** 2);\n\ntype PinchDetail = {\n  origin: Point;\n  delta: number;\n};\n\ntype UsePinchOptions = {\n  captureTargetRef: RefObject<HTMLDivElement>;\n  onPinchZoomStart?: (detail: PinchDetail) => void;\n  onPinchZoomChange?: (detail: PinchDetail) => void;\n  onPinchZoomEnd?: () => void;\n  isDisabled?: boolean;\n};\n\nconst usePinch = ({\n  captureTargetRef,\n  onPinchZoomStart,\n  onPinchZoomChange,\n  onPinchZoomEnd,\n  isDisabled = false\n}: UsePinchOptions) => {\n  const origin = useRef({ x: -1, y: -1 });\n  const prevDistance = useRef(-1);\n  const reset = () => {\n    origin.current = { x: -1, y: -1 };\n    prevDistance.current = -1;\n  };\n\n  if (isDisabled) reset();\n\n  const pinchProps = usePointerGesture({\n    captureTargetRef,\n    numPointers: 2, // Pinch gesture requires 2 pointers\n    onPointerGestureDown: ({ pointers: [pointer1, pointer2] }) => {\n      const p1 = { x: pointer1.offsetX, y: pointer1.offsetY };\n      const p2 = { x: pointer2.offsetX, y: pointer2.offsetY };\n      origin.current = getMidpoint(p1, p2);\n      prevDistance.current = getDistance(p1, p2);\n      onPinchZoomStart &&\n        onPinchZoomStart({\n          origin: origin.current,\n          delta: 0\n        });\n    },\n    onPointerGestureMove: ({ pointers: [pointer1, pointer2] }) => {\n      const p1 = { x: pointer1.offsetX, y: pointer1.offsetY };\n      const p2 = { x: pointer2.offsetX, y: pointer2.offsetY };\n      const distance = getDistance(p1, p2);\n      const delta = distance - prevDistance.current;\n      prevDistance.current = distance;\n      onPinchZoomChange &&\n        onPinchZoomChange({\n          origin: origin.current,\n          delta\n        });\n    },\n    onPointerGestureEnd: () => {\n      reset();\n      onPinchZoomEnd && onPinchZoomEnd();\n    }\n  });\n\n  return isDisabled ? {} : pinchProps;\n};\n\nexport { usePinch };\n","/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * Licensed under The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\nimport type { RefObject } from 'preact';\nimport { usePinch } from './usePinch';\nimport { zoom, ZOOM_INCREMENT } from '../utils/zoomUtils';\n\ntype UsePinchZoomOptions = {\n  captureTargetRef: RefObject<HTMLDivElement>;\n  zooming: 'on' | 'off';\n  minZoom: number;\n  maxZoom: number;\n  zoomValue: number;\n  onZoom?: (detail: { zoomValue: number }) => void;\n};\n\nconst usePinchZoom = ({\n  captureTargetRef,\n  zooming,\n  minZoom,\n  maxZoom,\n  zoomValue,\n  onZoom\n}: UsePinchZoomOptions) => {\n  const pinchProps = usePinch({\n    captureTargetRef,\n    onPinchZoomChange: ({ delta }) => {\n      const newZoom = zoomValue * (1 + ZOOM_INCREMENT * delta);\n      zoom(newZoom, zoomValue, minZoom, maxZoom, onZoom);\n    },\n    isDisabled: zooming === 'off'\n  });\n\n  return pinchProps;\n};\n\nexport { usePinchZoom };\n","import { Pan, Zoom, Bounds } from '../diagram.types';\nimport type { RefObject } from 'preact';\nimport { useState, useRef } from 'preact/hooks';\nimport { useDragPan } from './useDragPan';\nimport { useWheelZoom } from './useWheelZoom';\nimport { usePinchZoom } from './usePinchZoom';\nimport {\n  centerXYToPanXY,\n  getPanProps,\n  getZoomProps,\n  getZoomToFitZoom\n} from '../utils/diagramUtils';\nimport { PanBounds, getPanBounds, pan } from '../utils/panUtils';\nimport { zoom } from '../utils/zoomUtils';\nimport { mergeProps } from '#utils/UNSAFE_mergeProps';\nimport { isTouch } from '#utils/UNSAFE_visUtils/clientUtils';\nimport { Property } from 'csstype';\nimport { useVisDragModeControls } from '#hooks/PRIVATE_useVisDragModeControls';\n\nexport type PanZoomProps = {\n  props: Pan & Zoom;\n  captureTargetRef: RefObject<HTMLDivElement>;\n  width: number;\n  height: number;\n  contentBounds: Bounds;\n  isRtl: boolean;\n};\n\nexport const usePanZoom = ({\n  props,\n  captureTargetRef,\n  width,\n  height,\n  contentBounds,\n  isRtl\n}: PanZoomProps) => {\n  const [cursor, setCursor] = useState<Property.Cursor>();\n  const zoomProps = getZoomProps(props, width, height, contentBounds);\n  const panBounds = useRef<PanBounds>();\n  const prevZoom = useRef<number>();\n  const panning = useRef<string>();\n  const initPanZoomState = useRef({\n    zoom: props.zoomValue || 0,\n    centerX: props.centerX,\n    centerY: props.centerY\n  });\n\n  const isDeviceTouch = isTouch();\n  const plotArea = {\n    width: width,\n    height: height,\n    x: 0,\n    y: 0\n  };\n\n  const showPanButton = isDeviceTouch ? props.panning && props.panning !== 'off' : undefined;\n  const dragModeOptions = {\n    isZoomScroll: true,\n    plotAreaSpace: plotArea,\n    componentWidth: width,\n    isRtl,\n    showPanButton: showPanButton ?? false,\n    showZoomButton: false,\n    showSelectButton: false,\n    isDisabled: !isDeviceTouch\n  };\n\n  const { toggleButtonContent, userDragMode } = useVisDragModeControls(dragModeOptions);\n  const panProps = getPanProps(props, contentBounds, userDragMode, isDeviceTouch);\n  if (\n    contentBounds.width !== Infinity &&\n    (zoomProps.zoomValue !== prevZoom.current || panProps.panning !== panning.current)\n  ) {\n    panBounds.current = getPanBounds(\n      width,\n      height,\n      contentBounds,\n      zoomProps.zoomValue,\n      zoomProps.minZoom,\n      initPanZoomState.current,\n      panProps.panning\n    );\n    prevZoom.current = zoomProps.zoomValue;\n    panning.current = panProps.panning;\n  }\n  const dragPanProps = useDragPan({\n    panProps: panProps,\n    captureTargetRef: captureTargetRef,\n    panBounds: panBounds.current,\n    zoom: zoomProps.zoomValue,\n    width,\n    height,\n    onDragPanStart: () => setCursor('grabbing'),\n    onDragPanEnd: () => setCursor('auto')\n  });\n  //dZoom or nZoom is required\n  const kbZoomCallback = (props: { dZoom?: number; nZoom?: number }) => {\n    const newZoom = props.dZoom\n      ? zoomProps.zoomValue + props.dZoom\n      : getZoomToFitZoom(width, height, contentBounds);\n    zoom(\n      props.nZoom ? props.nZoom : newZoom,\n      zoomProps.zoomValue,\n      zoomProps.minZoom,\n      zoomProps.maxZoom,\n      zoomProps.onZoom\n    );\n  };\n  const prevPanState = useRef({ panX: 0, panY: 0 });\n\n  // dPan or nPan is required\n  const kbPanCallback = (props: {\n    dPan?: { dx: number; dy: number };\n    nPan?: { cx: number; cy: number };\n    center?: boolean;\n  }) => {\n    let centerX;\n    let centerY;\n    if (props.center) {\n      centerX = contentBounds.x + contentBounds.width / 2;\n      centerY = contentBounds.y + contentBounds.height / 2;\n    } else if (props.dPan) {\n      centerX = panProps.centerX + props.dPan.dx;\n      centerY = panProps.centerY + props.dPan.dy;\n    } else {\n      centerX = props.nPan!.cx;\n      centerY = props.nPan!.cy;\n    }\n    const panValues = centerXYToPanXY(centerX, centerY, zoomProps.zoomValue, width, height);\n    const { newPan } = pan(\n      prevPanState.current,\n      panValues,\n      panProps.panDirection,\n      zoomProps.zoomValue,\n      width,\n      height,\n      panBounds.current,\n      panProps.onPan\n    );\n    prevPanState.current = newPan;\n  };\n  const wheelZoomProps = useWheelZoom(zoomProps);\n  const pinchZoomProps = usePinchZoom({\n    captureTargetRef,\n    zooming: zoomProps.zooming,\n    minZoom: zoomProps.minZoom,\n    maxZoom: zoomProps.maxZoom,\n    zoomValue: zoomProps.zoomValue,\n    onZoom: zoomProps.onZoom\n  });\n  const panZoomProps = mergeProps(dragPanProps, wheelZoomProps, pinchZoomProps);\n\n  return {\n    panZoomProps,\n    panProps,\n    zoomProps,\n    toggleButtonContent,\n    cursor,\n    centerX: panProps.centerX,\n    centerY: panProps.centerY,\n    zoomValue: zoomProps.zoomValue,\n    kbPanCallback: panProps.panning !== 'off' ? kbPanCallback : undefined,\n    kbZoomCallback: zoomProps.zooming !== 'off' ? kbZoomCallback : undefined\n  };\n};\n","import { useSelection } from '#hooks/PRIVATE_useVisSelection';\nimport type { DiagramLinkData, DiagramNodeData, ItemInfo } from '../diagram.types';\nimport { getNavigableInfo } from '../utils/diagramUtils';\nimport type { RefObject } from 'preact';\n\ntype SelectionProps<K1, K2, D1, D2> = {\n  selectedIds: {\n    nodes?: K1[];\n    links?: K2[];\n    promotedLinks?: string[];\n  };\n  selectionMode: 'none' | 'single' | 'multiple';\n  nodeMap: {\n    itemIdToDataMap: Map<K1, D1>;\n    itemIdToIndexMap: Map<K1, string>;\n    itemIndexToIdMap: Map<string, K1>;\n  };\n  linkMap: {\n    itemIdToDataMap: Map<K2, D2>;\n    itemIdToIndexMap: Map<K2, number>;\n    itemIndexToIdMap: Map<number, K2>;\n  };\n  promotedLinkMap: {\n    itemIdToDataMap: Map<string, DiagramLinkData<string, K1>>;\n    itemIdToIndexMap: Map<string, number>;\n    itemIndexToIdMap: Map<number, string>;\n  };\n  focusedItemInfo: ItemInfo<K1, K2>;\n  onSelectionChange?: (detail: {\n    nodes: K1[];\n    links: K2[];\n    promotedLinks: string[];\n    nodeData: (D1 | undefined)[];\n    linkData: (D2 | undefined)[];\n    promotedLinkData: (DiagramLinkData<string, K1> | undefined)[];\n  }) => void;\n  rootRef: RefObject<HTMLDivElement>;\n};\n\ntype EncodedNodeId = `N_${string}`;\ntype EncodedLinkId = `L_${number}`;\ntype EncodedPromotedLinkId = `P_${number}`;\n\nexport function useDiagramSelection<\n  K1,\n  K2,\n  D1 extends DiagramNodeData<K1, D1>,\n  D2 extends DiagramLinkData<K2, K1>\n>({\n  selectedIds,\n  selectionMode,\n  nodeMap,\n  linkMap,\n  promotedLinkMap,\n  focusedItemInfo,\n  onSelectionChange,\n  rootRef\n}: SelectionProps<K1, K2, D1, D2>) {\n  const nodeIdToIndexMap = nodeMap.itemIdToIndexMap;\n  const nodeIndexToIdMap = nodeMap.itemIndexToIdMap;\n  const nodeIdToDataMap = nodeMap.itemIdToDataMap;\n  const linkIdToIndexMap = linkMap.itemIdToIndexMap;\n  const linkIndexToIdMap = linkMap.itemIndexToIdMap;\n  const linkIdToDataMap = linkMap.itemIdToDataMap;\n  const promotedLinkIdToIndexMap = promotedLinkMap.itemIdToIndexMap;\n  const promotedLinkIndexToIdMap = promotedLinkMap.itemIndexToIdMap;\n  const promotedLinkIdToDataMap = promotedLinkMap.itemIdToDataMap;\n  const encodeNodeId = (id: K1) => `N_${nodeIdToIndexMap.get(id)}` as EncodedNodeId;\n  const decodeNodeId = (id: EncodedNodeId) => nodeIndexToIdMap.get(id.slice(2));\n  const encodeLinkId = (id: K2) => `L_${linkIdToIndexMap.get(id)}` as EncodedLinkId;\n  const decodeLinkId = (id: EncodedLinkId) => linkIndexToIdMap.get(Number(id.slice(2)));\n  const encodePromotedLinkId = (id: string) =>\n    `P_${promotedLinkIdToIndexMap.get(id)}` as EncodedPromotedLinkId;\n  const decodePromotedLinkId = (id: EncodedPromotedLinkId) =>\n    promotedLinkIndexToIdMap.get(Number(id.slice(2)));\n\n  const encodedNodesSelection = selectedIds.nodes ? selectedIds.nodes.map(encodeNodeId) : [];\n  const encodedLinksSelection = selectedIds.links ? selectedIds.links.map(encodeLinkId) : [];\n  const encodedPromotedLinksSelection = selectedIds.promotedLinks\n    ? selectedIds.promotedLinks.map(encodePromotedLinkId)\n    : [];\n  const encodedSelection = [\n    ...encodedNodesSelection,\n    ...encodedLinksSelection,\n    ...encodedPromotedLinksSelection\n  ];\n  const idExtracter = (event: Event) => {\n    // return encodeNodeId(id) or encodeLinkId(id) depending on node or link selection or undefined if clicked on empty space\n    const info =\n      event.type === 'keyup'\n        ? focusedItemInfo\n        : getNavigableInfo<K1, K2>(event.target as HTMLElement, rootRef);\n    return info.id !== undefined\n      ? info.type === 'node'\n        ? encodeNodeId(info.id as K1)\n        : info.type === 'link'\n        ? encodeLinkId(info.id as K2)\n        : encodePromotedLinkId(info.id as string)\n      : undefined;\n  };\n\n  const onEncodedSelectionChange = (detail: {\n    ids: (EncodedNodeId | EncodedLinkId | EncodedPromotedLinkId)[];\n  }) => {\n    const newNodeIds = detail.ids\n      .filter((encId) => encId[0] === 'N')\n      .map((encId) => decodeNodeId(encId as EncodedNodeId)!);\n    const newLinkIds = detail.ids\n      .filter((encId) => encId[0] === 'L')\n      .map((encId) => decodeLinkId(encId as EncodedLinkId)!);\n\n    const newPromotedLinkIds = detail.ids\n      .filter((encId) => encId[0] === 'P')\n      .map((encId) => decodePromotedLinkId(encId as EncodedPromotedLinkId)!);\n\n    const newSelectedNodeIds = newNodeIds.filter(\n      (id) => nodeIdToDataMap.get(id)?.selectable !== 'off'\n    );\n    const newSelectedLinkIds = newLinkIds.filter(\n      (id) => linkIdToDataMap.get(id)?.selectable !== 'off'\n    );\n\n    const nodeData = newSelectedNodeIds.map((selectedId) => {\n      return nodeIdToDataMap.get(selectedId);\n    });\n    const linkData = newSelectedLinkIds.map((selectedId) => {\n      return linkIdToDataMap.get(selectedId);\n    });\n\n    const promotedLinkData = newPromotedLinkIds.map((selectedId) => {\n      return promotedLinkIdToDataMap.get(selectedId);\n    });\n    return (\n      onSelectionChange &&\n      onSelectionChange({\n        nodes: newSelectedNodeIds,\n        links: newSelectedLinkIds,\n        promotedLinks: newPromotedLinkIds,\n        nodeData,\n        linkData,\n        promotedLinkData\n      })\n    );\n  };\n\n  const getDataById = (id: EncodedNodeId | EncodedLinkId | EncodedPromotedLinkId) => {\n    let data;\n    if (id[0] === 'N') {\n      const nodeId = decodeNodeId(id as EncodedNodeId)!;\n      data = nodeMap.itemIdToDataMap.get(nodeId);\n    } else if (id[0] === 'L') {\n      const linkId = decodeLinkId(id as EncodedLinkId)!;\n      data = linkMap.itemIdToDataMap.get(linkId);\n    } else if (id[0] === 'P') {\n      const linkId = decodePromotedLinkId(id as EncodedPromotedLinkId)!;\n      data = promotedLinkMap.itemIdToDataMap.get(linkId);\n    }\n    return data;\n  };\n\n  const { selectionContent, selectionProps } = useSelection<\n    `N_${string}` | `L_${number}` | `P_${number}`,\n    D1 | D2 | DiagramLinkData<string, K1>\n  >({\n    selection: encodedSelection,\n    idExtracter,\n    selectionMode,\n    getDataById,\n    onChange: onEncodedSelectionChange\n  });\n\n  return { selectionContent, selectionProps };\n}\n","/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * Licensed under The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\n\nimport type { DiagramContextMenuContext } from '../diagram.types';\n\nexport function getDiagramContextMenuContext<K1, K2, D1, D2>(\n  nodesMap: Map<K1, D1>,\n  linksMap: Map<K2, D2>,\n  type: 'node' | 'link' | 'background',\n  idx?: K1 | K2 | string\n) {\n  let context: DiagramContextMenuContext<D1, D2>;\n\n  if (type === 'node') {\n    context = {\n      data: nodesMap.get(idx as K1)!,\n      type\n    };\n  } else if (type === 'link') {\n    context = {\n      data: linksMap.get(idx as K2)!,\n      type\n    };\n  } else {\n    context = {\n      type: 'background'\n    };\n  }\n\n  return {\n    context: context as DiagramContextMenuContext<D1, D2>\n  };\n}\n","/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * Licensed under The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\n\nimport type { RefObject } from 'preact';\nimport type {\n  DiagramContextMenuConfig,\n  DiagramContextMenuContext,\n  ItemInfo\n} from '../diagram.types';\nimport { type gestureTypes, useContextMenu } from '#hooks/PRIVATE_useVisContextMenu';\nimport { getDiagramContextMenuContext } from '../utils/contextMenuUtils';\n\ntype Props<K1, K2, D1, D2> = {\n  nodesMap: Map<K1, D1>;\n  linksMap: Map<K2, D2>;\n  focusedItemInfo: ItemInfo<K1, K2>;\n  rootRef: RefObject<HTMLDivElement>;\n  contextMenuConfig?: DiagramContextMenuConfig<D1, D2>;\n  onContextMenuDismissed?: (gesture: gestureTypes) => void;\n};\n\nexport const useDiagramContextMenu = <K1, K2, D1, D2>({\n  focusedItemInfo,\n  rootRef,\n  contextMenuConfig,\n  onContextMenuDismissed,\n  nodesMap,\n  linksMap\n}: Props<K1, K2, D1, D2>) => {\n  const { contextMenuProps, contextMenuContent } = useContextMenu<\n    DiagramContextMenuContext<D1, D2>\n  >({\n    onContextMenuHandler: ({ gesture, target }) => {\n      let idx;\n      let elementType: 'node' | 'link' | 'background' = 'background';\n      const currentTarget = target as HTMLElement;\n      if (gesture === 'keyboard') {\n        idx = focusedItemInfo.id;\n        if (focusedItemInfo.type === 'node') {\n          elementType = 'node';\n        } else if (idx !== undefined) {\n          elementType = 'link';\n        }\n      } else if (\n        (currentTarget.closest('[data-oj-private-node]') as HTMLElement)?.dataset['ojPrivateNode']\n      ) {\n        idx = (currentTarget.closest('[data-oj-private-node]') as HTMLElement)?.dataset[\n          'ojPrivateNode'\n        ] as K1;\n        elementType = 'node';\n      } else if (\n        (currentTarget.closest('[data-oj-private-link]') as SVGElement)?.dataset[\n          'ojPrivateLink'\n        ] as K2\n      ) {\n        idx = (currentTarget.closest('[data-oj-private-link]') as SVGElement)?.dataset[\n          'ojPrivateLink'\n        ] as K2;\n        elementType = 'link';\n      }\n\n      const { context } = getDiagramContextMenuContext<K1, K2, D1, D2>(\n        nodesMap,\n        linksMap,\n        elementType,\n        idx\n      );\n      if (gesture === 'keyboard') {\n        let element;\n        if (focusedItemInfo.type === 'node') {\n          element = rootRef.current?.querySelector(`[data-oj-private-node=\"${idx}\"]`);\n        } else {\n          element = rootRef.current?.querySelector(`[data-oj-private-link=\"${idx}\"]`);\n        }\n        return {\n          type: 'element',\n          context,\n          elem: element ? element : null\n        };\n      }\n      return { type: 'pointer', context };\n    },\n    contextMenuOptions: {\n      isDisabled: !contextMenuConfig //If there is not a context menu renderer we disable the hook\n    },\n    rootRef,\n    contextMenuConfig,\n    onContextMenuDismissed\n  });\n\n  return { contextMenuContent, contextMenuProps };\n};\n","/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\nimport type {\n  DiagramProps,\n  Bounds,\n  DiagramLabelPosition,\n  States,\n  DiagramNodeData,\n  DiagramLinkData,\n  DiagramLayoutOutput,\n  Dimensions\n} from './diagram.types';\nimport type { TextDimensions } from '#hooks/PRIVATE_useTextDimensions';\nimport { DiagramLayers } from './DiagramLayers';\nimport { DiagramPanZoomContainer } from './DiagramPanZoomContainer';\nimport { useEvents } from './hooks/useEvents';\nimport { useDiagramDatatip } from './hooks/useDiagramDatatip';\nimport { useTextDimensions } from '#hooks/PRIVATE_useTextDimensions';\nimport { usePanZoom } from './hooks/usePanZoom';\nimport { useRef, useState } from 'preact/hooks';\nimport { useUser } from '#hooks/UNSAFE_useUser';\nimport { useDiagramSelection } from './hooks/useDiagramSelection';\nimport { mergeProps } from '#utils/UNSAFE_mergeProps';\nimport {\n  constructLayoutJSON,\n  deconstructLayoutJSON,\n  getFocusedItemBounds,\n  mergeDimensions,\n  isEqualBounds,\n  getDimensionsFromBounds,\n  // combineIds,\n  getContentBounds,\n  centerXYToPanXY,\n  filterLinksWithNoEndNodes,\n  getAllLabelBounds,\n  isEqualLabelBounds,\n  createLinksMap,\n  createNodesMap,\n  getPromotedLinks,\n  createPromotedLinksMap\n} from './utils/diagramUtils';\nimport { outerStyles } from './themes/DiagramStyles.css';\nimport { useVisTouchResponse } from '#hooks/PRIVATE_useVisTouchResponse';\nimport { merge } from '@oracle/oraclejet-internal-utilities/stringUtils';\nimport { useDiagramContextMenu } from './hooks/useDiagramContextMenu';\n\ntype DiagramWithDimensionsProps<\n  K1 extends string | number,\n  K2 extends string | number,\n  D1,\n  D2,\n  L\n> = Omit<DiagramProps<K1, K2, D1, D2, L>, 'width' | 'height'> & {\n  width: number;\n  height: number;\n};\n\nexport function ContainerDiagramWithDimensions<\n  K1 extends string | number,\n  K2 extends string | number,\n  D1 extends DiagramNodeData<K1, D1>,\n  D2 extends DiagramLinkData<K2, K1>,\n  L extends DiagramLayoutOutput<K1, K2>\n>({\n  nodes = [],\n  links = [],\n  width,\n  height,\n  selectedIds = {},\n  selectionMode = 'none',\n  layout,\n  nodeRenderer,\n  linkRenderer,\n  onSelectionChange,\n  onItemHover,\n  onItemFocus,\n  highlightedIds = {},\n  datatip,\n  expanded = [],\n  onExpandedChange,\n  contextMenuConfig,\n  ...otherProps\n}: DiagramWithDimensionsProps<K1, K2, D1, D2, L>) {\n  const focusedItemBoundsRef = useRef<Bounds | null>(null);\n  const rootRef = useRef<HTMLDivElement>(null);\n  //TODO JET-62563 change bounds to a MAP\n  const [bounds, setBounds] = useState<Map<K1, Bounds>>(new Map());\n  const linkDimensions = useRef<Map<K2, Dimensions>>(new Map());\n  const promotedLinkDimensions = useRef<Map<string, Dimensions>>(new Map());\n  const [combinedLabelBounds, setCombinedLabelBounds] = useState<Bounds>();\n  const { direction } = useUser();\n  const isRtl = direction === 'rtl';\n\n  const diagramNodes = nodes;\n  const nodeMap = createNodesMap<K1, D1>(diagramNodes);\n  const nodeIdToParentMap = nodeMap.itemIdToParentMap;\n  const nodeIdToDataMap = nodeMap.itemIdToDataMap;\n  const diagramLinks = filterLinksWithNoEndNodes(links, nodeIdToDataMap);\n  const linkMap = createLinksMap<K1, K2, D2>(diagramLinks);\n  const linkIdToDataMap = linkMap.itemIdToDataMap;\n  const resizeThrottling = useRef<boolean>(false);\n  const newDimensions = getDimensionsFromBounds(bounds);\n  const { textMeasureContent, getTextDimensions } = useTextDimensions();\n  const labelDimensions = useRef<Map<K1 | K2, TextDimensions>>(new Map());\n  const linkDimsChanged = useRef<boolean>(false);\n  const nodeLabelPosRef = useRef<Map<K1, DiagramLabelPosition>>(new Map());\n  const linkLabelPosRef = useRef<Map<K2, DiagramLabelPosition>>(new Map());\n  const [layoutOutput, setLayoutOutput] = useState<L>();\n  const nodeBoundsRef = useRef<Map<K1, Bounds>>(new Map());\n  const {\n    promotedLinks,\n    //linkToPromotedMap,\n    promotedToLinkMap\n  } = getPromotedLinks<K1, K2, D2>(nodeIdToParentMap, links, expanded);\n  const promotedLinkMap = createPromotedLinksMap<K1>(promotedLinks);\n\n  const contentBounds = getContentBounds(bounds, combinedLabelBounds);\n  const {\n    panZoomProps,\n    panProps,\n    zoomProps,\n    toggleButtonContent,\n    cursor,\n    centerX,\n    centerY,\n    zoomValue,\n    kbPanCallback,\n    kbZoomCallback\n  } = usePanZoom({\n    props: otherProps,\n    captureTargetRef: rootRef,\n    width: width,\n    height: height,\n    contentBounds,\n    isRtl\n  });\n\n  const { touchResponse, touchResponseStyle } = useVisTouchResponse({\n    type: 'auto',\n    supportsTouchDragGestures: zoomProps.zooming === 'on' || panProps.panning !== 'off',\n    rootRef\n  });\n\n  const { onContextMenuDismissed, focusedItemInfo, hoveredItemInfo, activeId, eventsProps } =\n    useEvents<K1, K2, D1, D2>(\n      touchResponse,\n      diagramNodes[0],\n      diagramNodes,\n      diagramLinks,\n      bounds,\n      linkIdToDataMap,\n      nodeIdToDataMap,\n      promotedLinkMap.itemIdToDataMap,\n      width,\n      height,\n      otherProps.maxZoom || 1,\n      expanded,\n      nodeIdToParentMap,\n      onItemHover,\n      onItemFocus,\n      kbPanCallback,\n      kbZoomCallback,\n      onExpandedChange\n    );\n\n  const { selectionProps, selectionContent } = useDiagramSelection<K1, K2, D1, D2>({\n    selectedIds,\n    selectionMode,\n    nodeMap,\n    linkMap,\n    promotedLinkMap,\n    focusedItemInfo,\n    onSelectionChange,\n    rootRef\n  });\n\n  // This is for the datatip kb position\n  if (focusedItemInfo && bounds.size > 0) {\n    focusedItemBoundsRef.current = getFocusedItemBounds(\n      focusedItemInfo,\n      bounds,\n      diagramLinks,\n      linkMap.itemIdToIndexMap,\n      rootRef\n    );\n  }\n\n  const {\n    datatipContent,\n    datatipProps: { 'aria-describedby': datatipAriaDescribedby, ...datatipProps }\n  } = useDiagramDatatip({\n    touchResponse,\n    datatip,\n    focusedItemInfo,\n    focusedItemBoundsRef,\n    panState: centerXYToPanXY(centerX, centerY, zoomValue, width, height),\n    zoom: zoomValue,\n    width: width,\n    nodesMap: nodeIdToDataMap,\n    linksMap: linkIdToDataMap,\n    hoveredItem: hoveredItemInfo\n  });\n\n  const [visibility, setVisibility] = useState<'visible' | 'hidden'>('hidden');\n  const style = {\n    width: width,\n    height: height,\n    cursor: cursor,\n    visibility: visibility,\n    ...touchResponseStyle\n  };\n\n  const states = useRef<States<K1, K2>>();\n  const previousState = states.current // states.current is previous state\n    ? states.current\n    : {\n        selectedNodeIds: [],\n        selectedLinkIds: [],\n        selectedPromotedLinkIds: [],\n        focusedId: undefined,\n        hoveredId: undefined,\n        activeId: undefined,\n        highlightedNodeIds: [],\n        highlightedLinkIds: [],\n        highlightedPromotedLinkIds: [],\n        zoom: 0,\n        expanded: []\n      };\n\n  states.current = {\n    // update states to new state\n    selectedNodeIds: selectedIds.nodes ?? [],\n    selectedLinkIds: selectedIds.links ?? [],\n    selectedPromotedLinkIds: selectedIds.promotedLinks ?? [],\n    focusedId:\n      focusedItemInfo.isCurrent && focusedItemInfo.isFocusVisible ? focusedItemInfo.id : undefined,\n    hoveredId: hoveredItemInfo?.isCurrent ? hoveredItemInfo.id : undefined,\n    activeId,\n    highlightedNodeIds: highlightedIds.nodes ?? [],\n    highlightedLinkIds: highlightedIds.links ?? [],\n    highlightedPromotedLinkIds: highlightedIds.promotedLinks ?? [],\n    zoom: zoomValue,\n    expanded: expanded || []\n  };\n\n  const { contextMenuContent, contextMenuProps } = useDiagramContextMenu<K1, K2, D1, D2>({\n    focusedItemInfo,\n    rootRef,\n    contextMenuConfig: nodes.length > 0 ? contextMenuConfig : undefined,\n    onContextMenuDismissed,\n    nodesMap: nodeIdToDataMap,\n    linksMap: linkIdToDataMap\n  });\n\n  const mergedEventProps = mergeProps(\n    panZoomProps,\n    eventsProps,\n    selectionProps,\n    datatipProps,\n    contextMenuProps\n  );\n\n  // Called anytime node changes size\n  const onNodeSizeChanged = (nodeWidth: number, nodeHeight: number, id: K1) => {\n    newDimensions.set(id, { width: nodeWidth, height: nodeHeight });\n    if (resizeThrottling.current) {\n      return;\n    }\n\n    resizeThrottling.current = true;\n    // performs layout at the next available animation frame when all measurements should be ready\n    window.requestAnimationFrame(() => {\n      const { labelDims, layoutJSON } = constructLayoutJSON<K1, K2, D1, D2>(\n        nodeIdToDataMap,\n        linkIdToDataMap,\n        promotedLinks,\n        newDimensions,\n        width,\n        height,\n        bounds,\n        zoomValue,\n        nodeIdToParentMap,\n        nodeBoundsRef.current,\n        rootRef,\n        getTextDimensions\n      );\n      labelDimensions.current = labelDims;\n      const layoutOutput = layout(layoutJSON);\n      const { nodePoints, nodeLabelPos, linkLabelPos } = deconstructLayoutJSON<K1, K2, D1, D2>(\n        layoutOutput,\n        diagramNodes,\n        diagramLinks\n      );\n      nodeLabelPosRef.current = nodeLabelPos;\n      linkLabelPosRef.current = linkLabelPos;\n      const nodeBounds = mergeDimensions(newDimensions, nodePoints);\n      const labelBounds = getAllLabelBounds(labelDims, nodeLabelPos, direction === 'rtl');\n      const equalBounds = isEqualBounds(nodeBounds, bounds);\n      if (\n        !equalBounds ||\n        linkDimsChanged.current ||\n        (combinedLabelBounds &&\n          labelBounds &&\n          !isEqualLabelBounds(combinedLabelBounds, labelBounds))\n      ) {\n        setBounds(nodeBounds);\n        setCombinedLabelBounds(labelBounds);\n        setLayoutOutput(layoutOutput);\n        linkDimsChanged.current = false;\n        setVisibility('hidden');\n      } else if (visibility == 'hidden') {\n        setVisibility('visible');\n      }\n      resizeThrottling.current = false;\n    });\n  };\n\n  const onLinkSizeChanged = (linkWidth: number, linkHeight: number, id: K2) => {\n    const linkDims = linkDimensions.current.get(id);\n    if (\n      !linkDims ||\n      (linkDims &&\n        (Math.abs(linkWidth - linkDims.width) > 0.5 ||\n          Math.abs(linkHeight - linkDims.height) > 0.5))\n    ) {\n      linkDimensions.current.set(id, { width: linkWidth, height: linkHeight });\n      linkDimsChanged.current = true;\n    }\n  };\n\n  const onPromotedLinkSizeChanged = (linkWidth: number, linkHeight: number, id: string) => {\n    const linkDims = promotedLinkDimensions.current.get(id);\n    if (\n      !linkDims ||\n      (linkDims &&\n        (Math.abs(linkWidth - linkDims.width) > 0.5 ||\n          Math.abs(linkHeight - linkDims.height) > 0.5))\n    ) {\n      promotedLinkDimensions.current.set(id, { width: linkWidth, height: linkHeight });\n      linkDimsChanged.current = true;\n    }\n  };\n\n  return (\n    <div\n      ref={rootRef}\n      class={outerStyles}\n      {...mergedEventProps}\n      style={style}\n      tabIndex={0}\n      role=\"application\"\n      aria-label={otherProps['aria-label']}\n      aria-labelledby={otherProps['aria-labelledby']}\n      aria-describedby={merge([otherProps['aria-describedby'], datatipAriaDescribedby])}\n      aria-activedescendant={activeId}>\n      {getTextDimensions ? (\n        <DiagramPanZoomContainer\n          centerX={centerX}\n          centerY={centerY}\n          zoom={zoomValue}\n          width={width}\n          height={height}>\n          <DiagramLayers\n            nodes={diagramNodes}\n            links={diagramLinks}\n            zoom={zoomValue}\n            nodeRenderer={nodeRenderer}\n            linkRenderer={linkRenderer}\n            width={width}\n            height={height}\n            nodeBounds={bounds}\n            linkDimensions={linkDimensions.current}\n            promotedLinkDimensions={promotedLinkDimensions.current}\n            states={states.current!}\n            previousStates={previousState}\n            onNodeSizeChanged={onNodeSizeChanged}\n            onLinkSizeChanged={onLinkSizeChanged}\n            onPromotedLinkSizeChanged={onPromotedLinkSizeChanged}\n            nodeLabelPositions={nodeLabelPosRef.current}\n            linkLabelPositions={linkLabelPosRef.current}\n            labelDimensions={labelDimensions.current}\n            supportsSelection={\n              selectionMode !== 'none' ||\n              !!(selectedIds?.nodes && selectedIds.nodes.length > 0) ||\n              !!(selectedIds?.links && selectedIds.links.length > 0)\n            }\n            layoutOutput={layoutOutput}\n            nodeIdToParentMap={nodeIdToParentMap}\n            rootRef={rootRef}\n            combinedNodeBounds={contentBounds}\n            nodeBoundsRef={nodeBoundsRef}\n            promotedLinks={promotedLinks}\n            promotedToLinkMap={promotedToLinkMap}\n          />\n        </DiagramPanZoomContainer>\n      ) : undefined}\n      {textMeasureContent}\n      {datatipContent}\n      {contextMenuContent}\n      {selectionContent}\n      {toggleButtonContent}\n    </div>\n  );\n}\n","/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\nimport type {\n  DiagramProps,\n  DiagramNodeData,\n  DiagramLinkData,\n  DiagramLayoutOutput\n} from './diagram.types';\nimport { TrackResizeContainer } from '#UNSAFE_TrackResizeContainer';\nimport { dimensionStyle } from './themes/DiagramStyles.css';\nimport { ContainerDiagramWithDimensions } from './ContainerDiagramWithDimensions';\n\n/**\n * Diagrams are used to display a set of nodes and the links between them.\n */\nexport function ContainerDiagram<\n  K1 extends string | number,\n  K2 extends string | number,\n  D1 extends DiagramNodeData<K1, D1>,\n  D2 extends DiagramLinkData<K2, K1>,\n  L extends DiagramLayoutOutput<K1, K2>\n>({ width, height, ...otherProps }: DiagramProps<K1, K2, D1, D2, L>) {\n  return otherProps.nodes && otherProps.nodes.length > 0 ? (\n    <TrackResizeContainer width={width} height={height} class={dimensionStyle}>\n      {(width, height) => (\n        <ContainerDiagramWithDimensions width={width} height={height} {...otherProps} />\n      )}\n    </TrackResizeContainer>\n  ) : null;\n}\n"],"names":["generateAriaLabel","labelStyles","_jsx","classNames","buttonStyle","Plus","Minus","itemStyles","useTranslationBundle","useRef","useResizeObserver","useCallback","useUser","_jsxs","layerStyles","_Fragment","panZoomStyles","useState","getRandomId","useVisHover","mergeProps","calculateOffset","useDatatip","isTouch","useVisDragModeControls","useSelection","useContextMenu","useTextDimensions","useVisTouchResponse","outerStyles","merge","TrackResizeContainer","dimensionStyle"],"mappings":"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"}