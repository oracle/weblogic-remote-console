{"version":3,"file":"refUtils-a9872e75.js","sources":["../../src/utils/PRIVATE_refUtils/refUtils.ts"],"sourcesContent":["/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\nimport { Ref } from 'preact';\n\ntype CleanupFuncType = () => void;\nexport function assignRef<T>(ref: Ref<T> | undefined, value: T | null): void | CleanupFuncType {\n  if (ref == null) return;\n\n  if (typeof ref === 'function') {\n    return ref(value);\n  }\n\n  try {\n    ref.current = value;\n  } catch (error) {\n    throw new Error(`Cannot assign value '${value}' to ref '${ref}'`);\n  }\n}\n\nexport function mergeRefs<T>(...refs: (Ref<T> | undefined)[]) {\n  return (node: T | null) => {\n    let cleanupFunc;\n\n    // We need to keep track of cleanup functions from ref callbacks\n    // (Preact feature added in PR https://github.com/preactjs/preact/pull/4436).\n    // When cleanup functions are detected, create a wrapper around them\n    // that will be executed when a component is disconnected from DOM.\n    const cleanupFuncArray = refs.reduce<CleanupFuncType[]>((acc, ref) => {\n      const cleanupFunc = assignRef(ref, node);\n      if (typeof cleanupFunc === 'function') {\n        acc.push(cleanupFunc);\n      }\n      return acc;\n    }, []);\n\n    if (cleanupFuncArray.length > 0) {\n      cleanupFunc = () => {\n        cleanupFuncArray.forEach((func) => func());\n      };\n    }\n    return cleanupFunc;\n  };\n}\n"],"names":[],"mappings":";;;AAUgB,SAAA,SAAS,CAAI,GAAuB,EAAE,KAAe,EAAA;IACnE,IAAI,GAAG,IAAI,IAAI;QAAE,OAAO;AAExB,IAAA,IAAI,OAAO,GAAG,KAAK,UAAU,EAAE;AAC7B,QAAA,OAAO,GAAG,CAAC,KAAK,CAAC,CAAC;KACnB;AAED,IAAA,IAAI;AACF,QAAA,GAAG,CAAC,OAAO,GAAG,KAAK,CAAC;KACrB;IAAC,OAAO,KAAK,EAAE;QACd,MAAM,IAAI,KAAK,CAAC,CAAA,qBAAA,EAAwB,KAAK,CAAa,UAAA,EAAA,GAAG,CAAG,CAAA,CAAA,CAAC,CAAC;KACnE;AACH,CAAC;AAEe,SAAA,SAAS,CAAI,GAAG,IAA4B,EAAA;IAC1D,OAAO,CAAC,IAAc,KAAI;AACxB,QAAA,IAAI,WAAW,CAAC;;;;;QAMhB,MAAM,gBAAgB,GAAG,IAAI,CAAC,MAAM,CAAoB,CAAC,GAAG,EAAE,GAAG,KAAI;YACnE,MAAM,WAAW,GAAG,SAAS,CAAC,GAAG,EAAE,IAAI,CAAC,CAAC;AACzC,YAAA,IAAI,OAAO,WAAW,KAAK,UAAU,EAAE;AACrC,gBAAA,GAAG,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;aACvB;AACD,YAAA,OAAO,GAAG,CAAC;SACZ,EAAE,EAAE,CAAC,CAAC;AAEP,QAAA,IAAI,gBAAgB,CAAC,MAAM,GAAG,CAAC,EAAE;YAC/B,WAAW,GAAG,MAAK;gBACjB,gBAAgB,CAAC,OAAO,CAAC,CAAC,IAAI,KAAK,IAAI,EAAE,CAAC,CAAC;AAC7C,aAAC,CAAC;SACH;AACD,QAAA,OAAO,WAAW,CAAC;AACrB,KAAC,CAAC;AACJ;;;;;"}