{"version":3,"file":"useAddBusyState-d19ae1fa.js","sources":["../../src/hooks/PRIVATE_useAddBusyState/useAddBusyState.ts"],"sourcesContent":["/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * Licensed under The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\n\nimport { useBusyStateContext } from '#hooks/UNSAFE_useBusyStateContext';\nimport { useRef, useCallback, useLayoutEffect } from 'preact/hooks';\n\n/**\n * Provides way to add and resolve a busy state.\n */\nexport function useAddBusyState(description: string) {\n  const { addBusyState } = useBusyStateContext();\n  const resolverRef = useRef<() => void>();\n\n  const onBusyEnd = useCallback(() => {\n    resolverRef.current?.();\n    resolverRef.current = undefined;\n  }, []);\n\n  const onBusyStart = useCallback(() => {\n    // Resolve previous busy state if any\n    onBusyEnd();\n    resolverRef.current = addBusyState(description);\n  }, [description, onBusyEnd, addBusyState]);\n\n  // Resolve any pending busy state on unmount - return onBusyEnd callback itself (do not execute it)\n  useLayoutEffect(() => onBusyEnd, [onBusyEnd]);\n\n  return {\n    onBusyStart,\n    onBusyEnd\n  };\n}\n"],"names":["useBusyStateContext","useRef","useCallback","useLayoutEffect"],"mappings":";;;;;;;AAAA;;;;;;AAMG;AAKH;;AAEG;AACG,SAAU,eAAe,CAAC,WAAmB,EAAA;AACjD,IAAA,MAAM,EAAE,YAAY,EAAE,GAAGA,uCAAmB,EAAE,CAAC;AAC/C,IAAA,MAAM,WAAW,GAAGC,YAAM,EAAc,CAAC;AAEzC,IAAA,MAAM,SAAS,GAAGC,iBAAW,CAAC,MAAK;AACjC,QAAA,WAAW,CAAC,OAAO,IAAI,CAAC;AACxB,QAAA,WAAW,CAAC,OAAO,GAAG,SAAS,CAAC;KACjC,EAAE,EAAE,CAAC,CAAC;AAEP,IAAA,MAAM,WAAW,GAAGA,iBAAW,CAAC,MAAK;;AAEnC,QAAA,SAAS,EAAE,CAAC;AACZ,QAAA,WAAW,CAAC,OAAO,GAAG,YAAY,CAAC,WAAW,CAAC,CAAC;KACjD,EAAE,CAAC,WAAW,EAAE,SAAS,EAAE,YAAY,CAAC,CAAC,CAAC;;IAG3CC,qBAAe,CAAC,MAAM,SAAS,EAAE,CAAC,SAAS,CAAC,CAAC,CAAC;IAE9C,OAAO;QACL,WAAW;QACX,SAAS;KACV,CAAC;AACJ;;;;"}