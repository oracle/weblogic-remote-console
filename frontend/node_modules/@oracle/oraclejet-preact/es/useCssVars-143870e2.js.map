{"version":3,"file":"useCssVars-143870e2.js","sources":["../../src/hooks/PRIVATE_useCssVars/useCssVars.tsx"],"sourcesContent":["/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\n\nimport { useLayoutEffect, useRef, useState } from 'preact/hooks';\nimport { useUser } from '../UNSAFE_useUser';\nimport { useTheme } from '../UNSAFE_useTheme';\nimport { useColorScheme } from '../UNSAFE_useColorScheme';\nimport { useScale } from '../UNSAFE_useScale';\n\nfunction getCssVarName(name: string) {\n  const rxp = name.match(/var\\((--[a-zA-Z_0-9\\-]+)\\)/);\n  return rxp && rxp.length > 1 ? rxp[1] : '';\n}\n\n/**\n * Hook to resolve the css vars.\n * @param vars\n * @param classes\n * @returns\n */\nexport function useCssVars(\n  vars: {\n    /**\n     * The token variable.\n     */\n    tokenVar: string;\n    /**\n     * The key of the resolved variable.\n     */\n    key: string;\n    /**\n     * The absolute used value of the token vars assigned to css expression cannot be computed through getComputedStyle if\n     * not assigned to a css property. This optional prop provides css property to assign the token var to in order to get\n     * actual used style.\n     */\n    cssProp?: string;\n  }[]\n) {\n  const cssDivRef = useRef<HTMLDivElement>(null);\n  const [resolvedVars, setResolvedVars] = useState<Record<string, any>>({});\n  const { forcedColors } = useUser();\n  const { name } = useTheme();\n  const scale = useScale();\n  const colorScheme = useColorScheme();\n\n  // A css token var (eg, --tokenVar_123xyz) that is assigned to a css expression like min(25px, 5rem) resolves to\n  // a string of the expression (resolved value) like \"min(25px, 5rem)\" and not absolute value (for eg 25px) (used value) when getComputedStyle is called.\n  // We have to assign the token var to a valid css property(like width: var(--tokenVar_123xyz)) in order to get actual used value in\n  // computed styles. https://developer.mozilla.org/en-US/docs/Web/CSS/used_value\n\n  // build a style obj with valid css property to apply to div\n  const style = vars.reduce((prev: Record<string, string>, current) => {\n    if (current.cssProp) {\n      prev[current.cssProp] = current.tokenVar;\n    }\n    return prev;\n  }, {});\n\n  const cssContent = <div ref={cssDivRef} style={{ display: 'none', ...style }}></div>;\n\n  useLayoutEffect(() => {\n    if (!cssDivRef.current) {\n      return;\n    }\n\n    const computedStyle = window.getComputedStyle(cssDivRef.current);\n    const resolved: Record<string, any> = {};\n    vars.forEach((value) => {\n      // use cssProp for token vars that resolve to expression\n      const cssVar = value.cssProp || getCssVarName(value.tokenVar);\n      resolved[value.key] = computedStyle.getPropertyValue(cssVar);\n    });\n    setResolvedVars(resolved);\n  }, [forcedColors, name, colorScheme, scale, vars]);\n\n  return {\n    resolvedVars,\n    cssContent\n  };\n}\n"],"names":["_jsx"],"mappings":";;;;;;;;AAcA,SAAS,aAAa,CAAC,IAAY,EAAA;IACjC,MAAM,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,4BAA4B,CAAC,CAAC;AACrD,IAAA,OAAO,GAAG,IAAI,GAAG,CAAC,MAAM,GAAG,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC;AAC7C,CAAC;AAED;;;;;AAKG;AACG,SAAU,UAAU,CACxB,IAeG,EAAA;AAEH,IAAA,MAAM,SAAS,GAAG,MAAM,CAAiB,IAAI,CAAC,CAAC;IAC/C,MAAM,CAAC,YAAY,EAAE,eAAe,CAAC,GAAG,QAAQ,CAAsB,EAAE,CAAC,CAAC;AAC1E,IAAA,MAAM,EAAE,YAAY,EAAE,GAAG,OAAO,EAAE,CAAC;AACnC,IAAA,MAAM,EAAE,IAAI,EAAE,GAAG,QAAQ,EAAE,CAAC;AAC5B,IAAA,MAAM,KAAK,GAAG,QAAQ,EAAE,CAAC;AACzB,IAAA,MAAM,WAAW,GAAG,cAAc,EAAE,CAAC;;;;;;IAQrC,MAAM,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC,IAA4B,EAAE,OAAO,KAAI;AAClE,QAAA,IAAI,OAAO,CAAC,OAAO,EAAE;YACnB,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,GAAG,OAAO,CAAC,QAAQ,CAAC;SAC1C;AACD,QAAA,OAAO,IAAI,CAAC;KACb,EAAE,EAAE,CAAC,CAAC;AAEP,IAAA,MAAM,UAAU,GAAGA,GAAA,CAAA,KAAA,EAAA,EAAK,GAAG,EAAE,SAAS,EAAE,KAAK,EAAE,EAAE,OAAO,EAAE,MAAM,EAAE,GAAG,KAAK,EAAE,GAAQ,CAAC;IAErF,eAAe,CAAC,MAAK;AACnB,QAAA,IAAI,CAAC,SAAS,CAAC,OAAO,EAAE;YACtB,OAAO;SACR;QAED,MAAM,aAAa,GAAG,MAAM,CAAC,gBAAgB,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;QACjE,MAAM,QAAQ,GAAwB,EAAE,CAAC;AACzC,QAAA,IAAI,CAAC,OAAO,CAAC,CAAC,KAAK,KAAI;;AAErB,YAAA,MAAM,MAAM,GAAG,KAAK,CAAC,OAAO,IAAI,aAAa,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;AAC9D,YAAA,QAAQ,CAAC,KAAK,CAAC,GAAG,CAAC,GAAG,aAAa,CAAC,gBAAgB,CAAC,MAAM,CAAC,CAAC;AAC/D,SAAC,CAAC,CAAC;QACH,eAAe,CAAC,QAAQ,CAAC,CAAC;AAC5B,KAAC,EAAE,CAAC,YAAY,EAAE,IAAI,EAAE,WAAW,EAAE,KAAK,EAAE,IAAI,CAAC,CAAC,CAAC;IAEnD,OAAO;QACL,YAAY;QACZ,UAAU;KACX,CAAC;AACJ;;;;"}