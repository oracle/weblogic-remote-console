{"version":3,"file":"tooltipUtils-466c63c4.js","sources":["../../src/hooks/UNSAFE_useTooltip/TooltipManager.ts","../../src/utils/PRIVATE_tooltipUtils/tooltipUtils.tsx"],"sourcesContent":["/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\n\nexport type TooltipManagerCallback = () => void;\n\nconst FocusTriggerKeys = ['Tab', 'ArrowLeft', 'ArrowRight', 'ArrowUp', 'ArrowDown'];\n\n/**\n * A global tooltip manager that\n * - ensures that only one tooltip is shown at a time\n * - detects a Tab key press and allows tooltips to check if their target was focused via keyboard\n */\nexport class TooltipManager {\n  private activeCallback: TooltipManagerCallback | null;\n\n  private triggerKeyActive: boolean;\n\n  private keyDownHandler = (event: KeyboardEvent) => {\n    if (FocusTriggerKeys.includes(event.key)) {\n      this.triggerKeyActive = true;\n      setTimeout(() => {\n        this.triggerKeyActive = false;\n      }, 100);\n    }\n    if (this.activeCallback && event.key === 'Escape') {\n      // hide active tooltip on Escape\n      this.activeCallback();\n    }\n  };\n\n  constructor() {\n    this.activeCallback = null;\n    this.triggerKeyActive = false;\n    window.addEventListener('keydown', this.keyDownHandler, true);\n  }\n\n  /**\n   * notifies the previously registered active tooltip callback and registers a new one\n   */\n  public register = (callback: TooltipManagerCallback) => {\n    if (this.activeCallback && this.activeCallback !== callback) {\n      this.activeCallback();\n    }\n    this.activeCallback = callback;\n  };\n\n  /**\n   * resets the registered active callback\n   */\n  public unregister = (callback: TooltipManagerCallback) => {\n    if (this.activeCallback === callback) {\n      this.activeCallback = null;\n    }\n  };\n\n  /**\n   * returns the active Tab key status ('active' means a Tab key press within the last 100ms)\n   */\n  public isTabKeyActive = () => {\n    return this.triggerKeyActive;\n  };\n}\n","/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\nimport type { RefObject } from 'preact';\nimport { JSXInternal } from 'preact/src/jsx';\nimport { EnvironmentProvider } from '../../UNSAFE_Environment';\nimport { Coords, Floating, Placement } from '../../UNSAFE_Floating';\nimport { Layer } from '../../UNSAFE_Layer';\nimport { ColorScheme } from '../../UNSAFE_Theme';\nimport { TooltipManager } from '../../hooks/UNSAFE_useTooltip/TooltipManager';\n\n// Global TooltipManager singleton instance\nconst globalTooltipManager = new TooltipManager();\n\n/**\n * The delays (in ms) for Redwood tooltips.\n */\nexport const SHOW_TOOLTIP_DELAY = 1000;\nexport const HIDE_TOOLTIP_DELAY = 150;\n\n/**\n * Returns a global TooltipManager singleton instance\n */\nexport const getGlobalTooltipManager = (): TooltipManager => {\n  return globalTooltipManager;\n};\n\n/**\n * Wraps the tooltip content provided in the appropriate layering and returns the result for display.\n */\nexport const getWrappedTooltipContent = (\n  tooltipContent: JSXInternal.Element,\n  variant: 'tooltip' | 'datatip',\n  colorScheme: ColorScheme,\n  anchorRef: RefObject<Element | Coords>,\n  placement: Placement,\n  offset?: { mainAxis?: number; crossAxis?: number }\n): JSXInternal.Element => {\n  const defaultOffset = 8; // Redwood tooltip has a default offset of 8 pixels\n  const newOffset = offset ? offset : { mainAxis: defaultOffset, crossAxis: 0 };\n\n  const newColorScheme = !colorScheme || colorScheme === 'light' ? 'dark' : 'light';\n\n  const renderTooltipOrDatatip = () => {\n    if (variant === 'tooltip') {\n      return (\n        <EnvironmentProvider environment={{ colorScheme: newColorScheme }}>\n          {tooltipContent}\n        </EnvironmentProvider>\n      );\n    } else {\n      return <>{tooltipContent}</>;\n    }\n  };\n\n  return (\n    <Layer priority=\"tooltip\">\n      <Floating anchorRef={anchorRef} placement={placement} offsetValue={newOffset}>\n        {renderTooltipOrDatatip()}\n      </Floating>\n    </Layer>\n  );\n};\n"],"names":["_jsx","_Fragment"],"mappings":"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"}