{"version":3,"file":"TextField-2643ae3c.js","sources":["../../src/UNSAFE_TextField/TextFieldContent.tsx","../../src/UNSAFE_TextField/TextField.tsx"],"sourcesContent":["import type { ComponentChildren, ContextType, Ref, RefObject } from 'preact';\nimport { useCallback, useRef, useState } from 'preact/hooks';\n\nimport { useComponentTheme } from '#hooks/UNSAFE_useComponentTheme';\nimport { useFormFieldContext } from '#hooks/UNSAFE_useFormFieldContext';\nimport type { FormVariantContext } from '#hooks/UNSAFE_useFormVariantContext';\nimport { useInputGroupContext } from '#hooks/UNSAFE_useInputGroupContext';\nimport { useTextFieldTooltip } from './useTextFieldTooltip';\nimport { useUser } from '#hooks/UNSAFE_useUser';\nimport { Flex } from '#UNSAFE_Flex';\nimport { isEmbeddedVariant } from '#utils/PRIVATE_formControlUtils';\nimport { classNames } from '#utils/UNSAFE_classNames';\nimport { TextFieldRedwoodTheme } from './themes/redwood/TextFieldTheme';\nimport type { TextFieldStyles, TextFieldVariantOptions } from './themes/TextFieldStyles.css';\n\ntype VariantProps = {\n  contentVariant?: 'input' | 'textarea';\n  statusVariant?: 'error' | 'none' | 'warning';\n  styleVariant?: ContextType<typeof FormVariantContext>;\n};\n\ntype Props = VariantProps & {\n  mainContent?: ComponentChildren;\n  insideLabel?: ComponentChildren;\n  startContent?: ComponentChildren;\n  endContent?: ComponentChildren;\n  resize?: 'horizontal' | 'vertical' | 'both';\n  rootRef?: Ref<HTMLDivElement>;\n  hasZeroStartMargin?: boolean;\n  labelText?: string;\n};\n\n// Renders the oj-text-field-container dom which includes the\n// start, middle (where the inside label and inputElem goes),\n// and end pieces of the form component.\n// This does not include user assistance because that is rendered outside the\n// oj-text-field-container; that is rendered in the TextField component.\nexport const TextFieldContent = ({\n  contentVariant = 'input',\n  insideLabel,\n  labelText,\n  mainContent,\n  startContent,\n  statusVariant = 'none',\n  styleVariant = 'default',\n  endContent,\n  resize,\n  rootRef,\n  hasZeroStartMargin\n}: Props) => {\n  const { hasTruncatedLabel, isDisabled, isFocused, isLoading } = useFormFieldContext();\n  const { direction } = useUser();\n  const isLtr = direction === 'ltr';\n  const hasInsideLabel = insideLabel !== undefined;\n  const inputGroupContext = useInputGroupContext();\n  const hasGroupContext = inputGroupContext !== null;\n  // depending on browser direction, apply the appropriate styling.\n  // when 'rtl' the flex row direction is reversed.\n  const inputGroupPosition = inputGroupContext\n    ? inputGroupContext.last\n      ? isLtr\n        ? 'groupRight'\n        : 'groupLeft'\n      : inputGroupContext.index === 0\n      ? isLtr\n        ? 'groupLeft'\n        : 'groupRight'\n      : 'groupMiddle'\n    : undefined;\n\n  const {\n    variantClasses,\n    styles: { textFieldContainerBase }\n  } = useComponentTheme<TextFieldVariantOptions, TextFieldStyles>(TextFieldRedwoodTheme, {\n    statusVariant,\n    styleVariant: isEmbeddedVariant(styleVariant) ? 'embedded' : 'default',\n    contentVariant,\n    insideLabel: hasInsideLabel ? 'hasInsideLabel' : 'noInsideLabel',\n    focused: isFocused ? 'isFocused' : 'notFocused',\n    disabled: isDisabled ? 'isDisabled' : 'notDisabled',\n    loading: isLoading ? 'isLoading' : 'notLoading',\n    resize: resize ?? 'none',\n    withinGroup: hasGroupContext ? 'isWithinGroup' : undefined,\n    inputGroupPosition\n  });\n\n  const { variantClasses: startContentStyles } = useComponentTheme<TextFieldVariantOptions>(\n    TextFieldRedwoodTheme,\n    {\n      startContent: hasInsideLabel ? 'hasInsideLabel' : 'noInsideLabel',\n      startContentMargin: hasZeroStartMargin ? 'noStartMargin' : 'hasStartMargin',\n      startContentDisabled: isDisabled ? 'isDisabled' : 'notDisabled'\n    }\n  );\n\n  const {\n    variantClasses: middleStyles,\n    styles: { textFieldEndContent }\n  } = useComponentTheme<TextFieldVariantOptions, TextFieldStyles>(TextFieldRedwoodTheme, {\n    middleContent: contentVariant,\n    textAreaResizeDirection: resize && contentVariant === 'textarea' ? direction : undefined\n  });\n\n  // Use an onKeyDownCapture handler to set a flag that closes the tooltip when any key is pressed.\n  // Reset the flag when we see the user blur out of the input.\n  const [keyDownCaptureKeyPressed, setKeyDownCaptureKeyPressed] = useState(false);\n  const keyDownCaptureHandler = useCallback(() => {\n    if (!keyDownCaptureKeyPressed && hasTruncatedLabel) {\n      setKeyDownCaptureKeyPressed(true);\n    }\n  }, [hasTruncatedLabel, keyDownCaptureKeyPressed]);\n  const blurHandler = useCallback(\n    (event: FocusEvent) => {\n      if (\n        keyDownCaptureKeyPressed &&\n        (event.relatedTarget == null ||\n          !(event.currentTarget as HTMLElement).contains(event.relatedTarget as HTMLElement))\n      ) {\n        setKeyDownCaptureKeyPressed(false);\n      }\n    },\n    [keyDownCaptureKeyPressed]\n  );\n\n  const fieldRef = useRef(null);\n  const ref = rootRef ?? fieldRef;\n  const { tooltipContent, tooltipEventHandlerProps } = useTextFieldTooltip({\n    hasTruncatedLabel: hasTruncatedLabel && !keyDownCaptureKeyPressed,\n    fieldRef: ref as RefObject<HTMLElement>,\n    isDisabled: !hasInsideLabel || !!isDisabled,\n    label: labelText\n  });\n  const eventHandlers =\n    hasInsideLabel && !isDisabled\n      ? { onBlur: blurHandler, onKeyDownCapture: keyDownCaptureHandler }\n      : {};\n\n  return (\n    <div\n      role=\"presentation\"\n      class={classNames([variantClasses, textFieldContainerBase])}\n      ref={ref}\n      {...tooltipEventHandlerProps}>\n      {startContent && (\n        <span class={startContentStyles}>\n          <Flex justify=\"center\" align=\"center\" hasZeroMargins={true}>\n            {startContent}\n          </Flex>\n        </span>\n      )}\n      <div class={middleStyles} {...eventHandlers}>\n        {insideLabel}\n        {mainContent}\n      </div>\n      {endContent && (\n        <span class={textFieldEndContent}>\n          <Flex justify=\"center\" align=\"center\" hasZeroMargins={true}>\n            {endContent}\n          </Flex>\n        </span>\n      )}\n      {tooltipContent}\n    </div>\n  );\n};\n","import type { ComponentChildren, ComponentProps, Ref, JSX } from 'preact';\n\nimport type { UnpackSignals } from '@oracle/oraclejet-internal-utilities/attributeUtils';\n\nimport { type TestIdProps, useTestId } from '#hooks/UNSAFE_useTestId';\nimport { LabelValueLayout } from '#UNSAFE_LabelValueLayout';\nimport { Size } from '#utils/UNSAFE_size';\nimport { LayoutColumnSpan } from '#utils/UNSAFE_styles/Layout';\nimport { StyledTextField } from './StyledTextField';\nimport { TextFieldContent } from './TextFieldContent';\n\n// TextField takes the inputElem and userAssistanceContainer\n// and renders the form component's root dom, along with the\n// TextFieldContent, and the user assistance container.\n\n// The PickedProps are the ones we pass through to the the TextFieldContent\ntype PickedPropsFromTextFieldContent = Pick<\n  ComponentProps<typeof TextFieldContent>,\n  | 'hasZeroStartMargin'\n  | 'contentVariant'\n  | 'startContent'\n  | 'statusVariant'\n  | 'styleVariant'\n  | 'mainContent'\n  | 'endContent'\n  | 'resize'\n  | 'labelText'\n>;\ntype PickedPropsFromHTMLElement = Pick<UnpackSignals<JSX.HTMLAttributes<HTMLElement>>, 'id'>;\n// TODO: How should a parent component listen to events for the text field?  The recommendation\n// was to remove event listeners from TextField itself and instead configure the TextFieldInput\n// with them, for example, thus keeping TextField a more pure layout component.  The\n// TextFieldInput renders the focusable input element, and may be a more natural place for\n// listeners.  We would potentially have to add similar listeners for the ReadonlyTextField, but\n// that component renders the focusable element itself;  there is no TextFieldInput or analogous\n// component passed in.  (from review on 3/8/22)\ntype FocusEvents = Pick<UnpackSignals<JSX.IntrinsicElements['div']>, 'onFocus' | 'onBlur'>;\ntype KeyEvents = Pick<UnpackSignals<JSX.IntrinsicElements['div']>, 'onKeyDown'>;\ntype MouseEvents = Pick<\n  UnpackSignals<JSX.IntrinsicElements['div']>,\n  'onMouseDown' | 'onMouseEnter' | 'onMouseLeave'\n>;\ntype LabelProps = {\n  label?: ComponentChildren;\n  labelEdge?: 'inside' | 'start' | 'top';\n  labelStartWidth?: Size;\n};\ntype Props = PickedPropsFromTextFieldContent &\n  PickedPropsFromHTMLElement &\n  FocusEvents &\n  KeyEvents &\n  MouseEvents &\n  LabelProps &\n  TestIdProps & {\n    columnSpan?: LayoutColumnSpan;\n    compactUserAssistance?: ComponentChildren;\n    inlineUserAssistance?: ComponentChildren;\n    mainFieldRef?: Ref<HTMLDivElement>;\n    rootRef?: Ref<HTMLElement>;\n  };\n\n// TODO: Do we need named props for start/endContent, or could they just be children that get\n// wrapped in a flex layout?  (from review on 3/8/22)\n\n// TODO: Instead of passing the inputElem, label, and userAssistance as named props here, should we\n// have a separate layout component that lays them out, which could just be passed as a child\n// to the TextField?  (from review on 3/8/22)\n\nexport const TextField = ({\n  contentVariant,\n  id,\n  endContent,\n  mainContent,\n  startContent,\n  columnSpan,\n  compactUserAssistance,\n  inlineUserAssistance,\n  label,\n  labelEdge,\n  labelStartWidth,\n  labelText,\n  mainFieldRef,\n  resize,\n  statusVariant,\n  styleVariant,\n  hasZeroStartMargin,\n  rootRef,\n  onFocus,\n  onBlur,\n  onKeyDown,\n  onMouseDown,\n  onMouseEnter,\n  onMouseLeave,\n  testId\n}: Props) => {\n  const testIdProps = useTestId(testId);\n  // TODO: How should a parent form component render component-specific content within TextField,\n  // for example an aria live region?  Instead of a children prop on TextField, could the parent\n  // component pass comp-specific content through other props, like inputElem?   The parent could\n  // have its own component that composes inputElem with additional DOM.  (from review on 3/8/22)\n\n  const isStartTop = label !== undefined && (labelEdge === 'start' || labelEdge === 'top');\n  const textFieldContent = (\n    <TextFieldContent\n      contentVariant={contentVariant}\n      endContent={endContent}\n      labelText={labelText}\n      mainContent={mainContent}\n      resize={resize}\n      rootRef={mainFieldRef}\n      startContent={startContent}\n      statusVariant={statusVariant}\n      styleVariant={styleVariant}\n      hasZeroStartMargin={hasZeroStartMargin}\n      {...(!isStartTop ? { insideLabel: label } : {})}\n    />\n  );\n\n  const innerContent = (\n    <>\n      {compactUserAssistance}\n      {textFieldContent}\n      {inlineUserAssistance}\n    </>\n  );\n\n  const styledTextFieldChildren = isStartTop ? (\n    <LabelValueLayout\n      columnSpan={columnSpan}\n      label={label}\n      labelEdge={labelEdge}\n      labelStartWidth={labelStartWidth}>\n      {innerContent}\n    </LabelValueLayout>\n  ) : (\n    innerContent\n  );\n\n  return (\n    <StyledTextField\n      id={id}\n      columnSpan={columnSpan}\n      onFocusIn={onFocus}\n      onFocusOut={onBlur}\n      onKeyDown={onKeyDown}\n      onMouseDown={onMouseDown}\n      onMouseEnter={onMouseEnter}\n      onMouseLeave={onMouseLeave}\n      ref={rootRef}\n      variant={styleVariant}\n      {...testIdProps}>\n      {styledTextFieldChildren}\n    </StyledTextField>\n  );\n};\n"],"names":["_jsxs","_jsx","_Fragment"],"mappings":"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"}