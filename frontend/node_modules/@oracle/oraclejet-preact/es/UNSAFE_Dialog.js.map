{"version":3,"file":"UNSAFE_Dialog.js","sources":["../../src/UNSAFE_Dialog/useFlexibleComponent.ts"],"sourcesContent":["import type { RefObject } from 'preact';\nimport { useState, useRef } from 'preact/hooks';\nimport { Coords } from '../UNSAFE_Floating';\nimport { Size } from '../utils/UNSAFE_size';\nimport { Position, Rect } from '../utils/UNSAFE_flexibleComponentUtils';\n\ntype Dimensions = {\n  width: number;\n  height: number;\n};\n\ntype DimensionsCss = {\n  width: Size;\n  height: Size;\n};\n\nexport type DragMoveDetail = {\n  originalPosition: Position;\n  position: Position;\n};\n\nexport type ResizeDetail = {\n  originalPosition: Position;\n  originalSize: Dimensions;\n  position: Position;\n  size: Dimensions;\n};\n\ntype UseFlexibleComponentProps = {\n  isDisabled?: boolean;\n  isDraggable?: boolean;\n  isResizable?: boolean;\n  onDragStart?: (detail: DragMoveDetail) => void;\n  onDragMove?: (detail: DragMoveDetail) => void;\n  onDragEnd?: (detail: DragMoveDetail) => void;\n  onResizeStart?: (detail: ResizeDetail) => void;\n  onResize?: (detail: ResizeDetail) => void;\n  onResizeEnd?: (detail: ResizeDetail) => void;\n};\n\n/**\n * A custom hook that adds drag and/or resize capabilities to a component (e. g. Dialog).\n * The hook maintains the original and current position and size and returns handlers and\n * props to be spread on the component to make it \"flexible\". In addition, allows its consumer\n * to be notified when the drag or resize life-cycle events occur.\n */\nexport const useFlexibleComponent = ({\n  isDisabled = false,\n  isDraggable = false,\n  isResizable = false,\n  onDragStart: onDragStartHandler,\n  onDragMove: onDragMoveHandler,\n  onDragEnd: onDragEndHandler,\n  onResizeStart: onResizeStartHandler,\n  onResize: onResizeHandler,\n  onResizeEnd: onResizeEndHandler\n}: UseFlexibleComponentProps): {\n  onDragStart?: (pos: Position) => void;\n  onDragMove?: (pos: Position) => void;\n  onDragEnd?: (pos: Position) => void;\n  onResizeStart?: (rect: Rect) => void;\n  onResize?: (rect: Rect) => void;\n  onResizeEnd?: (rect: Rect) => void;\n  anchorRef?: RefObject<Coords>;\n  width?: Size;\n  height?: Size;\n} => {\n  const [coords, _setCoords] = useState<Coords>();\n  const [dimensions, setDimensions] = useState<DimensionsCss>();\n\n  const coordsRef = useRef<Coords | null>(null);\n\n  const origPosRef = useRef<Position | null>(null);\n  const origSizeRef = useRef<Dimensions | null>(null);\n\n  const setCoords = (coords: Coords) => {\n    _setCoords({ x: coords.x, y: coords.y });\n    coordsRef.current = { x: coords.x, y: coords.y };\n  };\n\n  if (isDisabled || (!isDraggable && !isResizable)) {\n    return {};\n  }\n\n  const onDragStart = (pos: Position) => {\n    setCoords({ x: pos.x, y: pos.y });\n    origPosRef.current = { x: pos.x, y: pos.y };\n    onDragStartHandler?.({\n      originalPosition: { x: origPosRef.current.x, y: origPosRef.current.y },\n      position: { x: pos.x, y: pos.y }\n    });\n  };\n\n  const onDragMove = (pos: Position) => {\n    setCoords({ x: pos.x, y: pos.y });\n    onDragMoveHandler?.({\n      originalPosition: { x: origPosRef.current!.x, y: origPosRef.current!.y },\n      position: { x: pos.x, y: pos.y }\n    });\n  };\n\n  const onDragEnd = (pos: Position) => {\n    setCoords({ x: pos.x, y: pos.y });\n    onDragEndHandler?.({\n      originalPosition: { x: origPosRef.current!.x, y: origPosRef.current!.y },\n      position: { x: pos.x, y: pos.y }\n    });\n    origPosRef.current = null;\n  };\n\n  const onResizeStart = (rect: Rect) => {\n    setCoords({ x: rect.x, y: rect.y });\n    origPosRef.current = { x: rect.x, y: rect.y };\n    setDimensions({ width: (rect.width + 'px') as Size, height: (rect.height + 'px') as Size });\n    origSizeRef.current = { width: rect.width, height: rect.height };\n    onResizeStartHandler?.({\n      originalPosition: { x: origPosRef.current!.x, y: origPosRef.current!.y },\n      originalSize: { width: origSizeRef.current!.width, height: origSizeRef.current!.height },\n      position: { x: rect.x, y: rect.y },\n      size: { width: rect.width, height: rect.height }\n    });\n  };\n\n  const onResize = (rect: Rect) => {\n    setCoords({ x: rect.x, y: rect.y });\n    setDimensions({ width: (rect.width + 'px') as Size, height: (rect.height + 'px') as Size });\n    onResizeHandler?.({\n      originalPosition: { x: origPosRef.current!.x, y: origPosRef.current!.y },\n      originalSize: { width: origSizeRef.current!.width, height: origSizeRef.current!.height },\n      position: { x: rect.x, y: rect.y },\n      size: { width: rect.width, height: rect.height }\n    });\n  };\n\n  const onResizeEnd = (rect: Rect) => {\n    setCoords({ x: rect.x, y: rect.y });\n    setDimensions({ width: (rect.width + 'px') as Size, height: (rect.height + 'px') as Size });\n    onResizeEndHandler?.({\n      originalPosition: { x: origPosRef.current!.x, y: origPosRef.current!.y },\n      originalSize: { width: origSizeRef.current!.width, height: origSizeRef.current!.height },\n      position: { x: rect.x, y: rect.y },\n      size: { width: rect.width, height: rect.height }\n    });\n    origPosRef.current = null;\n    origSizeRef.current = null;\n  };\n\n  return {\n    ...(isDraggable && { onDragStart, onDragMove, onDragEnd }),\n    ...(isResizable && { onResizeStart, onResize, onResizeEnd }),\n    ...(coords && { anchorRef: coordsRef }),\n    ...(dimensions && { width: dimensions.width, height: dimensions.height })\n  };\n};\n"],"names":[],"mappings":"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"}