{"version":3,"file":"LoadMoreCollection-02671d0d.js","sources":["../../src/PRIVATE_LoadMoreCollection/LoadMoreCollection.tsx"],"sourcesContent":["/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * Licensed under The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\nimport { ComponentChildren, Fragment } from 'preact';\nimport { ItemContext } from '../UNSAFE_Collection';\nimport { Collection } from '../PRIVATE_Collection';\nimport { useViewportIntersect, ViewportConfig } from '../hooks/UNSAFE_useViewportIntersect';\n\n/**\n * Props for the LoadMoreCollection component\n */\ntype Props<D> = {\n  /**\n   * A DataState object that provide information including data and metadata to the LoadMoreCollection.\n   */\n  data: D[] | null;\n\n  /**\n   * Renderer callback used to render each item\n   */\n  children: (context: ItemContext<D>) => ComponentChildren;\n\n  /**\n   * Viewport configuration including specifying the element which is used to determine what range\n   * of data to render\n   */\n  viewportConfig: ViewportConfig;\n\n  /**\n   * Whether there are still more data to load.  Internally, LoadMoreCollection will render the load\n   * more indicator at the bottom if this is true\n   */\n  hasMore: boolean;\n\n  /**\n   * Callback function to handle when user scrolls to the end of the component and there are more items to load.\n   * The function should update data prop on the component to include the next set of items fetched.\n   */\n  onLoadMore: () => void;\n\n  /**\n   * Optionally specify the custom load more indicator\n   */\n  loadMoreIndicator?: ComponentChildren;\n\n  /**\n   * Optionally provide the suggestion indicator sparkle\n   */\n  suggestions?: ComponentChildren;\n\n  /**\n   * Optionally specify how far in pixel from the bottom should load more occurs\n   */\n  loadMoreThreshold?: number;\n};\n\nexport const LOADMORE_STYLE_CLASS = 'oj-collection-loadmore';\n\nconst DEFAULT_MARGIN = 1;\nconst LOAD_MORE_SELECTOR = `.${LOADMORE_STYLE_CLASS}`;\n\n/**\n * Component that only render items in the specified viewport.\n * @param props\n */\nexport function LoadMoreCollection<D>({\n  data,\n  children,\n  viewportConfig,\n  hasMore,\n  onLoadMore,\n  loadMoreIndicator,\n  suggestions,\n  loadMoreThreshold = DEFAULT_MARGIN\n}: Props<D>) {\n  // detect if viewport has changed and it needs to re-render based on a new range\n  useViewportIntersect(\n    viewportConfig,\n    Math.max(loadMoreThreshold, DEFAULT_MARGIN),\n    0,\n    LOAD_MORE_SELECTOR,\n    () => {\n      if (data) {\n        onLoadMore();\n      }\n    }\n  );\n\n  // if DataState is invalid (including not specified), just render blank\n  if (!data) {\n    return <div />;\n  }\n\n  // might need to support elementType prop in the future to allow customization of what\n  // type of element to render for the root\n  return (\n    <Fragment>\n      {suggestions}\n      <Collection items={data}>{children}</Collection>\n      {hasMore && loadMoreIndicator}\n    </Fragment>\n  );\n}\n"],"names":["_jsx","_jsxs"],"mappings":";;;;;;AA4DO,MAAM,oBAAoB,GAAG,yBAAyB;AAE7D,MAAM,cAAc,GAAG,CAAC,CAAC;AACzB,MAAM,kBAAkB,GAAG,CAAI,CAAA,EAAA,oBAAoB,EAAE,CAAC;AAEtD;;;AAGG;AACG,SAAU,kBAAkB,CAAI,EACpC,IAAI,EACJ,QAAQ,EACR,cAAc,EACd,OAAO,EACP,UAAU,EACV,iBAAiB,EACjB,WAAW,EACX,iBAAiB,GAAG,cAAc,EACzB,EAAA;;AAET,IAAA,oBAAoB,CAClB,cAAc,EACd,IAAI,CAAC,GAAG,CAAC,iBAAiB,EAAE,cAAc,CAAC,EAC3C,CAAC,EACD,kBAAkB,EAClB,MAAK;QACH,IAAI,IAAI,EAAE;AACR,YAAA,UAAU,EAAE,CAAC;SACd;AACH,KAAC,CACF,CAAC;;IAGF,IAAI,CAAC,IAAI,EAAE;AACT,QAAA,OAAOA,cAAO,CAAC;KAChB;;;IAID,QACEC,KAAC,QAAQ,EAAA,EAAA,QAAA,EAAA,CACN,WAAW,EACZD,GAAA,CAAC,UAAU,EAAC,EAAA,KAAK,EAAE,IAAI,EAAA,QAAA,EAAG,QAAQ,EAAc,CAAA,EAC/C,OAAO,IAAI,iBAAiB,CACpB,EAAA,CAAA,EACX;AACJ;;;;"}