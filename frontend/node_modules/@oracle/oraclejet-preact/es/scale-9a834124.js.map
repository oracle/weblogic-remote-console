{"version":3,"file":"scale-9a834124.js","sources":["../../src/utils/PRIVATE_chartUtils/scale.ts"],"sourcesContent":["/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * Licensed under The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\n\nexport class ScaleLinear {\n  private _domain: [number, number];\n  private _range: [number, number];\n  // y = mx + c; store m and c param\n  private m: number;\n  private c: number;\n\n  constructor(domain: [number, number], range: [number, number]) {\n    this._domain = domain;\n    this._range = range;\n    this.m = (this._range[1] - this._range[0]) / (this._domain[1] - this._domain[0]);\n    this.c = this._range[0] - this.m * this._domain[0];\n  }\n\n  transform(value: number) {\n    return this.m * value + this.c;\n  }\n\n  invert(value: number) {\n    return (value - this.c) / this.m;\n  }\n\n  domain() {\n    return this._domain;\n  }\n\n  range() {\n    return this._range;\n  }\n}\n\nexport class ScaleLog {\n  private _domain: [number, number];\n  private _linearDomain: [number, number];\n  private _range: [number, number];\n  private linearScale: ScaleLinear;\n\n  constructor(domain: [number, number], range: [number, number]) {\n    this._linearDomain = [Math.log(domain[0]), Math.log(domain[1])];\n    this._domain = domain;\n    this._range = range;\n    this.linearScale = new ScaleLinear(this._linearDomain, this._range);\n  }\n\n  transform(value: number) {\n    const v = Math.log(value);\n    return this.linearScale.transform(v);\n  }\n\n  invert(value: number) {\n    const v = this.linearScale.invert(value);\n    return Math.pow(10, v);\n  }\n\n  domain() {\n    return this._domain;\n  }\n\n  range() {\n    return this._range;\n  }\n}\n\nexport class VariableWidthScale {\n  private _domain: [number, number];\n  private _range: [number, number];\n  private _groupWidthRatios: number[] | null;\n\n  private _borderValues?: number[];\n  private _borderCoords?: number[];\n  private _groupWidths?: number[];\n  private _groupCount?: number;\n  private MinValue: number;\n  private MaxValue: number;\n  private StartCoord: number;\n  private EndCoord: number;\n\n  constructor(\n    domain: [number, number],\n    range: [number, number],\n    groupWidthRatios: number[] | null,\n    groupCount: number\n  ) {\n    this._domain = domain;\n    this._range = range;\n    this._groupWidthRatios = groupWidthRatios;\n    this.MinValue = this._domain[0];\n    this.MaxValue = this._domain[1];\n    this.StartCoord = this._range[0];\n    this.EndCoord = this._range[1];\n    this._groupCount = groupCount;\n    this._processGroupWidthRatios();\n  }\n\n  _processGroupWidthRatios() {\n    // Edge case: less than two groups\n    if (!this._groupWidthRatios || this._groupWidthRatios.length < 2) {\n      this._groupWidthRatios = [];\n      return;\n    }\n\n    // Compute the sums of the group widths that are contained within the viewport\n    let sum = 0;\n    let groupMin, groupMax;\n    for (let g = 0; g < this._groupCount!; g++) {\n      groupMin = g == 0 ? this.MinValue : Math.max(g - 0.5, this.MinValue);\n      groupMax = g == this._groupCount! - 1 ? this.MaxValue : Math.min(g + 0.5, this.MaxValue);\n      if (groupMax > groupMin) {\n        sum += (groupMax - groupMin) * this._groupWidthRatios[g];\n      }\n    }\n\n    // Divide the total viewport length (in pixels) proportionally based on the group width ratios.\n    const totalWidth = this.EndCoord - this.StartCoord;\n    this._groupWidths = this._groupWidthRatios.map((ratio) => {\n      return (ratio * totalWidth) / sum;\n    });\n\n    // Construct borderValues array which stores the the value location of the group boundaries.\n    this._borderValues = [];\n    for (let g = 0; g < this._groupWidthRatios.length - 1; g++) {\n      this._borderValues.push(g + 0.5);\n    }\n\n    // Construct borderCoords array which stores the coord location of the group boundaries.\n    this._borderCoords = [];\n    const anchor = Math.min(Math.max(Math.round(this.MinValue), 0), this._borderValues.length - 1);\n    this._borderCoords[anchor] =\n      this.StartCoord + (this._borderValues[anchor] - this.MinValue) * this._groupWidths[anchor];\n    for (\n      let g = anchor + 1;\n      g < this._borderValues.length;\n      g++ // compute borderCoords after the anchor\n    ) {\n      this._borderCoords[g] = this._borderCoords[g - 1] + this._groupWidths[g];\n    }\n    for (\n      let g = anchor - 1;\n      g >= 0;\n      g-- // compute borderCoords before the anchor\n    ) {\n      this._borderCoords[g] = this._borderCoords[g + 1] - this._groupWidths[g + 1];\n    }\n  }\n\n  transform(value: number) {\n    if (this._groupWidthRatios) {\n      // Find the anchor, i.e. the group boundary closest to the value.\n      let anchor = this._borderValues!.length;\n      for (let g = 0; g < this._borderValues!.length; g++) {\n        if (value <= this._borderValues![g]) {\n          anchor = g;\n          break;\n        }\n      }\n\n      // Compute the coord based on the group width at the anchor.\n      if (anchor == 0) {\n        return this._borderCoords![0] - this._groupWidths![0] * (this._borderValues![0] - value);\n      } else {\n        return (\n          this._borderCoords![anchor - 1] +\n          this._groupWidths![anchor] * (value - this._borderValues![anchor - 1])\n        );\n      }\n    }\n    return 0;\n  }\n\n  invert(coord: number) {\n    if (this._groupWidthRatios) {\n      // Find the anchor, i.e. the group boundary closest to the coord.\n      let anchor = this._borderCoords!.length;\n      for (let g = 0; g < this._borderCoords!.length; g++) {\n        if (coord <= this._borderCoords![g]) {\n          anchor = g;\n          break;\n        }\n      }\n      // Compute the value based on the group width at the anchor.\n      if (anchor == 0) {\n        return this._borderValues![0] - (this._borderCoords![0] - coord) / this._groupWidths![0];\n      } else {\n        return (\n          this._borderValues![anchor - 1] +\n          (coord - this._borderCoords![anchor - 1]) / this._groupWidths![anchor]\n        );\n      }\n    }\n    return 0;\n  }\n\n  domain() {\n    return this._domain;\n  }\n\n  range() {\n    return this._range;\n  }\n}\n"],"names":[],"mappings":"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"}