{"version":3,"file":"Label-5c64c52d.js","sources":["../../src/UNSAFE_Label/useDetectLabelTruncation.tsx","../../src/UNSAFE_Label/Label.tsx"],"sourcesContent":["import { RefObject } from 'preact';\nimport { useCallback, useRef, useState } from 'preact/hooks';\nimport { detectTruncation } from '#utils/PRIVATE_truncationUtils';\n\ntype Props = {\n  isDisabled?: boolean;\n  rootRef: RefObject<HTMLLabelElement>;\n};\n\n/**\n * Hook that detects truncated text when you hover the mouse over a label.\n */\nconst useDetectLabelTruncation = ({ isDisabled = false, rootRef }: Props) => {\n  const [isTextTruncated, setIsTextTruncated] = useState<boolean>(false);\n  const mouseOverTimerRef = useRef<ReturnType<typeof setTimeout> | undefined>();\n\n  const handleMouseOver = useCallback(() => {\n    clearTimeout(mouseOverTimerRef.current);\n    // Determine if the label is truncated after the user hovers over it.\n    mouseOverTimerRef.current = setTimeout(() => {\n      const isTruncated = detectTruncation(rootRef as RefObject<HTMLElement>);\n      setIsTextTruncated(isTruncated);\n    }, 1000);\n  }, [rootRef]);\n\n  const handleMouseOut = useCallback(() => {\n    clearTimeout(mouseOverTimerRef.current);\n    mouseOverTimerRef.current = undefined;\n    setIsTextTruncated(false);\n  }, []);\n\n  const detectTruncationProps = !isDisabled\n    ? {\n        onMouseOver: handleMouseOver,\n        onMouseOut: handleMouseOut\n      }\n    : {};\n\n  return { detectTruncationProps, isTextTruncated };\n};\n\nexport { useDetectLabelTruncation };\n","import { RefObject } from 'preact';\nimport { useRef } from 'preact/hooks';\nimport { useFormFieldContext } from '#hooks/UNSAFE_useFormFieldContext';\nimport { classNames } from '#utils/UNSAFE_classNames';\nimport { StyledComponentProps } from '@oracle/oraclejet-internal-utilities/typeUtils';\nimport { useFormContext } from '#hooks/UNSAFE_useFormContext';\nimport { useComponentTheme } from '#hooks/UNSAFE_useComponentTheme';\nimport { CompactLabelAssistance } from '#UNSAFE_UserAssistance';\n\nimport { useDetectLabelTruncation } from './useDetectLabelTruncation';\nimport { useTooltip } from '#hooks/UNSAFE_useTooltip';\n\nimport { LabelStyles, LabelVariantOptions } from './themes/LabelStyles.css';\nimport { TextFieldRedwoodTheme } from '#UNSAFE_TextField/themes/redwood/TextFieldTheme';\nimport { LabelRedwoodTheme } from './themes/redwood/LabelTheme';\nimport { useScale } from '#hooks/UNSAFE_useScale';\nimport { useDensity } from '#hooks/UNSAFE_useDensity';\nimport { getClientHints } from '#utils/PRIVATE_clientHints';\n\ntype StyleProps = Exclude<Props, 'children' | 'forId' | 'id'> & {\n  hasValue?: boolean;\n  isFocused?: boolean;\n  readonly?: boolean;\n  disabled?: boolean;\n};\n\ntype StyledLabelProps = StyledComponentProps<'label', StyleProps> & {\n  onClick?: (e: MouseEvent) => void;\n};\n\ntype TruncatingLabelProps = Omit<\n  StyledLabelProps,\n  | 'readonly'\n  | 'disabled'\n  | 'isRequiredShown'\n  | 'helpIconId'\n  | 'helpSourceLink'\n  | 'helpSourceText'\n  | 'parentComponentVariant'\n  | 'userAssistanceDensity'\n  | 'variant'\n>;\n\n// When you mouse over the label, useDetectLabelTruncation determines if the text is truncated\n// and shows a tooltip. When you move the mouse outside of the label, the tooltip goes away.\nconst TruncatingLabel = ({\n  children: text,\n  labelRef,\n  hasValue,\n  isFocused,\n  ...labelProps\n}: TruncatingLabelProps) => {\n  const labelElementRef = useRef<HTMLLabelElement>(null);\n  const ref = labelRef ?? labelElementRef;\n  const { detectTruncationProps, isTextTruncated } = useDetectLabelTruncation({ rootRef: ref });\n\n  // Calculate the tooltip offset so it looks like it's relative to the field instead of the label.\n  const scale = useScale() || 'lg';\n  const density = useDensity() || 'standard';\n  const scaleMap = { sm: 3, md: 3.5, lg: 4 };\n  const xUnits = scaleMap[scale];\n  const densityUnits = density === 'standard' ? 0 : -xUnits;\n  const mainAxisMap = {\n    sm: Math.max(xUnits + densityUnits, 3),\n    md: Math.max(1.14 * xUnits + densityUnits, 3.5),\n    lg: 2 * xUnits + densityUnits\n  };\n  const mainAxis =\n    hasValue || isFocused ? mainAxisMap[scale] + 5 : Math.max(5.75 * xUnits + densityUnits, 16);\n  const { tooltipContent, tooltipProps } = useTooltip({\n    offset: {\n      mainAxis,\n      crossAxis: -4 * xUnits - 1\n    },\n    position: 'top-start',\n    text,\n    isDisabled: !isTextTruncated\n  });\n  const { 'aria-describedby': notNeeded, ...tooltipEventHandlerProps } = tooltipProps;\n\n  return (\n    <>\n      <label ref={ref} {...detectTruncationProps} {...labelProps} {...tooltipEventHandlerProps}>\n        {text}\n      </label>\n      {tooltipContent}\n    </>\n  );\n};\n\nconst StyledLabel = ({\n  hasValue,\n  readonly,\n  disabled,\n  isFocused,\n  isRequiredShown,\n  labelRef,\n  helpIconId,\n  helpSourceLink,\n  helpSourceText,\n  userAssistanceDensity = 'reflow',\n  variant = 'inside',\n  parentComponentVariant = 'textField',\n  ...props\n}: StyledLabelProps) => {\n  const { isFormLayout, isReadonly: isReadonlyForm, labelWrapping } = useFormContext();\n\n  const isInside = variant === 'inside';\n  const isTextField = parentComponentVariant === 'textField';\n  const clientHints = getClientHints();\n\n  // JET-73197: Truncated tooltips for core pack.\n  // Determine whether to render a TruncatingLabel, which is measured to determine if\n  // the label's content exceeds the size of the label itself, i.e. it's truncated.\n  // We only want to do this for inside label edge, not disabled, and the textField variant.\n  const useTruncatingLabel = isInside && !disabled && parentComponentVariant === 'textField';\n\n  // because variants have to match strings, we have to take any boolean props and convert\n  // them to a string value, (ie prefixed with \"is\" or \"non\")\n  const {\n    classes,\n    styles: {\n      safariAfter,\n      uaDensityCompactLabel,\n      uaDensityCompactLabelStart,\n      uaDensityCompactLabelTopInside\n    }\n  } = useComponentTheme<LabelVariantOptions, LabelStyles>(LabelRedwoodTheme, {\n    labelWrapping,\n    position: variant,\n    inside: isInside ? 'isInside' : 'notInside',\n    inEnabledForm: isFormLayout && !isReadonlyForm ? 'isInEnabledForm' : 'notInEnabledForm',\n    readonly: readonly ? 'isReadonly' : 'notReadonly',\n    focused: isFocused ? 'isFocused' : 'nonFocused',\n    formLayout: isFormLayout ? 'isFormLayout' : 'nonFormLayout',\n    readonlyForm: isReadonlyForm ? 'isReadonlyForm' : 'notReadonlyForm',\n    textField: isTextField ? 'isTextField' : 'notTextField',\n    value: hasValue ? 'hasValue' : 'noValue',\n    valueOrFocus: hasValue || isFocused ? 'hasValueOrFocus' : 'noValueOrFocus',\n    animatedWhenInside: isTextField ? 'isAnimated' : 'notAnimated',\n    disabled: isTextField && disabled ? 'isDisabled' : 'nonDisabled',\n    userAssistanceDensity\n  });\n\n  const { baseTheme: textFieldTheme } = useComponentTheme(TextFieldRedwoodTheme);\n  // JET-74754: Fix dual tooltips on Safari. This prevents safari from putting\n  // up its own tooltip for truncated labels.\n  const afterClass = clientHints.browser === 'safari' ? safariAfter : undefined;\n\n  // TODO: We need to decide whether to standardize on 'class' or 'className'.  Otherwise, we'll\n  // run into issues destructuring style interpolations, for example having to concatenate both.\n\n  const compactLabelStyles = classNames([\n    afterClass,\n    uaDensityCompactLabel,\n    variant === 'start' ? uaDensityCompactLabelStart : uaDensityCompactLabelTopInside\n  ]);\n  const compactUADLabel = useTruncatingLabel ? (\n    <TruncatingLabel\n      {...props}\n      class={compactLabelStyles}\n      hasValue={hasValue}\n      isFocused={isFocused}\n      labelRef={labelRef}\n    />\n  ) : (\n    <label {...props} class={compactLabelStyles} />\n  );\n\n  return userAssistanceDensity === 'compact' ? (\n    <div class={classNames([classes, textFieldTheme])}>\n      {variant !== 'start' && compactUADLabel}\n      <CompactLabelAssistance\n        isRequiredShown={isRequiredShown}\n        helpIconId={helpIconId}\n        helpSourceLink={helpSourceLink}\n        helpSourceText={helpSourceText}\n        labelEdge={variant === 'top' || variant === 'start' ? variant : 'inside'}\n      />\n      {variant === 'start' && compactUADLabel}\n    </div>\n  ) : useTruncatingLabel ? (\n    <TruncatingLabel\n      {...props}\n      class={classNames([afterClass, classes, textFieldTheme])}\n      hasValue={hasValue}\n      isFocused={isFocused}\n      labelRef={labelRef}\n    />\n  ) : (\n    <label\n      // JET-71582  Adding aria-disabled for components that don't have a disabled input element. AXE isn't able\n      // to determine that the label belongs to a disabled field, so it throwing a contrast error in the webdriverjs\n      // tests.\n      aria-disabled={disabled ? 'true' : undefined}\n      {...props}\n      class={classNames([afterClass, classes, textFieldTheme])}\n    />\n  );\n};\n\ntype Props = {\n  /**\n   * Specifies how messages and assistive text are shown.\n   */\n  userAssistanceDensity?: 'reflow' | 'efficient' | 'compact';\n  /**\n   * Id to use for the help icon in compact user assistance density.\n   */\n  helpIconId?: string;\n  /**\n   * Help source link for compact user assistance density.\n   */\n  helpSourceLink?: string;\n  /**\n   * Help source text for compact user assistance density.\n   */\n  helpSourceText?: string;\n  /**\n   * Specifies whether to show an indicator on screen that a value is required, for example\n   * before the user has committed a value.\n   */\n  isRequiredShown?: boolean;\n  /**\n   * The text to be used for the label\n   */\n  children?: string;\n  /**\n   * The id to set on the label\n   */\n  id?: string;\n  /**\n   * The id of the form control for which this label will be used\n   */\n  forId?: string;\n  /**\n   * Determines how the label is going to be styled\n   */\n  variant?: 'inside' | 'start' | 'top';\n  /**\n   * Determines how the label is going to be styled in based on parent component.\n   */\n  parentComponentVariant?:\n    | 'textField'\n    | 'radioSet'\n    | 'checkboxSet'\n    | 'richRadioSet'\n    | 'richCheckboxSet'\n    | 'formComponentWrapper';\n  /**\n   * Handler called when the label is clicked.\n   */\n  onClick?: (e: MouseEvent) => void;\n  /**\n   * A ref to the intrinsic label.\n   */\n  labelRef?: RefObject<HTMLLabelElement>;\n};\n\nexport const Label = ({ forId, ...props }: Props) => {\n  const { hasValue, isDisabled, isFocused, isReadonly } = useFormFieldContext();\n  return (\n    <StyledLabel\n      for={forId}\n      hasValue={hasValue}\n      disabled={isDisabled}\n      isFocused={isFocused}\n      readonly={isReadonly}\n      {...props}\n    />\n  );\n};\n"],"names":["_jsxs","_Fragment","_jsx"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AASA;;AAEG;AACH,MAAM,wBAAwB,GAAG,CAAC,EAAE,UAAU,GAAG,KAAK,EAAE,OAAO,EAAS,KAAI;IAC1E,MAAM,CAAC,eAAe,EAAE,kBAAkB,CAAC,GAAG,QAAQ,CAAU,KAAK,CAAC,CAAC;AACvE,IAAA,MAAM,iBAAiB,GAAG,MAAM,EAA6C,CAAC;AAE9E,IAAA,MAAM,eAAe,GAAG,WAAW,CAAC,MAAK;AACvC,QAAA,YAAY,CAAC,iBAAiB,CAAC,OAAO,CAAC,CAAC;;AAExC,QAAA,iBAAiB,CAAC,OAAO,GAAG,UAAU,CAAC,MAAK;AAC1C,YAAA,MAAM,WAAW,GAAG,gBAAgB,CAAC,OAAiC,CAAC,CAAC;YACxE,kBAAkB,CAAC,WAAW,CAAC,CAAC;SACjC,EAAE,IAAI,CAAC,CAAC;AACX,KAAC,EAAE,CAAC,OAAO,CAAC,CAAC,CAAC;AAEd,IAAA,MAAM,cAAc,GAAG,WAAW,CAAC,MAAK;AACtC,QAAA,YAAY,CAAC,iBAAiB,CAAC,OAAO,CAAC,CAAC;AACxC,QAAA,iBAAiB,CAAC,OAAO,GAAG,SAAS,CAAC;QACtC,kBAAkB,CAAC,KAAK,CAAC,CAAC;KAC3B,EAAE,EAAE,CAAC,CAAC;IAEP,MAAM,qBAAqB,GAAG,CAAC,UAAU;AACvC,UAAE;AACE,YAAA,WAAW,EAAE,eAAe;AAC5B,YAAA,UAAU,EAAE,cAAc;AAC3B,SAAA;UACD,EAAE,CAAC;AAEP,IAAA,OAAO,EAAE,qBAAqB,EAAE,eAAe,EAAE,CAAC;AACpD,CAAC;;ACID;AACA;AACA,MAAM,eAAe,GAAG,CAAC,EACvB,QAAQ,EAAE,IAAI,EACd,QAAQ,EACR,QAAQ,EACR,SAAS,EACT,GAAG,UAAU,EACQ,KAAI;AACzB,IAAA,MAAM,eAAe,GAAG,MAAM,CAAmB,IAAI,CAAC,CAAC;AACvD,IAAA,MAAM,GAAG,GAAG,QAAQ,IAAI,eAAe,CAAC;AACxC,IAAA,MAAM,EAAE,qBAAqB,EAAE,eAAe,EAAE,GAAG,wBAAwB,CAAC,EAAE,OAAO,EAAE,GAAG,EAAE,CAAC,CAAC;;AAG9F,IAAA,MAAM,KAAK,GAAG,QAAQ,EAAE,IAAI,IAAI,CAAC;AACjC,IAAA,MAAM,OAAO,GAAG,UAAU,EAAE,IAAI,UAAU,CAAC;AAC3C,IAAA,MAAM,QAAQ,GAAG,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,GAAG,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC;AAC3C,IAAA,MAAM,MAAM,GAAG,QAAQ,CAAC,KAAK,CAAC,CAAC;AAC/B,IAAA,MAAM,YAAY,GAAG,OAAO,KAAK,UAAU,GAAG,CAAC,GAAG,CAAC,MAAM,CAAC;AAC1D,IAAA,MAAM,WAAW,GAAG;QAClB,EAAE,EAAE,IAAI,CAAC,GAAG,CAAC,MAAM,GAAG,YAAY,EAAE,CAAC,CAAC;AACtC,QAAA,EAAE,EAAE,IAAI,CAAC,GAAG,CAAC,IAAI,GAAG,MAAM,GAAG,YAAY,EAAE,GAAG,CAAC;AAC/C,QAAA,EAAE,EAAE,CAAC,GAAG,MAAM,GAAG,YAAY;KAC9B,CAAC;AACF,IAAA,MAAM,QAAQ,GACZ,QAAQ,IAAI,SAAS,GAAG,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,GAAG,MAAM,GAAG,YAAY,EAAE,EAAE,CAAC,CAAC;AAC9F,IAAA,MAAM,EAAE,cAAc,EAAE,YAAY,EAAE,GAAG,UAAU,CAAC;AAClD,QAAA,MAAM,EAAE;YACN,QAAQ;AACR,YAAA,SAAS,EAAE,CAAC,CAAC,GAAG,MAAM,GAAG,CAAC;AAC3B,SAAA;AACD,QAAA,QAAQ,EAAE,WAAW;QACrB,IAAI;QACJ,UAAU,EAAE,CAAC,eAAe;AAC7B,KAAA,CAAC,CAAC;IACH,MAAM,EAAE,kBAAkB,EAAE,SAAS,EAAE,GAAG,wBAAwB,EAAE,GAAG,YAAY,CAAC;AAEpF,IAAA,QACEA,IACE,CAAAC,QAAA,EAAA,EAAA,QAAA,EAAA,CAAAC,GAAA,CAAA,OAAA,EAAA,EAAO,GAAG,EAAE,GAAG,KAAM,qBAAqB,EAAA,GAAM,UAAU,EAAM,GAAA,wBAAwB,YACrF,IAAI,EAAA,CACC,EACP,cAAc,CAAA,EAAA,CACd,EACH;AACJ,CAAC,CAAC;AAEF,MAAM,WAAW,GAAG,CAAC,EACnB,QAAQ,EACR,QAAQ,EACR,QAAQ,EACR,SAAS,EACT,eAAe,EACf,QAAQ,EACR,UAAU,EACV,cAAc,EACd,cAAc,EACd,qBAAqB,GAAG,QAAQ,EAChC,OAAO,GAAG,QAAQ,EAClB,sBAAsB,GAAG,WAAW,EACpC,GAAG,KAAK,EACS,KAAI;AACrB,IAAA,MAAM,EAAE,YAAY,EAAE,UAAU,EAAE,cAAc,EAAE,aAAa,EAAE,GAAG,cAAc,EAAE,CAAC;AAErF,IAAA,MAAM,QAAQ,GAAG,OAAO,KAAK,QAAQ,CAAC;AACtC,IAAA,MAAM,WAAW,GAAG,sBAAsB,KAAK,WAAW,CAAC;AAC3D,IAAA,MAAM,WAAW,GAAG,cAAc,EAAE,CAAC;;;;;IAMrC,MAAM,kBAAkB,GAAG,QAAQ,IAAI,CAAC,QAAQ,IAAI,sBAAsB,KAAK,WAAW,CAAC;;;AAI3F,IAAA,MAAM,EACJ,OAAO,EACP,MAAM,EAAE,EACN,WAAW,EACX,qBAAqB,EACrB,0BAA0B,EAC1B,8BAA8B,EAC/B,EACF,GAAG,iBAAiB,CAAmC,iBAAiB,EAAE;QACzE,aAAa;AACb,QAAA,QAAQ,EAAE,OAAO;QACjB,MAAM,EAAE,QAAQ,GAAG,UAAU,GAAG,WAAW;AAC3C,QAAA,aAAa,EAAE,YAAY,IAAI,CAAC,cAAc,GAAG,iBAAiB,GAAG,kBAAkB;QACvF,QAAQ,EAAE,QAAQ,GAAG,YAAY,GAAG,aAAa;QACjD,OAAO,EAAE,SAAS,GAAG,WAAW,GAAG,YAAY;QAC/C,UAAU,EAAE,YAAY,GAAG,cAAc,GAAG,eAAe;QAC3D,YAAY,EAAE,cAAc,GAAG,gBAAgB,GAAG,iBAAiB;QACnE,SAAS,EAAE,WAAW,GAAG,aAAa,GAAG,cAAc;QACvD,KAAK,EAAE,QAAQ,GAAG,UAAU,GAAG,SAAS;QACxC,YAAY,EAAE,QAAQ,IAAI,SAAS,GAAG,iBAAiB,GAAG,gBAAgB;QAC1E,kBAAkB,EAAE,WAAW,GAAG,YAAY,GAAG,aAAa;QAC9D,QAAQ,EAAE,WAAW,IAAI,QAAQ,GAAG,YAAY,GAAG,aAAa;QAChE,qBAAqB;AACtB,KAAA,CAAC,CAAC;IAEH,MAAM,EAAE,SAAS,EAAE,cAAc,EAAE,GAAG,iBAAiB,CAAC,qBAAqB,CAAC,CAAC;;;AAG/E,IAAA,MAAM,UAAU,GAAG,WAAW,CAAC,OAAO,KAAK,QAAQ,GAAG,WAAW,GAAG,SAAS,CAAC;;;IAK9E,MAAM,kBAAkB,GAAG,UAAU,CAAC;QACpC,UAAU;QACV,qBAAqB;QACrB,OAAO,KAAK,OAAO,GAAG,0BAA0B,GAAG,8BAA8B;AAClF,KAAA,CAAC,CAAC;AACH,IAAA,MAAM,eAAe,GAAG,kBAAkB,IACxCA,GAAC,CAAA,eAAe,EACV,EAAA,GAAA,KAAK,EACT,KAAK,EAAE,kBAAkB,EACzB,QAAQ,EAAE,QAAQ,EAClB,SAAS,EAAE,SAAS,EACpB,QAAQ,EAAE,QAAQ,EAAA,CAClB,KAEFA,GAAA,CAAA,OAAA,EAAA,EAAA,GAAW,KAAK,EAAE,KAAK,EAAE,kBAAkB,EAAA,CAAI,CAChD,CAAC;AAEF,IAAA,OAAO,qBAAqB,KAAK,SAAS,IACxCF,IAAK,CAAA,KAAA,EAAA,EAAA,KAAK,EAAE,UAAU,CAAC,CAAC,OAAO,EAAE,cAAc,CAAC,CAAC,EAC9C,QAAA,EAAA,CAAA,OAAO,KAAK,OAAO,IAAI,eAAe,EACvCE,GAAC,CAAA,sBAAsB,EACrB,EAAA,eAAe,EAAE,eAAe,EAChC,UAAU,EAAE,UAAU,EACtB,cAAc,EAAE,cAAc,EAC9B,cAAc,EAAE,cAAc,EAC9B,SAAS,EAAE,OAAO,KAAK,KAAK,IAAI,OAAO,KAAK,OAAO,GAAG,OAAO,GAAG,QAAQ,EACxE,CAAA,EACD,OAAO,KAAK,OAAO,IAAI,eAAe,CACnC,EAAA,CAAA,IACJ,kBAAkB,IACpBA,GAAA,CAAC,eAAe,EAAA,EAAA,GACV,KAAK,EACT,KAAK,EAAE,UAAU,CAAC,CAAC,UAAU,EAAE,OAAO,EAAE,cAAc,CAAC,CAAC,EACxD,QAAQ,EAAE,QAAQ,EAClB,SAAS,EAAE,SAAS,EACpB,QAAQ,EAAE,QAAQ,EAAA,CAClB,KAEFA,GAIiB,CAAA,OAAA,EAAA,EAAA,eAAA,EAAA,QAAQ,GAAG,MAAM,GAAG,SAAS,EAAA,GACxC,KAAK,EACT,KAAK,EAAE,UAAU,CAAC,CAAC,UAAU,EAAE,OAAO,EAAE,cAAc,CAAC,CAAC,EAAA,CACxD,CACH,CAAC;AACJ,CAAC,CAAC;AA4DK,MAAM,KAAK,GAAG,CAAC,EAAE,KAAK,EAAE,GAAG,KAAK,EAAS,KAAI;AAClD,IAAA,MAAM,EAAE,QAAQ,EAAE,UAAU,EAAE,SAAS,EAAE,UAAU,EAAE,GAAG,mBAAmB,EAAE,CAAC;IAC9E,QACEA,GAAC,CAAA,WAAW,EACV,EAAA,GAAG,EAAE,KAAK,EACV,QAAQ,EAAE,QAAQ,EAClB,QAAQ,EAAE,UAAU,EACpB,SAAS,EAAE,SAAS,EACpB,QAAQ,EAAE,UAAU,EAChB,GAAA,KAAK,EACT,CAAA,EACF;AACJ;;;;"}