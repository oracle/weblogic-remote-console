{"version":3,"file":"truncationUtils-e37f95ee.js","sources":["../../src/utils/PRIVATE_truncationUtils/truncationUtils.ts"],"sourcesContent":["import { RefObject } from 'preact';\n\n/**\n * Default Redwood line-height overrides cause false positives as the Range sizes are always\n * for a 'normal' line-height, and none of the default scale fonts have 'normal' line-height\n * values. This causes offsets of between 0.5px and 1.5px. As a true truncation will cause\n * an offset of closer to a full line height (at least 12px for 2xs text), use a larger offset\n * value than the currently observed 1.5px max to reduce the likelihood of false positives.\n */\nconst verticalTruncationOffset = 5;\n\n/**\n * On Chrome it appears that sometimes there is a very slight difference between the\n * untruncatedText.width and the renderedText.width on the order of 0.00000[more numbers].\n * It only seems to happen for certain strings, so it might be related to font rendering.\n * In any case, in order to address this we use a horizontalTruncationOffset\n * to reduce false positives.\n */\nconst horizontalTruncationOffset = 1;\n\n/**\n * Returns true if the size of an element's node contents exceeds the size\n * of the element itself.\n * @param rootRef An element ref\n */\nexport const detectTruncation = (rootRef: RefObject<HTMLElement>) => {\n  if (rootRef.current) {\n    const element = rootRef.current;\n    const range = new Range();\n    range.selectNodeContents(element);\n    const untruncatedText = range.getBoundingClientRect();\n    const renderedText = element.getBoundingClientRect();\n    const computedStyles = getComputedStyle(element);\n    const padding =\n      parseFloat(computedStyles.paddingLeft) + parseFloat(computedStyles.paddingRight);\n    const border = parseFloat(computedStyles.borderLeft) + parseFloat(computedStyles.borderRight);\n    const truncated =\n      untruncatedText.width > renderedText.width - padding - border + horizontalTruncationOffset ||\n      untruncatedText.height > renderedText.height + verticalTruncationOffset;\n    return truncated;\n  }\n  return false;\n};\n"],"names":[],"mappings":";AAEA;;;;;;AAMG;AACH,MAAM,wBAAwB,GAAG,CAAC,CAAC;AAEnC;;;;;;AAMG;AACH,MAAM,0BAA0B,GAAG,CAAC,CAAC;AAErC;;;;AAIG;AACU,MAAA,gBAAgB,GAAG,CAAC,OAA+B,KAAI;AAClE,IAAA,IAAI,OAAO,CAAC,OAAO,EAAE;AACnB,QAAA,MAAM,OAAO,GAAG,OAAO,CAAC,OAAO,CAAC;AAChC,QAAA,MAAM,KAAK,GAAG,IAAI,KAAK,EAAE,CAAC;AAC1B,QAAA,KAAK,CAAC,kBAAkB,CAAC,OAAO,CAAC,CAAC;AAClC,QAAA,MAAM,eAAe,GAAG,KAAK,CAAC,qBAAqB,EAAE,CAAC;AACtD,QAAA,MAAM,YAAY,GAAG,OAAO,CAAC,qBAAqB,EAAE,CAAC;AACrD,QAAA,MAAM,cAAc,GAAG,gBAAgB,CAAC,OAAO,CAAC,CAAC;AACjD,QAAA,MAAM,OAAO,GACX,UAAU,CAAC,cAAc,CAAC,WAAW,CAAC,GAAG,UAAU,CAAC,cAAc,CAAC,YAAY,CAAC,CAAC;AACnF,QAAA,MAAM,MAAM,GAAG,UAAU,CAAC,cAAc,CAAC,UAAU,CAAC,GAAG,UAAU,CAAC,cAAc,CAAC,WAAW,CAAC,CAAC;AAC9F,QAAA,MAAM,SAAS,GACb,eAAe,CAAC,KAAK,GAAG,YAAY,CAAC,KAAK,GAAG,OAAO,GAAG,MAAM,GAAG,0BAA0B;YAC1F,eAAe,CAAC,MAAM,GAAG,YAAY,CAAC,MAAM,GAAG,wBAAwB,CAAC;AAC1E,QAAA,OAAO,SAAS,CAAC;KAClB;AACD,IAAA,OAAO,KAAK,CAAC;AACf;;;;"}