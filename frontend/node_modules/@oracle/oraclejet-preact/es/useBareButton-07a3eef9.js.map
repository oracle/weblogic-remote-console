{"version":3,"file":"useBareButton-07a3eef9.js","sources":["../../src/hooks/UNSAFE_useBareButton/useBareButton.ts"],"sourcesContent":["/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * Licensed under The Universal Permissive License (UPL), Vers.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\nimport type { ComponentChildren, JSX } from 'preact';\nimport { usePress } from '../UNSAFE_usePress';\nimport { usePressClick } from '../UNSAFE_usePressClick';\nimport { useTabbableMode } from '../UNSAFE_useTabbableMode';\nimport { getClientHints } from '../../utils/PRIVATE_clientHints';\nimport { mergeProps } from '../../utils/UNSAFE_mergeProps';\nimport type { UnpackSignals } from '../../utils/UNSAFE_attributeUtils';\nimport { processGlobals } from '../../utils/UNSAFE_buttonUtils';\nimport type {\n  ButtonIntrinsicProps,\n  ButtonIntrinsicAriaProps\n} from '../../utils/UNSAFE_buttonUtils';\nimport { useTestId, TestIdProps } from '../UNSAFE_useTestId';\n\n/**\n * The ActionDetail reasons\n */\nexport type ActionDetail = {\n  reason: 'pointer' | 'keyboard';\n};\n\n/**\n * Element details\n */\nexport type BareButtonElementDetails =\n  | {\n      type: 'button';\n      isFocusable?: never;\n      buttonType?: 'button' | 'submit';\n      isLabel?: never;\n      isSwitch?: boolean;\n    }\n  | {\n      type: 'a';\n      buttonType?: never;\n      href: string;\n      target?: string;\n      rel?: string;\n      isFocusable?: never;\n      isLabel?: never;\n      isSwitch?: never;\n    }\n  | {\n      type: 'span';\n      buttonType?: never;\n      isFocusable?: boolean;\n      isLabel?: boolean;\n      isSwitch?: boolean;\n    }\n  | {\n      type: 'div';\n      buttonType?: never;\n      isFocusable?: boolean;\n      isLabel?: boolean;\n      isSwitch?: boolean;\n    };\n\nexport type BareButtonProps = ButtonIntrinsicProps &\n  ButtonIntrinsicAriaProps &\n  TestIdProps & {\n    /**\n     *The default slot is the button's text label. The oj-c-base-button element accepts plain text or DOM nodes as children for the default slot.\"\n     */\n    children?: ComponentChildren;\n\n    /**\n     * Specifies that the button element should be disabled.\n     */\n    isDisabled?: boolean;\n\n    /**\n     * Specifies if repeated events are dispatched for key or pointer held down\n     */\n    isRepeat?: boolean;\n\n    /**\n     * Specifies if Button should use only a click handler, not keyup/down, ptr up/down\n     */\n    isClick?: boolean;\n\n    /**\n     * Triggered when a button is clicked, whether by keyboard, mouse, or touch events.\n     */\n    onAction?: (details: ActionDetail) => void;\n\n    /**\n     * Indicate element type and associated details\n     */\n    elementDetails?: BareButtonElementDetails;\n  };\n\nconst roleProps = (\n  elType: string,\n  hidden: boolean,\n  isFocusable: boolean,\n  isLabel: boolean,\n  isSwitch: boolean\n): { role?: UnpackSignals<JSX.HTMLAttributes['role']> } => {\n  switch (elType) {\n    case 'link':\n      return { role: 'link' };\n    case 'button':\n      return isSwitch ? { role: 'switch' } : {};\n    case 'div':\n      return hidden ? {} : { role: 'button' };\n    case 'span':\n      return isLabel\n        ? {}\n        : hidden\n        ? { role: 'none' }\n        : isFocusable\n        ? isSwitch\n          ? { role: 'switch' }\n          : { role: 'button' }\n        : { role: 'img' };\n    default:\n      return hidden ? { role: 'none' } : isFocusable ? { role: 'button' } : { role: 'img' };\n  }\n};\n\n/**\n * BareButtons are unformatted bare buttons that direct users to initiate or take actions and work with a single tap, click, or keystroke.\n */\nexport function useBareButton({\n  onAction,\n  isDisabled,\n  isRepeat,\n  isClick,\n  elementDetails = { type: 'button', buttonType: 'button' },\n  testId,\n  ...props\n}: BareButtonProps) {\n  const clientHints = getClientHints();\n  // :active only works on IOS devices if a touch handler exists\n  const iosProps = clientHints.platform === 'ios' ? { ontouchstart: function () {} } : {};\n\n  const pressHandler = (e: Event) => {\n    if (onAction) {\n      onAction({\n        reason: (e as PointerEvent).pointerType == '' ? 'keyboard' : 'pointer'\n      });\n    }\n  };\n  const {\n    globalEventProps,\n    ariaProps: { 'aria-disabled': ariaDisabled, 'aria-hidden': ariaHidden, ...ariaOtherProps }\n  } = processGlobals(props);\n\n  const { pressProps } = usePress(pressHandler, {\n    isDisabled: isDisabled,\n    isRepeat\n  });\n\n  const { pressProps: pressClickProps } = usePressClick(pressHandler, {\n    isDisabled: isDisabled\n  });\n\n  const {\n    type: elementType = 'button',\n    isFocusable: isElementFocusable = true,\n    isLabel: isElementLabel = false,\n    isSwitch: isElementSwitch = false,\n    ...elementProps\n  } = { ...elementDetails };\n\n  const buttonType =\n    elementDetails.type === 'button' ? elementDetails.buttonType ?? 'button' : undefined;\n  const typeProps =\n    elementDetails.type === 'button' && elementDetails.buttonType === 'button'\n      ? { type: buttonType }\n      : {};\n\n  // 'role' should be 'none' when aria-hidden is true or 'img' when false and not focusable\n  const role = roleProps(\n    elementType,\n    Boolean(ariaHidden),\n    isElementFocusable ?? false,\n    isElementLabel ?? false,\n    isElementSwitch ?? false\n  );\n  const ElementType = elementDetails?.type;\n  const isSpan = ElementType == 'span';\n  const isBareButton = ElementType == 'button';\n  const { tabbableModeProps } = useTabbableMode(isDisabled);\n\n  const arDisabled =\n    ElementType == 'button'\n      ? ariaDisabled\n        ? { 'aria-disabled': ariaDisabled }\n        : {}\n      : isDisabled\n      ? { 'aria-disabled': isDisabled }\n      : {};\n\n  const arHidden = ElementType === 'div' ? {} : { 'aria-hidden': ariaHidden };\n\n  const adjustedAriaProps =\n    role.role === 'none' ? {} : mergeProps(arDisabled, arHidden, ariaOtherProps);\n\n  const testIdProps = useTestId(testId);\n\n  const getTabIndex = () => {\n    if ((isSpan && (isElementFocusable === false || isDisabled)) || (isBareButton && isDisabled)) {\n      // no tabIndex value should be defined for disabled button elements and non-focusable or disabled span elements\n      return { tabIndex: undefined };\n    }\n    return tabbableModeProps;\n  };\n\n  const legacyGlobals = {\n    autofocus: props.autofocus,\n    title: props.title,\n    disabled: isDisabled\n  };\n\n  return mergeProps(\n    elementProps,\n    onAction ? (isRepeat || (isClick ?? isBareButton) ? pressClickProps : pressProps) : {},\n    iosProps,\n    globalEventProps,\n    adjustedAriaProps,\n    getTabIndex(),\n    typeProps,\n    testIdProps,\n    role,\n    legacyGlobals\n  );\n}\n"],"names":[],"mappings":";;;;;;;;;;AAkGA,MAAM,SAAS,GAAG,CAChB,MAAc,EACd,MAAe,EACf,WAAoB,EACpB,OAAgB,EAChB,QAAiB,KACuC;IACxD,QAAQ,MAAM;AACZ,QAAA,KAAK,MAAM;AACT,YAAA,OAAO,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;AAC1B,QAAA,KAAK,QAAQ;AACX,YAAA,OAAO,QAAQ,GAAG,EAAE,IAAI,EAAE,QAAQ,EAAE,GAAG,EAAE,CAAC;AAC5C,QAAA,KAAK,KAAK;AACR,YAAA,OAAO,MAAM,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE,QAAQ,EAAE,CAAC;AAC1C,QAAA,KAAK,MAAM;AACT,YAAA,OAAO,OAAO;AACZ,kBAAE,EAAE;AACJ,kBAAE,MAAM;AACR,sBAAE,EAAE,IAAI,EAAE,MAAM,EAAE;AAClB,sBAAE,WAAW;AACb,0BAAE,QAAQ;AACR,8BAAE,EAAE,IAAI,EAAE,QAAQ,EAAE;AACpB,8BAAE,EAAE,IAAI,EAAE,QAAQ,EAAE;AACtB,0BAAE,EAAE,IAAI,EAAE,KAAK,EAAE,CAAC;AACtB,QAAA;AACE,YAAA,OAAO,MAAM,GAAG,EAAE,IAAI,EAAE,MAAM,EAAE,GAAG,WAAW,GAAG,EAAE,IAAI,EAAE,QAAQ,EAAE,GAAG,EAAE,IAAI,EAAE,KAAK,EAAE,CAAC;KACzF;AACH,CAAC,CAAC;AAEF;;AAEG;AACa,SAAA,aAAa,CAAC,EAC5B,QAAQ,EACR,UAAU,EACV,QAAQ,EACR,OAAO,EACP,cAAc,GAAG,EAAE,IAAI,EAAE,QAAQ,EAAE,UAAU,EAAE,QAAQ,EAAE,EACzD,MAAM,EACN,GAAG,KAAK,EACQ,EAAA;AAChB,IAAA,MAAM,WAAW,GAAG,cAAc,EAAE,CAAC;;IAErC,MAAM,QAAQ,GAAG,WAAW,CAAC,QAAQ,KAAK,KAAK,GAAG,EAAE,YAAY,EAAE,eAAc,EAAE,GAAG,EAAE,CAAC;AAExF,IAAA,MAAM,YAAY,GAAG,CAAC,CAAQ,KAAI;QAChC,IAAI,QAAQ,EAAE;AACZ,YAAA,QAAQ,CAAC;AACP,gBAAA,MAAM,EAAG,CAAkB,CAAC,WAAW,IAAI,EAAE,GAAG,UAAU,GAAG,SAAS;AACvE,aAAA,CAAC,CAAC;SACJ;AACH,KAAC,CAAC;IACF,MAAM,EACJ,gBAAgB,EAChB,SAAS,EAAE,EAAE,eAAe,EAAE,YAAY,EAAE,aAAa,EAAE,UAAU,EAAE,GAAG,cAAc,EAAE,EAC3F,GAAG,cAAc,CAAC,KAAK,CAAC,CAAC;AAE1B,IAAA,MAAM,EAAE,UAAU,EAAE,GAAG,QAAQ,CAAC,YAAY,EAAE;AAC5C,QAAA,UAAU,EAAE,UAAU;QACtB,QAAQ;AACT,KAAA,CAAC,CAAC;IAEH,MAAM,EAAE,UAAU,EAAE,eAAe,EAAE,GAAG,aAAa,CAAC,YAAY,EAAE;AAClE,QAAA,UAAU,EAAE,UAAU;AACvB,KAAA,CAAC,CAAC;AAEH,IAAA,MAAM,EACJ,IAAI,EAAE,WAAW,GAAG,QAAQ,EAC5B,WAAW,EAAE,kBAAkB,GAAG,IAAI,EACtC,OAAO,EAAE,cAAc,GAAG,KAAK,EAC/B,QAAQ,EAAE,eAAe,GAAG,KAAK,EACjC,GAAG,YAAY,EAChB,GAAG,EAAE,GAAG,cAAc,EAAE,CAAC;AAE1B,IAAA,MAAM,UAAU,GACd,cAAc,CAAC,IAAI,KAAK,QAAQ,GAAG,cAAc,CAAC,UAAU,IAAI,QAAQ,GAAG,SAAS,CAAC;AACvF,IAAA,MAAM,SAAS,GACb,cAAc,CAAC,IAAI,KAAK,QAAQ,IAAI,cAAc,CAAC,UAAU,KAAK,QAAQ;AACxE,UAAE,EAAE,IAAI,EAAE,UAAU,EAAE;UACpB,EAAE,CAAC;;IAGT,MAAM,IAAI,GAAG,SAAS,CACpB,WAAW,EACX,OAAO,CAAC,UAAU,CAAC,EACnB,kBAAkB,IAAI,KAAK,EAC3B,cAAc,IAAI,KAAK,EACvB,eAAe,IAAI,KAAK,CACzB,CAAC;AACF,IAAA,MAAM,WAAW,GAAG,cAAc,EAAE,IAAI,CAAC;AACzC,IAAA,MAAM,MAAM,GAAG,WAAW,IAAI,MAAM,CAAC;AACrC,IAAA,MAAM,YAAY,GAAG,WAAW,IAAI,QAAQ,CAAC;IAC7C,MAAM,EAAE,iBAAiB,EAAE,GAAG,eAAe,CAAC,UAAU,CAAC,CAAC;AAE1D,IAAA,MAAM,UAAU,GACd,WAAW,IAAI,QAAQ;AACrB,UAAE,YAAY;AACZ,cAAE,EAAE,eAAe,EAAE,YAAY,EAAE;AACnC,cAAE,EAAE;AACN,UAAE,UAAU;AACZ,cAAE,EAAE,eAAe,EAAE,UAAU,EAAE;cAC/B,EAAE,CAAC;AAET,IAAA,MAAM,QAAQ,GAAG,WAAW,KAAK,KAAK,GAAG,EAAE,GAAG,EAAE,aAAa,EAAE,UAAU,EAAE,CAAC;IAE5E,MAAM,iBAAiB,GACrB,IAAI,CAAC,IAAI,KAAK,MAAM,GAAG,EAAE,GAAG,UAAU,CAAC,UAAU,EAAE,QAAQ,EAAE,cAAc,CAAC,CAAC;AAE/E,IAAA,MAAM,WAAW,GAAG,SAAS,CAAC,MAAM,CAAC,CAAC;IAEtC,MAAM,WAAW,GAAG,MAAK;AACvB,QAAA,IAAI,CAAC,MAAM,KAAK,kBAAkB,KAAK,KAAK,IAAI,UAAU,CAAC,MAAM,YAAY,IAAI,UAAU,CAAC,EAAE;;AAE5F,YAAA,OAAO,EAAE,QAAQ,EAAE,SAAS,EAAE,CAAC;SAChC;AACD,QAAA,OAAO,iBAAiB,CAAC;AAC3B,KAAC,CAAC;AAEF,IAAA,MAAM,aAAa,GAAG;QACpB,SAAS,EAAE,KAAK,CAAC,SAAS;QAC1B,KAAK,EAAE,KAAK,CAAC,KAAK;AAClB,QAAA,QAAQ,EAAE,UAAU;KACrB,CAAC;IAEF,OAAO,UAAU,CACf,YAAY,EACZ,QAAQ,IAAI,QAAQ,KAAK,OAAO,IAAI,YAAY,CAAC,GAAG,eAAe,GAAG,UAAU,IAAI,EAAE,EACtF,QAAQ,EACR,gBAAgB,EAChB,iBAAiB,EACjB,WAAW,EAAE,EACb,SAAS,EACT,WAAW,EACX,IAAI,EACJ,aAAa,CACd,CAAC;AACJ;;;;"}