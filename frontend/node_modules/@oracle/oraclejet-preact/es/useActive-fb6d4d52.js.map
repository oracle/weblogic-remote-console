{"version":3,"file":"useActive-fb6d4d52.js","sources":["../../src/hooks/UNSAFE_useActive/useActive.ts"],"sourcesContent":["import { useToggle } from '../UNSAFE_useToggle';\nimport { useRef, useCallback, useEffect } from 'preact/hooks';\n\nexport type ActiveOptions = {\n  isDisabled?: boolean;\n  disabledKeys?: ('enter' | 'space')[];\n};\n\n/**\n * Indicates if primary mouse button is down\n * @param e\n * @returns\n */\nconst isPrimaryMouseButtonDown = (e: MouseEvent) => {\n  const flags = e.buttons !== undefined ? e.buttons : e.which;\n  const primaryMouseButtonDown = (flags & 1) === 1;\n  if (primaryMouseButtonDown) {\n    return true;\n  }\n  return false;\n};\n\n/**\n * Returns properties to manage active state indication\n * @returns\n */\nexport function useActive({ isDisabled, disabledKeys }: ActiveOptions = { isDisabled: false }): {\n  isActive: boolean;\n  activeProps: Record<string, any>;\n} {\n  const { bool, setTrue, setFalse } = useToggle(false);\n  const wasActive = useRef(false);\n\n  const mouseDownTarget = useCallback(\n    (e: MouseEvent) => {\n      if (isPrimaryMouseButtonDown(e)) {\n        setTrue();\n      }\n    },\n    [setTrue]\n  );\n\n  const leftTarget = useCallback(\n    (e: MouseEvent) => {\n      if (isPrimaryMouseButtonDown(e)) {\n        wasActive.current = true;\n      }\n      setFalse();\n    },\n    [setFalse]\n  );\n\n  const enteredTarget = useCallback(\n    (e: MouseEvent) => {\n      if (wasActive.current) {\n        if (isPrimaryMouseButtonDown(e)) {\n          setTrue();\n        }\n        wasActive.current = false;\n      }\n    },\n    [setTrue]\n  );\n\n  const onKeyDown = useCallback(\n    (event: KeyboardEvent) => {\n      if (\n        (event.key === ' ' && !disabledKeys?.includes('space')) ||\n        (event.key === 'Enter' && !disabledKeys?.includes('enter'))\n      ) {\n        setTrue();\n      }\n    },\n    [setTrue, disabledKeys]\n  );\n\n  const onKeyUp = useCallback(() => {\n    setFalse();\n  }, [setFalse]);\n\n  const onBlur = useCallback(() => {\n    setFalse();\n  }, [setFalse]);\n\n  // If target gets disabled, should set active to false\n  useEffect(() => {\n    if (isDisabled) {\n      setFalse();\n    }\n  }, [isDisabled, setFalse]);\n\n  const activeProps = isDisabled\n    ? {}\n    : {\n        onMouseDown: mouseDownTarget,\n        onMouseLeave: leftTarget,\n        onMouseEnter: enteredTarget,\n        onMouseUp: setFalse,\n        onTouchStart: setTrue,\n        onTouchEnd: setFalse,\n        onTouchCancel: setFalse,\n        onKeyDown,\n        onKeyUp,\n        onBlur\n      };\n\n  return {\n    isActive: isDisabled ? false : bool,\n    activeProps: activeProps\n  };\n}\n"],"names":[],"mappings":"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"}