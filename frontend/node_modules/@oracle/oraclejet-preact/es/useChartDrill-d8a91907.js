/* @oracle/oraclejet-preact: undefined */
import { useCallback } from 'preact/hooks';
import { g as getInfo } from './eventsUtils-e96290df.js';
import './accUtils-f6657e8e.js';
import { u as useVisDrill } from './useVisDrill-48b6609b.js';

const isDrillable = (info, drilling, levelsArray, getDataItem) => {
    const { seriesIndex, groupIndex, levelIndex } = info;
    if (groupIndex === undefined || levelsArray.length < 1) {
        return false;
    }
    const groupInfo = levelsArray[levelsArray.length - 1][groupIndex];
    if (seriesIndex != null) {
        const itemDrilling = getDataItem(seriesIndex, groupIndex, groupInfo.path)?.drilling != 'off';
        return drilling === 'on' && itemDrilling;
    }
    else if (levelIndex !== undefined) {
        return levelsArray[levelIndex][groupIndex].item.drilling != 'off';
    }
    return false;
};
/**
 * Returns the event handlers for drill support.
 */
function useChartDrill({ rootRef, focusedItemInfo, focusedGroupInfo, levelsArray, selectionMode, drilling, getDataItem, onItemDrill, onGroupDrill }) {
    const processDrill = useCallback((info) => {
        if (!info ||
            info.groupIndex == undefined ||
            !isDrillable(info, drilling, levelsArray, getDataItem)) {
            return;
        }
        const { seriesIndex, groupIndex, levelIndex } = info;
        const groupInfo = levelsArray[levelIndex != undefined ? levelIndex : levelsArray.length - 1][groupIndex];
        if (seriesIndex != null) {
            const data = getDataItem(seriesIndex, groupIndex, groupInfo.path);
            if (data) {
                onItemDrill?.({
                    groupIndex,
                    seriesIndex,
                    data,
                    id: data?.id,
                    groupPath: groupInfo.path
                });
            }
        }
        else {
            onGroupDrill?.({
                groupIndex,
                group: groupInfo.item,
                id: groupInfo.item.id,
                groupPath: groupInfo.path
            });
        }
    }, [drilling, getDataItem, onGroupDrill, onItemDrill, levelsArray]);
    const onDrill = useCallback((event) => {
        if (event.type === 'keydown') {
            const focusedInfo = focusedItemInfo.isCurrent ? focusedItemInfo : focusedGroupInfo;
            processDrill(focusedInfo);
        }
        else {
            processDrill(getInfo(rootRef, event.target));
        }
    }, [rootRef, focusedItemInfo, focusedGroupInfo, processDrill]);
    return useVisDrill(selectionMode, onDrill);
}

export { useChartDrill as u };
//# sourceMappingURL=useChartDrill-d8a91907.js.map
