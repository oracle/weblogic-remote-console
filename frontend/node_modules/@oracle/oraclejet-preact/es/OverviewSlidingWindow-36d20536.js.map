{"version":3,"file":"OverviewSlidingWindow-36d20536.js","sources":["../../src/PRIVATE_VisOverview/useOverviewEvents.ts","../../src/PRIVATE_VisOverview/OverviewSlidingWindow.tsx"],"sourcesContent":["/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\n\nimport { getElementData } from '#utils/UNSAFE_visUtils';\nimport type { RefObject } from 'preact';\nimport { useRef, useCallback, useState } from 'preact/hooks';\n\nconst OVERVIEW_MIN_SIZE = 20;\n\ntype Props = {\n  /**\n   * The width of the overview.\n   */\n  width: number;\n\n  /**\n   * The height of the overview.\n   */\n  height: number;\n\n  /**\n   * The x coordinate of the overview.\n   */\n  x: number;\n\n  /**\n   * The y coordinate of the overview.\n   */\n  y: number;\n\n  /**\n   * The x2 coordinate of the overview window.\n   */\n  windowX: number;\n\n  /**\n   * The y2 coordinate of the overview window.\n   */\n  windowY: number;\n\n  /**\n   * The height of the overview window.\n   */\n  windowHeight: number;\n\n  /**\n   * The width of the overview window.\n   */\n  windowWidth: number;\n\n  /**\n   * The rootRef.\n   */\n  rootRef: RefObject<HTMLDivElement>;\n\n  /**\n   * The callback to call when window dims change.\n   */\n\n  onWindowDimsChange?: ({ deltaWidth, deltaX }: { deltaX: number; deltaWidth: number }) => void;\n};\n\nexport function useOverviewEvents({\n  x,\n  width,\n  windowX,\n  windowWidth,\n  rootRef,\n  windowHeight,\n  windowY,\n  onWindowDimsChange\n}: Props) {\n  const pointerDownPointRef = useRef<{ x: number; y: number }>();\n  const [lastPoint, setLastPoint] = useState<{ x: number; y: number }>();\n\n  const onPointerDown = useCallback(\n    (event: PointerEvent) => {\n      pointerDownPointRef.current = { x: event.offsetX, y: event.offsetY };\n      (event.target as Element).setPointerCapture(event.pointerId);\n      setLastPoint({ x: event.offsetX, y: event.offsetY });\n    },\n    [pointerDownPointRef]\n  );\n\n  const onPointerUp = useCallback(\n    (event: PointerEvent) => {\n      const { offsetX: clickX, offsetY: clickY } = event;\n      const isPointerUpFar =\n        Math.abs(pointerDownPointRef.current!.x - clickX) > OVERVIEW_MIN_SIZE / 4;\n      pointerDownPointRef.current = undefined;\n      setLastPoint(undefined);\n      if (\n        (clickX <= windowX + windowWidth &&\n          clickX >= windowX &&\n          clickY <= windowY + windowHeight &&\n          clickY >= windowY) ||\n        isPointerUpFar\n      ) {\n        return;\n      }\n\n      const newX = Math.min(x + width - windowWidth, Math.max(clickX - windowWidth / 2, x));\n\n      onWindowDimsChange?.({ deltaX: newX - windowX, deltaWidth: 0 });\n    },\n    [pointerDownPointRef, windowHeight, windowX, windowY, windowWidth, width, x, onWindowDimsChange]\n  );\n\n  const onPointerMove = useCallback(\n    (event: PointerEvent) => {\n      const targetType = getElementData(rootRef, event.target as HTMLElement)?.['ojPrivateObject'];\n      if (\n        !pointerDownPointRef.current ||\n        event.target == null ||\n        targetType == null ||\n        lastPoint == null\n      ) {\n        return;\n      }\n\n      let deltaX = 0;\n      let deltaWidth = 0;\n      if (targetType === 'window') {\n        const delta = event.offsetX - lastPoint.x;\n        deltaX = Math.min(x + width - windowWidth, Math.max(x, windowX + delta)) - windowX;\n      } else if (\n        targetType === 'leftHandle' &&\n        event.offsetX <= windowX + windowWidth - OVERVIEW_MIN_SIZE / 2 &&\n        event.offsetX > x\n      ) {\n        deltaX = Math.max(x, windowX + event.offsetX - lastPoint.x) - windowX;\n        deltaWidth = -1 * deltaX;\n      } else if (\n        targetType === 'rightHandle' &&\n        event.offsetX >= windowX + OVERVIEW_MIN_SIZE / 2 &&\n        event.offsetX < x + width\n      ) {\n        deltaWidth = Math.min(event.offsetX - lastPoint.x, x + width - windowX);\n      }\n      setLastPoint({ x: event.offsetX, y: event.offsetY });\n      onWindowDimsChange?.({ deltaX, deltaWidth });\n      event.stopPropagation();\n    },\n    [pointerDownPointRef, rootRef, x, lastPoint, width, windowX, windowWidth, onWindowDimsChange]\n  );\n\n  return {\n    onPointerDown,\n    onPointerUp,\n    onPointerMove\n  };\n}\n","/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\n\nimport { useRef } from 'preact/hooks';\nimport { OverviewProps } from './overview.types';\nimport { styles } from './themes/VisOverview.css';\nimport { useOverviewEvents } from './useOverviewEvents';\nimport { OverviewHorizontalDragHandleIcon } from '#PRIVATE_ThemedIcons/OverviewHorizontalDragHandleIcon';\nimport { isTouch } from '#utils/UNSAFE_visUtils/clientUtils';\n\nconst OVERVIEW_HANDLE_SIZE = 16;\nconst OVERVIEW_HANDLE_ACTIVATION_SIZE = isTouch() ? 30 : 10;\n\nexport function OverviewSlidingWindow({\n  x,\n  width,\n  height,\n  y,\n  windowX,\n  windowHeight,\n  windowWidth,\n  windowY,\n  hasHandles,\n  onWindowDimsChange\n}: OverviewProps) {\n  const rootRef = useRef(null);\n  const overviewProps = useOverviewEvents({\n    x,\n    y,\n    width,\n    height,\n    windowHeight,\n    windowWidth,\n    windowX,\n    windowY,\n    rootRef,\n    onWindowDimsChange\n  });\n  const handleIconY = windowY + 0.5 * (windowHeight - OVERVIEW_HANDLE_SIZE);\n  return (\n    <g ref={rootRef} {...(hasHandles ? overviewProps : {})}>\n      <rect x={x} y={y} width={width} height={height} fill=\"transparent\"></rect>\n      <rect\n        data-oj-private-object=\"window\"\n        cursor=\"move\"\n        x={windowX}\n        y={windowY}\n        height={windowHeight - 1}\n        width={windowWidth - 1}\n        class={styles.overviewWindow}></rect>\n      {hasHandles && (\n        <>\n          <g transform={`translate(${windowX} ${handleIconY})`}>\n            <OverviewHorizontalDragHandleIcon color=\"primary\" />\n          </g>\n\n          <g\n            transform={`translate(${windowX + windowWidth - OVERVIEW_HANDLE_SIZE} ${handleIconY})`}>\n            <OverviewHorizontalDragHandleIcon color=\"primary\" />\n          </g>\n\n          <rect\n            x={windowX}\n            y={windowY}\n            height={windowHeight}\n            width={OVERVIEW_HANDLE_ACTIVATION_SIZE}\n            strokeWidth=\"1\"\n            data-oj-private-object=\"leftHandle\"\n            fill=\"transparent\"\n            stroke=\"transparent\"\n            cursor=\"col-resize\"></rect>\n          <rect\n            x={windowX + windowWidth - OVERVIEW_HANDLE_ACTIVATION_SIZE}\n            y={windowY}\n            strokeWidth=\"1\"\n            height={windowHeight}\n            data-oj-private-object=\"rightHandle\"\n            width={OVERVIEW_HANDLE_ACTIVATION_SIZE}\n            stroke=\"transparent\"\n            fill=\"transparent\"\n            cursor=\"col-resize\"></rect>\n        </>\n      )}\n    </g>\n  );\n}\n"],"names":["_jsxs","_jsx","_Fragment","OverviewHorizontalDragHandleIcon"],"mappings":"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"}