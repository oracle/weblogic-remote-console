{"version":3,"file":"ReadonlyTextFieldInput-7bfb1cad.js","sources":["../../src/UNSAFE_TextField/ReadonlyTextFieldInput.tsx"],"sourcesContent":["import type { ComponentChildren, ContextType, Ref, JSX } from 'preact';\n\nimport type { UnpackSignals } from '@oracle/oraclejet-internal-utilities/attributeUtils';\n\nimport { useAccessibleContext } from '#hooks/UNSAFE_useAccessibleContext';\nimport { useComponentTheme } from '#hooks/UNSAFE_useComponentTheme';\nimport { useFormContext } from '#hooks/UNSAFE_useFormContext';\nimport { useFormFieldContext } from '#hooks/UNSAFE_useFormFieldContext';\nimport type { FormVariantContext } from '#hooks/UNSAFE_useFormVariantContext';\nimport { useTabbableMode } from '#hooks/UNSAFE_useTabbableMode';\nimport { useTranslationBundle } from '#hooks/UNSAFE_useTranslationBundle';\nimport type { BundleType } from '#resources/nls/bundle';\nimport { classNames } from '#utils/UNSAFE_classNames';\nimport { textInterpolations, type TextProps } from '#utils/UNSAFE_interpolations/text';\nimport { mergeInterpolations } from '#utils/UNSAFE_mergeInterpolations';\nimport { formControlInheritTextAlign } from './themes/FormControlUtilsStyles.css';\nimport {\n  ReadonlyTextFieldInputStyles,\n  type ReadonlyTextFieldInputVariantOptions\n} from './themes/ReadonlyTextFieldInputStyles.css';\nimport { ReadonlyTextFieldInputRedwoodTheme } from './themes/redwood/ReadonlyTextFieldInputTheme';\n\ntype AutoFocusProp = UnpackSignals<JSX.IntrinsicElements['input']>['autofocus'];\n\ntype FocusProps = Pick<UnpackSignals<JSX.HTMLAttributes<HTMLElement>>, 'onBlur' | 'onFocus'>;\n\ntype ReadonlyAsInputProps = {\n  as: 'input';\n  type: UnpackSignals<JSX.IntrinsicElements['input']>['type'];\n  elementRef?: Ref<HTMLInputElement>;\n  rows?: never;\n};\n\ntype ReadonlyAsTextAreaProps = {\n  as: 'textarea';\n  elementRef?: Ref<HTMLTextAreaElement | HTMLDivElement>;\n  type?: never;\n  rows?: number;\n};\n\ntype ReadonlyAsDivProps = {\n  as?: 'div';\n  elementRef?: Ref<HTMLTextAreaElement | HTMLDivElement>;\n  type?: never;\n  rows?: never;\n};\n\ntype Props = TextProps &\n  (ReadonlyAsDivProps | ReadonlyAsInputProps | ReadonlyAsTextAreaProps) &\n  FocusProps & {\n    'aria-describedby'?: string;\n    'aria-label'?: string;\n    'aria-labelledby'?: string;\n    autoFocus?: AutoFocusProp;\n    formVariant?: ContextType<typeof FormVariantContext>;\n    hasEmptyLabel?: boolean;\n    hasInsideLabel?: boolean;\n    id?: UnpackSignals<JSX.HTMLAttributes<HTMLElement>>['id'];\n    inlineUserAssistance?: ComponentChildren;\n    innerReadonlyField?: ComponentChildren;\n    value?: string;\n    variant?: 'textarea';\n  };\n\n/**\n * Merge multiple ids into a space-separated list\n * @param ids The ids to be merged\n * @returns The space separated string of ids\n */\nfunction mergeIDs(...ids: (string | undefined)[]) {\n  return ids.filter(Boolean).join(' ') || undefined;\n}\n\nexport function ReadonlyTextFieldInput({\n  'aria-describedby': ariaDescribedBy,\n  'aria-label': ariaLabel,\n  'aria-labelledby': inputLabelledBy,\n  autoFocus,\n  as = 'div',\n  elementRef,\n  formVariant,\n  hasEmptyLabel,\n  hasInsideLabel = false,\n  inlineUserAssistance,\n  innerReadonlyField,\n  onBlur,\n  onFocus,\n  rows,\n  type,\n  value = '',\n  variant,\n  ...props\n}: Props) {\n  const translations = useTranslationBundle<BundleType>('@oracle/oraclejet-preact');\n  const loadingAriaLabel = translations.formControl_loading();\n  const { isFormLayout, isReadonly: isReadonlyForm } = useFormContext();\n  const { isLoading } = useFormFieldContext();\n  const ariaLabelForReadonly = isLoading ? loadingAriaLabel : ariaLabel;\n  const focusProps = { onBlur, onFocus };\n\n  // get classes for text align\n  const interpolations = [...Object.values(textInterpolations)];\n  const styleInterpolations = mergeInterpolations<Props>(interpolations);\n  const { class: styleInterpolationClasses } = styleInterpolations(props);\n  const { classes: themeClasses } = useComponentTheme<\n    ReadonlyTextFieldInputVariantOptions,\n    ReadonlyTextFieldInputStyles\n  >(ReadonlyTextFieldInputRedwoodTheme, {\n    textarea: variant === 'textarea' ? 'isTextArea' : 'notTextArea',\n    formLayout: isFormLayout ? 'isFormLayout' : 'notFormLayout',\n    readonlyForm: isReadonlyForm ? 'isReadonlyForm' : 'notReadonlyForm',\n    insideLabel: hasInsideLabel ? 'hasInsideLabel' : 'noInsideLabel'\n  });\n\n  const readonlyDivClasses = classNames([\n    themeClasses,\n    styleInterpolationClasses,\n    // JET-72775 - Form control alignment in tables\n    // When we are in legacy collection components, we want to inherit the text align\n    // when it is not set explicitly.\n    formVariant === 'legacyEmbedded' && props.textAlign === undefined && formControlInheritTextAlign\n  ]);\n\n  // JET-52914 - Implement Tabbable mode API contract in InputText\n  // spread tabbableModeProps on component\n  const { isTabbable, tabbableModeProps } = useTabbableMode();\n\n  // JET-52089: add unsafe API for specifying an external label which is added to ariaLabelledBy on the input or div,\n  // only when labelEdge is 'none' and label is ''. Since ariaLabelledBy takes precedence over all other\n  // kinds of labels, this helps to ensure we don't override a meaningful label.\n  const { UNSAFE_ariaLabelledBy } = useAccessibleContext();\n  const ariaLabelledBy = hasEmptyLabel\n    ? mergeIDs(inputLabelledBy, UNSAFE_ariaLabelledBy)\n    : inputLabelledBy;\n\n  if (as === 'input') {\n    return (\n      <input\n        aria-describedby={ariaDescribedBy}\n        aria-label={ariaLabelForReadonly}\n        aria-labelledby={ariaLabelledBy}\n        autofocus={autoFocus}\n        class={readonlyDivClasses}\n        readonly={true}\n        // @ts-expect-error TS cannot infer the type correctly for the polymorphed ref\n        ref={elementRef}\n        type={type}\n        value={value}\n        {...(!isTabbable && tabbableModeProps)}\n        {...(hasInsideLabel && focusProps)}\n      />\n    );\n  }\n  if (as === 'textarea') {\n    return (\n      <textarea\n        aria-describedby={ariaDescribedBy}\n        aria-label={ariaLabelForReadonly}\n        aria-labelledby={ariaLabelledBy}\n        autofocus={autoFocus}\n        class={readonlyDivClasses}\n        readonly={true}\n        // @ts-expect-error TS cannot infer the type correctly for the polymorphed ref\n        ref={elementRef}\n        rows={rows}\n        {...(!isTabbable && tabbableModeProps)}\n        {...(hasInsideLabel && focusProps)}>\n        {value}\n      </textarea>\n    );\n  }\n  return (\n    <div\n      aria-describedby={ariaDescribedBy}\n      aria-label={ariaLabelForReadonly}\n      aria-labelledby={ariaLabelledBy}\n      aria-readonly={true}\n      autofocus={autoFocus}\n      class={readonlyDivClasses}\n      // @ts-expect-error TS cannot infer the type correctly for the polymorphed ref\n      ref={elementRef}\n      role=\"textbox\"\n      {...tabbableModeProps}\n      {...(hasInsideLabel && focusProps)}>\n      {value}\n    </div>\n  );\n}\n"],"names":["_jsx"],"mappings":"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"}