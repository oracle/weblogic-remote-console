{"version":3,"file":"TableViewAdapter.js","sources":["../../../../src/UNSAFE_TableView/__testing__/TableViewAdapter.ts"],"sourcesContent":["import { ClickOptions, Keys, TestElement, waitFor } from '@oracle/oraclejet-testing/UNSAFE_Driver';\nimport { byCss } from '@oracle/oraclejet-testing/UNSAFE_Locators';\nimport { TestAdapter } from '@oracle/oraclejet-testing/UNSAFE_TestAdapter';\n\nexport class TableViewAdapter extends TestAdapter {\n  /**\n   * Sort the table view by the column specified\n   * @param columnKey The columnKey of the column\n   * @returns Promise<void>\n   */\n  async doSort<C extends string>(columnKey: C) {\n    const driver = this.getTestDriver();\n    const tableView = await this.getElement();\n    let header;\n    try {\n      header = await tableView.waitForElement(\n        byCss(`[data-oj-cell-type=\"header\"][data-oj-column-key=\"${columnKey}\"]`)\n      );\n    } catch (e) {\n      throw new Error(`Specified column key ${columnKey} is invalid or does not exist`);\n    }\n    return driver.sendKeys(header, Keys['ENTER']);\n  }\n\n  /**\n   * Triggers rowAction event\n   * @param rowKey The rowKey\n   * @returns Promise<void>\n   */\n  async doRowAction<K extends string | number>(rowKey: K) {\n    const tableView = await this.getElement();\n    let row;\n    try {\n      row = await tableView.waitForElement(byCss(`[data-oj-key=\"${rowKey}\"]`));\n    } catch (e) {\n      throw new Error(`Specified row key ${rowKey} is invalid or does not exist`);\n    }\n    return this._clickItem(row);\n  }\n\n  /**\n   * Toggles row selection\n   * @param rowKey The rowKey\n   * @returns Promise<void>\n   */\n  async doToggleSelectRow<K extends string | number>(rowKey: K) {\n    const tableView = await this.getElement();\n    let row;\n    try {\n      row = await tableView.waitForElement(byCss(`[data-oj-key=\"${rowKey}\"]`));\n    } catch (e) {\n      throw new Error(`Specified row key ${rowKey} is invalid or does not exist`);\n    }\n    return this._clickItem(row, { modifiers: [Keys['CONTROL_COMMAND']] });\n  }\n\n  /**\n   * Toggles column selection\n   * @param columnKey The columnKey\n   * @returns Promise<void>\n   */\n  async doToggleSelectColumn<C extends string>(columnKey: C) {\n    const tableView = await this.getElement();\n    let column;\n    try {\n      column = await tableView.waitForElement(\n        byCss(`[data-oj-cell-type=\"header\"][data-oj-column-key=\"${columnKey}\"]`)\n      );\n    } catch (e) {\n      throw new Error(`Specified column key ${columnKey} is invalid or does not exist`);\n    }\n    return this._clickItem(column, { modifiers: [Keys['CONTROL_COMMAND']] });\n  }\n\n  /**\n   * Perform a TestDriver click() on the item, but first ensure that it's scrolled into\n   * view. TODO: this shouldn't be needed once JET-73795 is fixed.\n   * @param item\n   * @param options\n   * @returns\n   */\n  private async _clickItem(item: TestElement, options?: ClickOptions) {\n    const driver = this.getTestDriver();\n    await driver.executeScript(\n      (el: HTMLElement) => el.scrollIntoView({ block: 'center', inline: 'center' }),\n      driver.unwrapElement(item)\n    );\n    return driver.click(item, options);\n  }\n\n  /**\n   * Load more rows\n   * @param locator The TestIdLocator which identifies the TableView\n   * @returns Promise<void>\n   */\n  async doLoadMore() {\n    const driver = this.getTestDriver();\n    const tableView = await this.getElement();\n    const rowCount = (await tableView.waitForElements(byCss('tr[role=\"row\"]'))).length;\n    await driver.sendKeys(tableView, Keys['CONTROL_COMMAND'], Keys['END']);\n    await waitFor(async () => {\n      return (\n        (await tableView.waitForElements(byCss('tr[role=\"row\"]'))).length != rowCount ||\n        (await tableView.waitForElements(byCss('[data-oj-cell-type=\"loadMore\"]'))).length === 0\n      );\n    });\n  }\n}\n"],"names":[],"mappings":"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"}