{"version":3,"file":"UNSAFE_ReorderableTabBar.js","sources":["../../src/UNSAFE_ReorderableTabBar/ReorderableTabBarItem.tsx","../../src/UNSAFE_ReorderableTabBar/ReorderableTabBar.tsx"],"sourcesContent":["import { useRef, useCallback } from 'preact/hooks';\nimport { mergeInterpolations } from '../utils/UNSAFE_mergeInterpolations';\nimport { flexitemInterpolations } from '../utils/UNSAFE_interpolations/flexitem';\nimport type { FlexitemProps } from '../utils/UNSAFE_interpolations/flexitem';\nimport { getKey } from '../utils/PRIVATE_collectionUtils';\nimport { useReorderableItem } from '../hooks/PRIVATE_useReorderable';\nimport { ReorderableItemProps } from '../UNSAFE_Collection/Reorderable.types';\nimport { styles } from './themes/ReorderableTabBarItemStyles.css';\nimport { isKeyDefined } from '../utils/UNSAFE_keys';\n\nexport const ITEM_SELECTOR = '[role=\"tab\"]';\n\ntype ReorderableTabBarItem<K extends string | number> = ReorderableItemProps<K> & {\n  layout: 'stretch' | 'condense' | undefined;\n};\n\n/**\n * A private item that will be used by ReorderableTabBar, location TBD (could be moved to PRIVATE_TabBar)\n */\nexport function ReorderableTabBarItem<K extends string | number>({\n  children,\n  dragKey,\n  setDragKey,\n  onReorder,\n  layout,\n  rootRef\n}: ReorderableTabBarItem<K>) {\n  const tabBarItemRef = useRef<HTMLDivElement | null>(null);\n  const getItem = useCallback(\n    () => tabBarItemRef?.current?.querySelector(ITEM_SELECTOR) as HTMLElement,\n    []\n  );\n  const setTransferData = useCallback(\n    (event: DragEvent) => {\n      event.dataTransfer?.setData('text/tabbar-item-key', getKey(getItem()) + '');\n    },\n    [getItem]\n  );\n\n  const { rootProps, isDragged, overlayZoneBeforeProps, overlayZoneAfterProps } =\n    useReorderableItem({\n      isDisabled: onReorder ? false : true,\n      dragKey,\n      setDragKey,\n      onReorder,\n      rootRef,\n      ref: tabBarItemRef,\n      getItem,\n      setTransferData,\n      itemStyles: styles,\n      itemSelector: ITEM_SELECTOR\n    });\n\n  //instead of specifying flex: '1 0 auto' in style\n  const styleInterpolations = mergeInterpolations<FlexitemProps>([\n    ...Object.values(flexitemInterpolations)\n  ]);\n  const flexDimensions = styleInterpolations({\n    flex: layout === 'stretch' ? '1 0 auto' : '0 0 auto'\n  });\n\n  return (\n    <div {...rootProps} draggable={onReorder ? true : false} style={flexDimensions}>\n      {children}\n      {!isDragged && isKeyDefined(dragKey) && (\n        <>\n          <div {...overlayZoneBeforeProps}></div>\n          <div {...overlayZoneAfterProps}></div>\n        </>\n      )}\n    </div>\n  );\n}\n","import { toChildArray, Ref, ContextType } from 'preact';\nimport { forwardRef } from 'preact/compat';\nimport { useRef, useState } from 'preact/hooks';\nimport { HiddenAccessible } from '../UNSAFE_HiddenAccessible';\nimport { LiveRegion } from '../UNSAFE_LiveRegion';\nimport { TestIdProps } from '../hooks/UNSAFE_useTestId';\nimport { TabBar, TabBarProps } from '../UNSAFE_TabBar';\nimport { ReorderableTabBarItem, ITEM_SELECTOR } from './ReorderableTabBarItem';\nimport { ReorderableContext, useReorderable } from '../hooks/PRIVATE_useReorderable';\nimport { ReorderProps } from '../UNSAFE_Collection/Reorderable.types';\nimport { TabBarContextMenuConfig } from '../UNSAFE_TabBarCommon';\n\nexport type ReorderableTabBarProps<K extends string | number> = Omit<\n  TabBarProps<K>,\n  'aria-describedby'\n> &\n  ReorderProps<K> &\n  TestIdProps;\n\ntype TabBarReorderContextProps = ContextType<typeof ReorderableContext>;\n/**\n * A component that allows reordering of tabs within a TabBar.\n */\nexport const ReorderableTabBar = forwardRef(\n  <K extends string | number>(\n    {\n      'aria-label': ariaLabel,\n      'aria-labelledby': ariaLabelledby,\n      children,\n      layout = 'stretch',\n      display = 'standard',\n      size = 'md',\n      edge = 'top',\n      selection,\n      onSelect,\n      onRemove,\n      onReorder,\n      contextMenuConfig,\n      testId\n    }: ReorderableTabBarProps<K>,\n    ref: Ref<HTMLDivElement>\n  ) => {\n    const rootRef = useRef<HTMLDivElement>(null);\n    const [dragKey, setDragKey] = useState<K | undefined>(undefined);\n\n    const displayStackProps = {\n      display: display\n    };\n    const displayNonStackProps = {\n      display: display,\n      size: size\n    };\n    const displayProps = display === 'stacked' ? displayStackProps : displayNonStackProps;\n\n    const {\n      reorderProps,\n      reorderContext,\n      reorderInstructionsId,\n      reorderStatus,\n      reorderInstructions\n    } = useReorderable({\n      onReorder,\n      rootRef,\n      itemSelector: ITEM_SELECTOR\n    });\n\n    const tabBarReorderContext = {\n      currentItemKey: reorderContext.currentItemKey,\n      onReorder: onReorder as TabBarReorderContextProps['onReorder']\n    };\n\n    return (\n      <div ref={rootRef} {...reorderProps}>\n        <ReorderableContext.Provider value={tabBarReorderContext}>\n          <TabBar\n            ref={ref}\n            aria-label={ariaLabel}\n            aria-labelledby={ariaLabelledby}\n            layout={layout}\n            edge={edge}\n            selection={selection}\n            onSelect={onSelect}\n            onRemove={onRemove}\n            testId={testId}\n            {...displayProps}\n            aria-describedby={reorderInstructionsId}\n            contextMenuConfig={contextMenuConfig as TabBarContextMenuConfig<string | number>}>\n            {toChildArray(children).map((child) => {\n              return (\n                <ReorderableTabBarItem\n                  dragKey={dragKey}\n                  setDragKey={setDragKey}\n                  onReorder={onReorder}\n                  layout={layout}\n                  rootRef={rootRef}>\n                  {child}\n                </ReorderableTabBarItem>\n              );\n            })}\n          </TabBar>\n        </ReorderableContext.Provider>\n        <span id={reorderInstructionsId}>\n          <HiddenAccessible>{reorderInstructions}</HiddenAccessible>\n        </span>\n        <LiveRegion>{reorderStatus}</LiveRegion>\n      </div>\n    );\n  }\n);\n"],"names":["_jsxs","_Fragment","_jsx"],"mappings":"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"}