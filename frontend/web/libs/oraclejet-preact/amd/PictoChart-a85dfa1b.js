define(['exports', 'preact/jsx-runtime', './TrackResizeContainer-a4999df9', 'preact', 'preact/hooks', './UNSAFE_PictoChart/themes/PictoChartStyles.css', './classNames-08d99695', './useSelection-59251fff', './useTranslationBundle-8e42d505', './mergeProps-bcfa6a92', './themeContract.css-2e4b066d', './utils-ad4761c9', './SvgSymbol-b672024f', './accUtils-acd70e81', './useUser-12ec03f1', './layoutUtils-641af87a', './eventsUtils-5fb81c3e', './useVisHover-28319fef', './useVisDrill-b08ba7e5', './useDatatip-be0adcf0', './useItemFocus-75d6510d', './LayerHost-daf96749', 'preact/compat', './datatipUtils-6846028e', './useTestId-9afc201a', './useVisTouchResponse-88a7bb09', './stringUtils-4ffd9d59', './useContextMenu-4bd1c23a', './Menu-45a26116', './MenuItem-ff1cd14d', './logger-0f873e29', 'css!./TooltipContentStyles.styles.css', 'module', './hooks/UNSAFE_useTooltip/themes/redwood/TooltipContentVariants.css', './tooltipUtils-ae57629b', 'css!./IconStyle.styles.css', './SelectMenuGroupContext-67f24a8f', './UNSAFE_Menu/themes/MenuItemStyles.css', './UNSAFE_Separator/themes/SeparatorStyles.css', 'css!./MenuSeparatorStyles.styles.css', 'module', './UNSAFE_Menu/themes/redwood/MenuSeparatorVariants.css', 'css!./MenuStyles.styles.css'], (function(t,e,o,n,r,i,s,c,a,l,u,d,f,m,p,h,g,x,I,S,C,b,y,w,v,M,R,E,$,F,k,P,D,T,U,V,A,N,H,j,_,B,L){"use strict";const O=n.createContext({});function W(t,e){return Math.ceil(t/e)*e}const q=(t,e,o,n,r)=>{for(let i=0;i<r;i++)for(let r=0;r<n;r++)if(t[o+i][e+r])return!1;return!0},G=(t,e,o,n,r)=>{for(let i=0;i<r;i++)for(let r=0;r<n;r++)t[o+i][e+r]=!0},z=(t,e,o,n,r,i)=>{if(i){for(let i=0;i<=n-e;i++)for(let n=0;n<=r-o;n++)if(q(t,i,n,e,o))return G(t,i,n,e,o),{col:i,row:n}}else for(let i=0;i<r-o+1;i++)for(let r=0;r<n-e+1;r++)if(q(t,r,i,e,o))return G(t,r,i,e,o),{col:r,row:i}};function K(t){const e=t.dataset.idx;if(void 0!==e)return{idx:Number(e)}}function Z(t,e,o,n,r,i,s,c,a,l,u){let d=!1;if(!n){const t=!!s&&e===s.idx,o=!!r&&e===r.idx;d=!!(t&&s?.isCurrent||o&&r?.isCurrent)}const f=function(t,e){return!e||0===e.length||new Set(e).has(t)}(t.id,c),m=function(t,e){return!(!e||0===e.length)&&new Set(e).has(t)}(t.id,i);return{isCurrent:d,isHighlighted:f,isSelected:m,hasSelection:i&&0!==i.length,isFocused:!!s&&Q(s,e),key:t.id,itemIdx:e,countIdx:o,activeId:d?a:void 0,isReadOnly:n,item:t,isVerticalLayout:l,layoutOrigin:u}}function J(t,e){return t?.idx===e?.idx}function Q(t,e){return!!t.isFocusVisible&&t.idx===e}function X(t,e,o){return`${o?.vis_labelCountWithTotal({itemCount:t.toString(),totalCount:e.toString()})}`}const Y=({context:t,markerProps:o})=>{const{supportsSelection:n}=r.useContext(O),i=function(t,e,o,n,r,i){const s="human"===t,c=o||r&&i,a="ellipse"===t||"rectangle"===t;e=""!==e?e:d.rgba(u.colorSchemeVars.palette.neutral[190],.15);const l=n?u.colorSchemeVars.textIcon.primary:c?e:"";return{markerShape:t,tx:s?70:void 0,ty:s?60:void 0,markerColor:e,borderColor:n||c?d.rgb(u.colorSchemeVars.palette.neutral[0]):e,outerBorderColor:l,markerScale:a&&!l?1:.85,setAspectRatioNone:!!a}}(o.shape,o.color,t.state.focused,t.state.selected,t.state.hovered,n);return e.jsx(f.SvgSymbol,{...i})};function tt(t,e){const{idx:o}=t;return e[o]}function et(t){return{getItem:e=>tt(e,t),getDetailFromInfo:e=>{if(!e)return{id:void 0,data:void 0};const o=tt(e,t);return{id:o?o.id:void 0,data:o}},getPrevItemInfo:t=>function(t){let e=t.idx;return e=Math.max(0,e-1),{idx:e}}(t),getNextItemInfo:e=>function(t,e){let o=t.idx;return o=Math.min(e.length-1,o+1),{idx:o}}(e,t)}}const ot=t=>{const{direction:o}=p.useUser(),n="rtl"===o,r=t.isVerticalLayout;let c=t.fractionalStart??0,a=t.fractionalEnd??1;const l=t.layoutOrigin;r?"bottomStart"!==l&&"bottomEnd"!==l||([c,a]=[1-a,1-c]):"bottomEnd"!==l&&"topEnd"!==l||([c,a]=[1-a,1-c]);const u=0!==c||1!==a?r?`polygon(0% ${100*c}%, 100% ${100*c}%, 100% ${100*a}%, 0% ${100*a}%)`:n?`polygon(${100-100*a}% 0%, ${100-100*c}% 0%, ${100-100*c}% 100%, ${100-100*a}% 100%)`:`polygon(${100*c}% 0%, ${100*a}% 0%, ${100*a}% 100%, ${100*c}% 100%)`:void 0,d=t.supportsSelection||t.supportsDrill,{dimmedItemStyle:f,interactiveItemStyle:h}=i.styles,g=s.classNames([d&&h,!t.isHighlighted&&f]),x=0===t.countIdx,I=x&&function(t,e,o,n,r,i,s,c,a){const l=r?X(t,e,r):"";return c=c||`${n?n+": ":""}${l}`,{"aria-label":m.generateAriaLabel(r,c,{isSelected:o||s?i:void 0})||void 0,role:"img",id:a}}(t.item.count||1,t.totalCount,!!t.supportsSelection,t.item.label,t.translations,t.isSelected,t.hasSelection,t.item.accessibleLabel,t.activeId)||{};return e.jsx("div",{ref:x?t.focusedItemRef:void 0,id:t.activeId,"data-idx":t.itemIdx,"data-count-idx":t.countIdx,style:{gridRow:`${t.row+1} / span ${t.item.rowSpan||1}`,gridColumn:`${t.column+1} / span ${t.item.columnSpan||1}`,clipPath:u},class:g,...I,children:t.children})};function nt({width:t,height:o,columnWidth:n,rowHeight:f,items:m,columnCount:b,rowCount:y,layout:w,layoutOrigin:$="topStart",selectionMode:F="none",highlightedIds:k=[],selectedIds:P=[],drilling:D="off",onItemDrill:T,onItemHover:U,isFlowingWidth:V,isFlowingHeight:A,onItemFocus:N,contextMenuConfig:H,...j}){const _=r.useRef(null),B=0!==m.length,L=function(t){let e=0;for(let o=0;o<t.length;o++)e+=t[o].count||1;return e}(m),O=a.useTranslationBundle("@oracle/oraclejet-preact"),q=!(!F||"none"===F),G=null!=T,Q=!q&&!G&&null===U&&null===N,Y=v.useTestId(j.testId),tt=new Map(m.map((t=>[t.id,t]))),{getItem:nt,getDetailFromInfo:rt,getPrevItemInfo:it,getNextItemInfo:st}=et(m),{touchResponse:ct,touchResponseStyle:at}=M.useVisTouchResponse({type:"touchStart"}),{hoveredItemInfo:lt,focusedItemInfo:ut,activeId:dt,eventsProps:ft,onContextMenuDismissed:mt}=function(t,e,o,n,i,s,c,a,u,d){const[f,m]=r.useState({idx:0}),[S,C]=r.useState(),b=r.useRef(),{direction:y}=p.useUser(),w="rtl"===y,v=x.useVisHover((t=>{const o=K(t.target);J(o,S)||(C(o&&{...o,isCurrent:!0}),b.current=h.getRandomId(),e&&(m({...f,isCurrent:!1}),u?.(n(o))))}),void 0,(()=>{C(void 0),b.current=void 0,e&&u?.(n())}),t),M=r.useCallback((t=>{const{id:e,data:o}=n(t);null!=e&&o&&(a?.({id:e,data:o}),b.current=h.getRandomId())}),[n,a]),R=r.useCallback((t=>{"keydown"===t.type?"on"==c&&M(f):M(K(t.target))}),[c,f,M]),E=I.useVisDrill(o,R);if(!e)return{focusedItemInfo:f,hoveredItemInfo:S,eventsProps:v};function $(t){d?.(n(t)),b.current=h.getRandomId(),m(t)}function F(t){J(t,f)||(t.isCurrent=!0,t.isFocusVisible=!0,S&&C({...S,isCurrent:!1}),$(t))}return{focusedItemInfo:f,hoveredItemInfo:S,activeId:b.current,onContextMenuDismissed:t=>{"keyboard"===t&&$({...f,isFocusVisible:!0,isCurrent:!0})},eventsProps:l.mergeProps(E,v,{onKeyUp:t=>{"Tab"===t.code&&($({...f,isCurrent:!0,isFocusVisible:!0}),g.cancelEvent(t))},onKeyDown:t=>{switch(t.key){case"Tab":return;case"ArrowDown":F(s(f)),g.cancelEvent(t);break;case"ArrowUp":F(i(f)),g.cancelEvent(t);break;case"ArrowRight":F(w?i(f):s(f)),g.cancelEvent(t);break;case"ArrowLeft":F(w?s(f):i(f)),g.cancelEvent(t)}},onBlur:()=>{(null!=S||f.isCurrent)&&d?.(n(void 0));const t={...f,isCurrent:!1,isFocusVisible:!1};m(t)}})}}(ct,!Q&&B,F,rt,it,st,D,T,U,N),{selectionContent:pt,selectionProps:ht}=c.useSelection({idExtracter:t=>{const e="keyup"===t.type?ut:K(t.target);return rt(e).id},isDrillEnabled:"off"!=D,selection:P,selectionMode:F,getDataById:t=>tt.get(t),onChange:j.onSelectionChange}),gt=n&&parseFloat(n),xt=f&&parseFloat(f),It=s.classNames([i.baseStyles]),{focusedItemRef:St}=C.useItemFocus(ut),{content:Ct,borderColor:bt}=function(t,e,o,n,r,i,s){let c;const a=r?.isCurrent;let l,f;a&&null!=t[r.idx].id&&(c=r),n&&n.isCurrent&&(c=n);let m=d.rgba(u.colorSchemeVars.palette.neutral[190],.15);const p=c&&e(c,t);if(p&&i){const t=p&&{data:p},{content:e,borderColor:n}=i(t);l=e,m=n||m,f=s?X(p.count||1,o,s):""}return{borderColor:m,content:l||c&&e(c,t)?.accessibleLabel||c&&e(c,t)?.label+": "+f||f}}(m,nt,L,ut,lt,j.datatip,O),{calcColCount:yt,calcRowCount:wt,calcColWidth:vt,calcRowHeight:Mt,gridGap:Rt}=function(t,e,o,n,r,s,c,a,l,u){let d=0,f=1,m=1,p=1/0;for(let e=0;e<t.length;e++){const o=t[e],n=o.columnSpan||1,r=o.rowSpan||1;n<=0||r<=0||(n>f&&(f=n),r>m&&(m=r),n<p&&(p=n),r<p&&(p=r),d+=n*r*(o.count||1))}if(0===d)return{};(r||s)&&(l||(l=u||i.DEFAULT_SIZE),u||(u=l)),c||a||(r||s?r?s?e?a=W(Math.sqrt(d),m):c=W(Math.sqrt(d),f):a=Math.max(Math.floor(n/(u||1)),1):c=Math.max(Math.floor(o/(l||1)),1):e?a=W(Math.sqrt(d*n/o),m):c=W(Math.sqrt(d*o/n),f)),c?a||(a=W(d/c,m)):c=W(d/(a||1),f);const h=.25*p;return r||s||(l||(l=u||Math.min(o/c,n/(a||1))),u||(u=l)),c<=0||!a||a<=0||!l||l<=0||!u||u<=0?{}:{calcColCount:c,calcRowCount:a,calcColWidth:l?l-h:l,calcRowHeight:u?u-h:u,gridGap:h}}(m,"vertical"===w,t,o,V,A,b,y,gt,xt),{datatipContent:Et,datatipProps:{"aria-describedby":$t,...Ft}}=(({touchResponse:t,content:e,borderColor:o,width:n,focusedItemRef:r,focusedItemInfo:i})=>{const{direction:s}=p.useUser(),c="rtl"===s,a=r.current?.getBoundingClientRect(),{datatipContent:l,datatipProps:u}=S.useDatatip({content:e,placement:"top-start",offset:h.calculateOffset(c,n,i.isCurrent?a:void 0),borderColor:o,anchor:i?.isCurrent?"element":"pointer",touchResponse:t});return{datatipContent:l,datatipProps:u}})({touchResponse:ct,content:Ct,width:t,borderColor:bt,focusedItemRef:St,focusedItemInfo:ut}),{contextMenuContent:kt,contextMenuProps:Pt}=(({rootRef:t,contextMenuConfig:e,focusedItemInfo:o,items:n,onContextMenuDismissed:r,getItemInfo:i})=>{const{contextMenuProps:s,contextMenuContent:c}=E.useContextMenu({onContextMenuHandler:({gesture:e,target:r})=>{if("keyboard"===e){const e=o.idx,r=t.current?.querySelector(`[data-idx="${e}"]`)||null;return{type:"element",context:{type:"item",data:n[e]},elem:r}}const s=i(r)?.idx,c=void 0!==s?n[s]:null;return c?{type:"pointer",context:{type:"item",data:c}}:{type:"pointer",context:{type:"background"}}},contextMenuOptions:{isDisabled:!e},rootRef:t,contextMenuConfig:e,onContextMenuDismissed:r});return{contextMenuContent:c,contextMenuProps:s}})({getItemInfo:K,focusedItemInfo:ut,rootRef:_,contextMenuConfig:B?H:void 0,items:m,onContextMenuDismissed:mt});if(!yt)return null;const Dt=function(t,e,o,n,r){const i=e,s=o,c="bottomStart"===(a=n)||"bottomEnd"===a;var a;const l=(t=>"topEnd"===t||"bottomEnd"===t)(n),u=[],d=new Array(i);for(let t=0;t<i;t++)d[t]=new Array(s).fill(!1);const f=!0;let m={row:-1,col:-1,count:0,direction:f,rowSpan:1,columnSpan:1};for(let e=0;e<t.length;e++){const o=t[e],n=o.rowSpan??1,a=o.columnSpan??1;let p=o.count??1;if(m.count>0&&m.count<1&&m.rowSpan===n&&m.columnSpan===a){const t=1-m.count,r=Math.min(t,p),d=c?i-m.row-n:m.row,h=l?s-m.col-a:m.col;if(u.push({row:d,col:h,countIdx:e,itemIdx:e,item:o,fractionalStart:m.count,fractionalEnd:m.count+r}),m.count+=r,p-=r,!(m.count>=1))continue;m={row:-1,col:-1,count:0,direction:f,rowSpan:n,columnSpan:a}}const h=Math.floor(p);for(let t=0;t<h;t++){const f=z(d,a,n,s,i,r);if(f){const r=c?i-f.row-n:f.row,d=l?s-f.col-a:f.col;u.push({row:r,col:d,countIdx:t,itemIdx:e,item:o,fractionalStart:0,fractionalEnd:1})}}const g=p-h;if(g>0&&g<1){const t=z(d,a,n,s,i,r);if(t){m={row:t.row,col:t.col,count:g,direction:!0,rowSpan:n,columnSpan:a};const r=c?i-t.row-n:t.row,d=l?s-t.col-a:t.col;u.push({row:r,col:d,countIdx:g,itemIdx:e,item:o,fractionalStart:0,fractionalEnd:g})}}}return u}(m,wt,yt,$,"vertical"===w),Tt=l.mergeProps(ft,Ft,ht,Pt);return e.jsxs("div",{ref:_,tabIndex:0,"aria-label":j["aria-label"],"aria-describedby":R.l([j["aria-describedby"],$t]),"aria-labelledby":j["aria-labelledby"],"aria-activedescendant":dt,role:"application",style:{width:V?"max-content":`${t}px`,height:A?"max-content":`${o}px`,gridTemplateRows:`repeat(${wt}, ${Mt}px)`,gridTemplateColumns:`repeat(${yt}, ${vt}px)`,gap:`${Rt}px`,...at},class:It,...Y,...Tt,children:[Dt.map((t=>{const o=ut.idx===t.itemIdx,n=Z(t.item,t.itemIdx,t.countIdx,Q,lt,P,ut,k,dt,"vertical"===w,$),r={data:t.item,state:{selected:n.isSelected,focused:n.isFocused,hovered:n.isCurrent}};return e.jsx(ot,{focusedItemRef:o?St:void 0,row:t.row,column:t.col,supportsSelection:q,supportsDrill:G,translations:O,totalCount:L,fractionalStart:t.fractionalStart,fractionalEnd:t.fractionalEnd,...n,children:j.children(r)})})),Et,kt,pt]})}t.PictoChart=function({width:t,height:n,...r}){const i=!(!r.selectionMode||"none"===r.selectionMode),s=void 0===t,c=void 0===n;return e.jsx(O.Provider,{value:{supportsSelection:i},children:e.jsx(o.TrackResizeContainer,{width:s?"initial":t,height:c?"initial":n,children:(t,o)=>e.jsx(nt,{width:t,height:o,isFlowingWidth:s,isFlowingHeight:c,...r})})})},t.getPictoDefaultRenderers=function(t){return{markerRenderer:o=>{const n=t(o.data);return e.jsx(Y,{context:o,markerProps:n})},datatipRenderer:e=>({borderColor:t(e.data).color})}}}));
//# sourceMappingURL=PictoChart-a85dfa1b.js.map
